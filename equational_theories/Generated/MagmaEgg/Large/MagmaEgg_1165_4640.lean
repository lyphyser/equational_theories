import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation1165_implies_Equation4640 (G: Type _) [Magma G] (h: Equation1165 G) : Equation4640 G := fun x y z =>
  let v0 := M y z
  let v1 := M v0 z
  let v2 := M v1 (M z v0)
  have h3 := h v1 v2 z
  have h4 := S h3
  have h5 := R z
  have h6 := h v0 z v1
  have h7 := R v2
  have h8 := C h7 (C h6 h5)
  let v9 := M x y
  have h10 := h (M v2 v1) v9 v1
  have h11 := S h10
  have h12 := R v1
  have h13 := C h7 (C (S h6) h5)
  have h14 := h v0 v1 x
  have h15 := R x
  have h16 := h (M v1 v0) v1 v1
  have h17 := R v0
  have h18 := h z v1 v1
  have h19 := S h18
  have h20 := h (M (M v1 (M v1 z)) v1) v1 v0
  have h21 := h (M z v1) v1 x
  have h22 := T h3 h13
  have h23 := R v9
  have h24 := h (M (M v1 (M v9 v1)) v1) v9 v0
  have h25 := h v1 v9 v1
  have h26 := h (M (M v0 v1) v0) x x
  have h27 := h v1 x v1
  have h28 := S h27
  let v29 := M x v1
  let v30 := M (M v1 v29) v1
  have h31 := h v30 x v0
  have h32 := h v30 x v1
  have h33 := S h32
  have h34 := C h15 (C (C h12 h27) h12)
  let v35 := M (M v1 v1) v1
  have h36 := h v35 x x
  have h37 := C (T (T (T (C h5 (T (T (T (C h23 (T (T (C h23 (T (T (T h36 (C h15 (C (C h15 (T (T (T h34 h33) h31) (C h15 (C (C h17 h28) h17)))) h15))) (S h26)) (C (C h17 h25) h17))) (S h24)) (C (C h12 (C h23 h22)) h12))) h11) h8) h4)) h21) (C h12 (C (C h15 (T (C h12 (C (T h18 (C h12 (T h20 (C h12 (C (C h17 h19) h17))))) h12)) (S h16))) h15))) (S h14)) h5
  have h38 := h (M v9 v35) v9 z
  have h39 := C h23 (C (C h12 (T h38 (C h23 (T (T h37 h3) h13)))) h12)
  have h40 := h v35 v9 v1
  let v41 := M v9 x
  have h42 := h v35 v41 v41
  have h43 := S h42
  have h44 := R v41
  have h45 := h v1 v41 v41
  have h46 := S h45
  have h47 := C (C h12 h46) h12
  let v48 := M v41 v1
  let v49 := M (M v41 v48) v41
  have h50 := h v49 v41 v1
  have h51 := C h44 (C (T h45 (C h44 (T h50 (C h44 h47)))) h44)
  have h52 := T (T (T (T (T (T h51 h43) h40) h39) h11) h8) h4
  have h53 := C h52 h44
  have h54 := h v41 v1 v41
  have h55 := S h54
  have h56 := S h50
  have h57 := C (C h12 h45) h12
  have h58 := C h44 (C (T (C h44 (T (C h44 h57) h56)) h46) h44)
  have h59 := S h40
  have h60 := S h36
  have h61 := C h15 (C (C h12 h28) h12)
  have h62 := T h8 h4
  have h63 := C h5 (T (T (T h3 h13) h10) (C h23 (T (T (C (C h12 (C h23 h62)) h12) h24) (C h23 (T (T (T (C (C h17 (S h25)) h17) h26) (C h15 (C (C h15 (T (T (T (C h15 (C (C h17 h27) h17)) (S h31)) h32) h61)) h15))) h60)))))
  have h64 := S h21
  have h65 := C h12 (C (C h15 (T h16 (C h12 (C (T (C h12 (T (C h12 (C (C h17 h18) h17)) (S h20))) h19) h12)))) h15)
  have h66 := C h23 (C (C h12 (T (C h23 (T (T h8 h4) (C (T (T (T h14 h65) h64) h63) h5))) (S h38))) h12)
  have h67 := T (T (T (T (T (T h3 h13) h10) h66) h59) h42) h58
  have h68 := C h67 h44
  have h69 := C h12 h68
  let v70 := M v1 v41
  let v71 := M v1 v70
  have h72 := h v71 x x
  have h73 := S h72
  have h74 := C h12 h53
  have h75 := h y x x
  let v76 := M x v9
  have h77 := h (M v76 x) x x
  have h78 := h v9 x v41
  have h79 := S h78
  let v80 := M v41 v76
  have h81 := h (M v80 v41) x x
  have h82 := R v80
  have h83 := h v41 v80 x
  have h84 := C h15 (C (T (T (T (T h83 (C h82 (C h79 h15))) h81) (C h15 (T (T (C (C h15 h79) h15) h77) (C h15 (C (C h15 (S h75)) h15))))) (C h15 (C h15 (T h54 h74)))) h15)
  have h85 := h v41 x v1
  have h86 := S h85
  let v87 := M x v41
  let v88 := M (M v1 v87) v1
  have h89 := h v88 x x
  have h90 := C h15 (C (T (C h15 (T (C h15 (C (C h15 h85) h15)) (S h89))) h86) h15)
  have h91 := h (M v87 x) x x
  have h92 := h v41 v1 v1
  have h93 := S h92
  have h94 := C (C h15 h93) h15
  have h95 := C h67 (T (T (T (T (T (T h94 h91) h90) h84) h73) h69) h55)
  let v96 := M v71 v1
  have h97 := h v96 v1 x
  have h98 := h v96 v1 v41
  have h99 := S h98
  have h100 := h (M (M v41 v41) v41) x x
  have h101 := h v88 x v41
  have h102 := C h12 (T (T (C h15 (C (T h85 (C h15 (T h101 (C h15 (C (C h44 h86) h44))))) h15)) (S h100)) (C (C h44 h92) h44))
  have h103 := h v41 v1 x
  have h104 := C h12 (T (T (C (C h15 (S h103)) h15) h91) h90)
  let v105 := M (M x v70) x
  have h106 := h v105 v1 x
  have h107 := C (C h12 (T (T (T (T (T (T (T (C h44 (T (T (T (T (T (T h106 h104) h102) h99) h97) h95) h53)) h51) h43) h40) h39) h11) h8) h4)) h12
  have h108 := S h106
  have h109 := S h91
  have h110 := C h15 (C (T h85 (C h15 (T h89 (C h15 (C (C h15 h86) h15))))) h15)
  have h111 := C h12 (T (T h110 h109) (C (C h15 h103) h15))
  have h112 := C h12 (T (T (C (C h44 h93) h44) h100) (C h15 (C (T (C h15 (T (C h15 (C (C h44 h85) h44)) (S h101))) h86) h15)))
  have h113 := S h97
  have h114 := C (C h15 h92) h15
  have h115 := C h15 (C (T (T (T (T (C h15 (C h15 (T h69 h55))) (C h15 (T (T (C h15 (C (C h15 h75) h15)) (S h77)) (C (C h15 h78) h15)))) (S h81)) (C h82 (C h78 h15))) (S h83)) h15)
  have h116 := C h52 (T (T (T (T (T (T h54 h74) h72) h115) h110) h109) h114)
  have h117 := C h44 (T (T (T (T (T (T h68 h116) h113) h98) h112) h111) h108)
  let v118 := M v0 (M z y)
  have h119 := h y z v0
  have h120 := h v105 v41 v1
  have h121 := C (C h12 (T (T (T (T (T (T (T h3 h13) h10) h66) h59) h42) h58) h117)) h12
  have h122 := C h44 (T (T (T h10 h66) h59) h121)
  have h123 := C h12 (T (T (T (T (T (T (T h122 (S h120)) h106) h104) h102) h99) h97) h95)
  have h124 := C h44 (T (T (T h107 h40) h39) h11)
  have h125 := h (M (M v1 v48) v1) v41 x
  have h126 := h v1 v41 v1
  have h127 := h (M v29 x) x x
  have h128 := h v30 x x
  have h129 := C h12 (T (T (T (T (T h50 (C h44 (T (T (T (T h47 h36) (C h15 (C (C h15 (T (T (T h34 h33) h128) (C h15 (C (C h15 h28) h15)))) h15))) (S h127)) (C (C h15 h126) h15)))) (S h125)) (C (C h12 (C h44 h22)) h12)) (C (T h123 h55) (T (T (T (T (T h3 h13) h10) h66) h59) h121))) h124)
  have h130 := C h44 (T (T (T (T (C (C h15 (S h126)) h15) h127) (C h15 (C (C h15 (T (T (T (C h15 (C (C h15 h27) h15)) (S h128)) h32) h61)) h15))) h60) h57)
  have h131 := C (C h12 (C h44 h62)) h12
  have h132 := C h12 (T (T (T (T (T (T (T h116 h113) h98) h112) h111) h108) h120) h124)
  have h133 := C (T h54 h132) (T (T (T (T (T h107 h40) h39) h11) h8) h4)
  T (T (T (T (T (T (T (T (T (T (T (T (T h54 h74) h72) h115) (C h15 (C (T h85 (C h15 (T (h v88 x v1) (C h15 (C (C h12 h86) h12))))) h15))) (S (h (M v70 v1) x x))) (C (T (T h68 h116) (C h12 (T (T (T (T (T (T (T h94 h91) h90) h84) h73) h69) h132) (C h12 (T (T (T (T (T h122 h133) h131) h125) h130) h56))))) h12)) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (C h12 (T (T (T (T (T (T (T h129 h123) h74) h72) h115) h110) h109) h114)) h113) h98) h112) h111) h108) h120) h133) h131) h125) h130) h56) (h v49 v1 z)) (C h12 (T (T (T (T (T (T (T (T (T (C (T (T (T (T (T (T (T (T (C h5 (T (T h129 h123) h55)) (C h5 (C (C h15 h119) h15))) (S (h (M v118 v0) z x))) (C (R v118) (C h119 h5))) (S (h v0 v118 z))) h14) h65) h64) h63) h5) h37) h3) h13) h10) h66) h59) h42) h58) h117))) h12)) h107) h40) h39) h11) h8) h4

