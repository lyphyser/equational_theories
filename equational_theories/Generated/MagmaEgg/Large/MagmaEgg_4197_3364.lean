import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation4197_implies_Equation3364 (G: Type _) [Magma G] (h: Equation4197 G) : Equation3364 G := fun x y z =>
  let v0 := M x y
  let v1 := M x z
  let v2 := M z v1
  let v3 := M y v2
  have h4 := R v3
  have h5 := R v0
  have h6 := R v2
  have h7 := R y
  have h8 := h x y v2
  have h9 := h v2 x v0
  have h10 := S h9
  have h11 := h y v2 x
  have h12 := C h11 h5
  have h13 := h y v2 v1
  have h14 := S h13
  have h15 := h (M (M v1 y) v2) v1 v3
  have h16 := S h15
  have h17 := R v1
  have h18 := h v1 y z
  have h19 := S h18
  have h20 := h y z v2
  have h21 := C (C (C h4 (T h20 (C h19 h6))) h17) h4
  let v22 := M y z
  have h23 := h v22 v1 v3
  have h24 := h y z v3
  have h25 := R z
  have h26 := h v3 y v3
  have h27 := T (T (T h23 h21) h16) h14
  have h28 := h (M v22 v1) y v3
  have h29 := h z v1 y
  have h30 := h v2 z y
  have h31 := h z y v3
  have h32 := h z y x
  have h33 := C (T (T (T (S h32) h31) (C (T (S h30) (C (T (T (T h29 h28) (C (C (C h4 h27) h7) h4)) (S h26)) h25)) h4)) (S h24)) h17
  have h34 := h y x v1
  have h35 := h y x x
  have h36 := T (T (T (T (T (T (S h35) h34) h33) h23) h21) h16) h14
  have h37 := C h36 h5
  have h38 := h x x v0
  have h39 := h x x v1
  have h40 := S h39
  have h41 := R x
  have h42 := h v1 x v1
  have h43 := S h42
  have h44 := h z v1 x
  have h45 := C h44 h17
  have h46 := C (T h45 h43) h41
  have h47 := S h44
  have h48 := C h47 h17
  have h49 := h v1 x z
  have h50 := S h49
  have h51 := h (M v2 x) z v3
  have h52 := h (M x x) z v3
  have h53 := C (T (T (T (T (T h52 (C (C (C h4 (T (T (T h38 h37) h12) h10)) h25) h4)) (S h51)) h50) h42) h48) h41
  have h54 := h x z x
  have h55 := C (T (T h54 h53) h46) h17
  have h56 := T (T (T (T (T h55 h40) h38) h37) h12) h10
  have h57 := S h54
  have h58 := S h38
  have h59 := S h34
  have h60 := S h23
  have h61 := C (C (C h4 (T (C h18 h6) (S h20))) h17) h4
  have h62 := C h4 (T (T (T h13 h15) h61) h60)
  have h63 := C (T (T (T h24 (C (T (C (T (T (T h26 (C (C h62 h7) h4)) (S h28)) (S h29)) h25) h30) h4)) (S h31)) h32) h17
  have h64 := T (T (T (T (T (T h13 h15) h61) h60) h63) h59) h35
  have h65 := C h64 h5
  have h66 := S h11
  have h67 := C h66 h5
  have h68 := C (T (T (T (T (T h45 h43) h49) h51) (C (C (C h4 (T (T (T h9 h67) h65) h58)) h25) h4)) (S h52)) h41
  have h69 := C (T h42 h48) h41
  have h70 := C (T (T h69 h68) h57) h17
  have h71 := h x x v2
  have h72 := S h71
  have h73 := C (T h12 h10) h41
  have h74 := C (T h38 h37) h41
  have h75 := C (T h55 h40) h41
  have h76 := C (T (T (T h44 h75) h74) h73) h6
  have h77 := T (T (T h76 h72) h39) h70
  have h78 := h v2 y v2
  have h79 := T (T h78 (C (T (C h77 h7) (C h56 h7)) h6)) (S h8)
  have h80 := h v1 y v3
  have h81 := h x z v2
  have h82 := S h81
  have h83 := C h56 h25
  have h84 := C h77 h25
  have h85 := C (T h84 h83) h6
  have h86 := h v2 z v2
  have h87 := C h4 (T (T h86 h85) h82)
  have h88 := S h86
  have h89 := C (T h39 h70) h41
  have h90 := C (T h65 h58) h41
  have h91 := C (T h9 h67) h41
  have h92 := C (T (T (T h91 h90) h89) h47) h6
  have h93 := T (T (T h55 h40) h71) h92
  have h94 := C h93 h25
  have h95 := T (T (T (T (T h9 h67) h65) h58) h39) h70
  have h96 := C h95 h25
  have h97 := C (T h96 h94) h6
  have h98 := h x z v1
  have h99 := S h98
  have h100 := h (M (M v1 x) z) v1 v3
  have h101 := S h100
  have h102 := h z v1 v2
  have h103 := S h102
  have h104 := h (M v2 z) v1 v3
  have h105 := S h104
  have h106 := C h4 (T (T h81 h97) h88)
  have h107 := C (C h106 h17) h4
  have h108 := h v1 v1 v3
  have h109 := C h64 h79
  have h110 := C (T (T (T (T (T (T h109 h58) h39) h70) h108) h107) h105) h6
  have h111 := T (T h8 (C (T (C h95 h7) (C h93 h7)) h6)) (S h78)
  have h112 := C h36 h111
  have h113 := h v1 v1 z
  have h114 := C (T (T (T (T (S h113) h55) h40) h38) h112) h6
  have h115 := h v1 z v2
  have h116 := h v1 z z
  have h117 := C (T (T (T (T (T (T (T (T (S h116) h115) h114) h110) h103) h44) h75) h74) h73) h6
  have h118 := h z z v2
  have h119 := T (T h118 h117) h92
  have h120 := C h119 h25
  have h121 := C (T (T (T h120 h84) h83) h50) h25
  have h122 := h z z z
  have h123 := C (C (C h4 (T h122 h121)) h17) h4
  let v124 := M z z
  have h125 := h v124 v1 v3
  have h126 := S h125
  have h127 := S h122
  have h128 := S h118
  have h129 := S h115
  have h130 := C (T (T (T (T h109 h58) h39) h70) h113) h6
  have h131 := C (T (T (T (T (T (T h104 (C (C h87 h17) h4)) (S h108)) h55) h40) h38) h112) h6
  have h132 := C (T (T (T (T (T (T (T (T h91 h90) h89) h47) h102) h131) h130) h129) h116) h6
  have h133 := T (T h76 h132) h128
  have h134 := C h133 h25
  have h135 := C (T (T (T h49 h96) h94) h134) h25
  have h136 := C (C (C h4 (T h135 h127)) h17) h4
  have h137 := T (T (T h98 h100) h136) h126
  have h138 := T (T (T h115 h114) h110) h103
  have h139 := C h7 h138
  have h140 := C h139 h137
  have h141 := h z x x
  have h142 := T (T (T h102 h131) h130) h129
  have h143 := C h7 h142
  have h144 := C h143 (T (T (T h141 h69) h68) h57)
  have h145 := C h139 (T (T (T h54 h53) h46) (S h141))
  have h146 := C h145 h7
  let v147 := M v1 z
  have h148 := T (T (T h125 h123) h101) h99
  have h149 := h v1 v1 v1
  have h150 := h v2 x v2
  have h151 := h z v1 z
  have h152 := S h151
  let v153 := M v124 v1
  have h154 := h v153 z v3
  have h155 := S h154
  have h156 := C (C (T h144 h140) h25) h4
  let v157 := M z x
  have h158 := h v157 z v3
  have h159 := C h143 h148
  have h160 := T (T (T h151 h154) (C (C (T h159 h145) h25) h4)) (S h158)
  have h161 := h v0 v2 v2
  let v162 := M v2 y
  have h163 := h v162 v2 v2
  have h164 := h v162 v2 v3
  have h165 := S h164
  have h166 := T h11 (C (T (T (T (T h161 (C (C (C h6 h111) h6) h6)) (S h163)) h164) (C (T h110 h103) h4)) h41)
  have h167 := T (T (T (T (T (T (T h158 h156) h155) h152) h102) h131) h130) h129
  have h168 := h v0 x v3
  have h169 := T (T (T (T (T (T (T h168 (C (T (T (T (T h90 h89) h47) h102) h131) h4)) h165) h163) (C (T (T (T (T (T (T (T (C (T (T (T (T (T (C (T (T h151 (h v153 z v2)) (C (T (T (T (C (T (T (T (T (T (T (C h6 h148) h45) h43) h49) h96) h94) h134) h25) h127) (h z z v0)) (C (T (T (C (T (C h111 h25) h19) h25) (C (T (T h80 (C (T (C (T (T h106 (C h4 (T (T (T (T (T (T h86 h85) h82) h98) h100) h136) h126))) h159) h7) h146) h4)) (S (h v157 y v3))) h25)) (S (h x y z))) h111)) h6)) h79) (S (h v162 v2 v0))) h164) (C (T (T (T (T h110 h103) h44) h75) h74) h4)) (S h168)) (C h111 h41)) h6) (S (h y x v2))) h34) h33) h23) h21) h16) h14) h160)) (C h4 h167)) (C h166 h138)) (C (T (C (T (T (T (T (C (T h102 h131) h4) h165) h163) (C (C (C h6 h79) h6) h6)) (S h161)) h41) h66) h6)
  T (T (T (T (h x y v0) (h (M (M v0 x) y) v0 v3)) (C (C (C h4 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C h169 h7) (C (T (C h166 h6) (S (h v3 x v2))) h7)) (S (h v2 x y))) h9) h67) h65) h58) h39) h70) h108) h107) h105) (C (T (T (T (T (T h86 h85) h82) (h x z z)) (h (M v157 z) z y)) (C (T (T (T (T (C (T (C h7 h167) h139) h25) (h v3 z v3)) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (C (T (T (T (T h62 (C (T (T (T (T (T (T (T h13 h15) h61) h60) h63) h59) h35) (C h169 h41)) h27)) (S (h v2 x v3))) h150) (C (T (T (C h133 h41) (C (T (T (T (T h118 h117) h72) h39) h70) h41)) h47) h160)) h25) (C (T (T (T (T (T (T (T (T (T (C (T (T h44 (C (T (T (T (T h55 h40) h71) h132) h128) h41)) (C h119 h41)) (T (T (T h158 h156) h155) h152)) (S h150)) h9) h67) h65) h58) h39) h70) h149) (C (T (C (T (T (T (T (T (T h55 h40) h71) h132) h128) h122) h121) h17) h99) h137)) h25)) (C (T (T (T (T (T (T (C (T h98 (C (T (T (T (T (T (T h135 h127) h118) h117) h72) h39) h70) h17)) h148) (S h149)) h55) h40) h71) h132) h128) h25)) h120) h84) h83) h50) h42) h48) (C h6 h137)) (C (T (h z v1 v1) (C (T (h v147 v1 v2) (C (T (T (T (T (C (T (C (T (T (T (T h102 h131) h130) h129) h116) h138) h128) h17) h125) h123) h101) h99) h142)) h17)) h148)) (S (h v147 v1 v1))) (h v147 v1 y)) h146) h4)) (C (T (C h144 h7) (C (T (T h140 (C h4 (T (T (T (T (T (T h125 h123) h101) h99) h81) h97) h88))) h87) h7)) h4)) (S h80)) h7)) h17)) (S (h y y v1))) (h y y v2)) (C (C h79 h7) h6))) h5) h4)) (S (h (M (M v0 y) v2) v0 v3))) (S (h y v2 v0))

