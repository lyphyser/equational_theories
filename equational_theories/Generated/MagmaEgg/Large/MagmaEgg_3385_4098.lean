import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3385_implies_Equation4098 (G: Type _) [Magma G] (h: Equation3385 G) : Equation4098 G := fun x y z =>
  let v0 := M y y
  let v1 := M v0 z
  have h2 := h v1 z v0
  have h3 := S h2
  let v4 := M v1 z
  let v5 := M v1 (M z v0)
  have h6 := h v0 v5 v4
  have h7 := S h6
  have h8 := R v4
  have h9 := h z v0 v0
  have h10 := S h9
  have h11 := h y y y
  have h12 := R v0
  have h13 := C h12 (S h11)
  have h14 := h y y v0
  have h15 := R z
  have h16 := C h12 (C h15 (T h14 h13))
  have h17 := h z v0 z
  have h18 := S h17
  have h19 := h z v1 v4
  have h20 := S h19
  have h21 := h v0 z y
  have h22 := S h21
  have h23 := h z y y
  have h24 := h z v0 v1
  have h25 := S h24
  have h26 := h v0 v0 z
  have h27 := R v1
  have h28 := C h27 (T (T h14 h13) h26)
  have h29 := R y
  have h30 := h y v1 v0
  have h31 := C h29 (T h30 (C h12 (T (C h29 (T h28 h25)) (S h23))))
  have h32 := T h31 h22
  have h33 := C h32 h8
  have h34 := C h32 h15
  have h35 := S h14
  have h36 := C h12 h11
  have h37 := C h27 (T (T (S h26) h36) h35)
  have h38 := C h29 (T (C h12 (T h23 (C h29 (T h24 h37)))) (S h30))
  have h39 := T h21 h38
  have h40 := C h39 h34
  have h41 := C h15 (T h40 h33)
  let v42 := M y (M y v1)
  have h43 := h v1 v42 z
  have h44 := h y y v1
  have h45 := C h15 (T (C h8 (T (T h44 h43) h41)) h20)
  have h46 := C h12 (T h45 h18)
  have h47 := S h44
  have h48 := S h43
  have h49 := C h39 h15
  have h50 := C h32 h49
  have h51 := C h39 h8
  have h52 := C h15 (T h51 h50)
  have h53 := C h15 (T h19 (C h8 (T (T h52 h48) h47)))
  have h54 := h z v0 v4
  have h55 := h v1 z z
  have h56 := S h55
  let v57 := M z z
  have h58 := h z (M v1 v57) v4
  have h59 := S h58
  have h60 := h v1 v57 v4
  have h61 := S h60
  have h62 := h z z v0
  have h63 := S h62
  have h64 := h z v4 v0
  have h65 := C h15 (T (T (T h64 h46) h16) h10)
  have h66 := h z v1 z
  have h67 := C h12 (T h66 h65)
  have h68 := C (T h67 h63) h8
  have h69 := C h27 h68
  have h70 := C h8 h69
  let v71 := M z v1
  have h72 := h v1 (M v0 v71) v4
  have h73 := h v0 z v1
  have h74 := T (T (T h73 h72) h70) h61
  have h75 := C h74 h34
  have h76 := C h15 h75
  have h77 := C h8 (T h52 h76)
  have h78 := S h66
  have h79 := S h64
  have h80 := C h12 (T h17 h53)
  have h81 := C h12 (C h15 (T h36 h35))
  have h82 := C h15 (T (T (T h9 h81) h80) h79)
  have h83 := C h12 (T (T (T (T (T h82 h78) h19) h77) h59) h56)
  have h84 := h v0 v71 v0
  have h85 := S h84
  have h86 := S h73
  have h87 := S h72
  have h88 := C h12 (T h82 h78)
  have h89 := C (T h62 h88) h8
  have h90 := C h27 h89
  have h91 := C h8 h90
  have h92 := T (T (T h60 h91) h87) h86
  have h93 := C h92 h49
  have h94 := C h15 h93
  have h95 := C h8 (T h94 h41)
  have h96 := T (T (T h55 h58) h95) h20
  have h97 := C h96 (T (T h94 h48) h47)
  have h98 := T (T (T (T (T h55 h58) h95) h20) h66) h65
  have h99 := C h12 h98
  have h100 := C h12 (T h99 (C h12 (T (T (T (T h82 h78) h19) h77) h97)))
  have h101 := C h12 (T h62 h83)
  have h102 := h v0 z z
  have h103 := T (T (T h19 h77) h59) h56
  have h104 := C h12 (T (T (T (C h103 (T h102 (C h15 (T (T (T (T h101 h100) h85) h67) h83)))) (S h54)) h17) h53)
  have h105 := C h27 (T (T (T h104 h46) h16) h10)
  have h106 := h v0 v71 v1
  have h107 := C (T (T (T (T h101 h100) h85) h106) h105) h8
  have h108 := C h12 (T h99 h63)
  have h109 := C h103 (T (T h44 h43) h76)
  have h110 := C h12 (T (C h12 (T (T (T (T h109 h95) h20) h66) h65)) h83)
  have h111 := T (T h84 h110) h108
  have h112 := C h111 h8
  have h113 := C h8 (C h12 (T (T h89 h112) h107))
  have h114 := h v0 v57 v4
  have h115 := h v1 v42 v4
  have h116 := S h115
  have h117 := S h106
  have h118 := S h102
  have h119 := C h12 (T (T (T h45 h18) h54) (C h96 (T (C h15 (T (T (T (T h99 h88) h84) h110) h108)) h118)))
  have h120 := h z v4 v4
  have h121 := S h120
  have h122 := C h27 (T (T (T h9 h81) h80) h119)
  have h123 := C (T (T (T (T (T (T (T (T (T (T (T (T h122 h117) h84) h110) h108) h114) h113) h7) h3) h55) h58) h95) h20) h8
  have h124 := C h8 (C h15 (T (T h107 h123) (C h103 h8)))
  have h125 := h z (M v0 v57) v4
  have h126 := T (T (T (T (T h102 h125) h124) h121) h64) h119
  have h127 := C h32 h126
  have h128 := C h74 (T (T (T (T (T (T (T (T h127 h117) h84) h110) h108) h114) h113) h7) h3)
  have h129 := C h27 (T (T h128 h93) h40)
  have h130 := h v1 v42 v1
  have h131 := C h103 (T (T h44 h130) h129)
  have h132 := h z z x
  have h133 := h z x v4
  have h134 := h x v1 z
  have h135 := S h125
  have h136 := C (T (T (T (T h122 h117) h84) h110) h108) h8
  have h137 := S h114
  have h138 := T (T h101 h100) h85
  have h139 := C h138 h8
  have h140 := C h8 (C h12 (T (T h136 h139) h68))
  have h141 := C (T (T (T (T (T (T (T (T (T (T (T (T h19 h77) h59) h56) h2) h6) h140) h137) h101) h100) h85) h106) h105) h8
  have h142 := C h8 (C h15 (T (T (C h96 h8) h141) h136))
  have h143 := h v0 v5 v0
  have h144 := S h143
  have h145 := C (T (T (T (T (T (T (T (T h122 h117) h84) h110) h108) h114) h113) h7) h3) (T (T (T (T (T (T h55 h58) h97) h131) h116) h130) h129)
  have h146 := S h130
  have h147 := T (T (T (T (T h104 h79) h120) h142) h135) h118
  have h148 := C h39 h147
  have h149 := C h92 (T (T (T (T (T (T (T (T h2 h6) h140) h137) h101) h100) h85) h106) h148)
  have h150 := C h27 (T (T h50 h75) h149)
  have h151 := C h96 (T (T h150 h146) h47)
  have h152 := T (T (T (T (T (T (T (T (T (T (T (T (T (T h44 h115) h151) h109) h59) h56) h2) h6) h140) h137) h101) h100) h85) h106) h105
  have h153 := C h152 (T (T h145 h116) h47)
  have h154 := C (T (T (T (T (T (T (T (T h2 h6) h140) h137) h101) h100) h85) h106) h105) (T (T (T (T (T (T h150 h146) h115) h151) h109) h59) h56)
  have h155 := T (T (T (T (T h55 h58) h97) h131) h116) h47
  have h156 := C h155 (T (T (T h150 h146) h115) h154)
  have h157 := T (T (T (T (T (T (T (T (T (T (T (T (T (T h122 h117) h84) h110) h108) h114) h113) h7) h3) h55) h58) h97) h131) h116) h47
  have h158 := C (T (T (T (T (T (T (T (T (T (T (T (T h84 h110) h108) h114) h113) h7) h3) h55) h58) h97) h131) h116) h47) (T (T (T (T h44 h115) h156) h153) (C h157 (T (T (T h44 h115) h156) h153)))
  have h159 := C h138 h12
  have h160 := C (T (T (T (T h62 h88) h84) h110) h108) h12
  have h161 := C (T (T (T (T h101 h100) h85) h67) h63) h12
  have h162 := C h111 h12
  have h163 := T (T (T (T (T h44 h115) h151) h109) h59) h56
  have h164 := C h163 (T (T (T h145 h116) h130) h129)
  have h165 := C h157 (T (T h44 h115) h154)
  have h166 := C (T (T (T (T (T (T (T (T (T (T (T (T h44 h115) h151) h109) h59) h56) h2) h6) h140) h137) h101) h100) h85) (T (T (T (T (C h152 (T (T (T h165 h164) h116) h47)) h165) h164) h116) h47)
  have h167 := C h27 (T (T (T h141 h136) h139) h68)
  have h168 := C h8 h167
  have h169 := h v1 v71 v4
  have h170 := C (T (T (T (T (T (T h169 h168) h91) h87) h86) h21) h38) h15
  have h171 := S h169
  have h172 := C h27 (T (T (T h89 h112) h107) h123)
  have h173 := C h8 h172
  have h174 := T (T (T (T h73 h72) h70) h173) h171
  have h175 := C (T (T (T (T (T (T h31 h22) h73) h72) h70) h173) h171) h15
  have h176 := T (T (T (T h169 h168) h91) h87) h86
  have h177 := C h176 h126
  have h178 := C h174 h147
  have h179 := R x
  have h180 := h x v1 v4
  have h181 := h x v0 z
  have h182 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C h179 (T h181 (C h15 (T (T h180 (C h8 (T (C h179 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h51 h50) h75) h149) (C h27 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h127 h117) h84) h110) h108) h114) h113) h7) h3) h55) h58) h97) h131) h154) h136) h139))) h69) h172) (C h174 (T (T (T (T (T h141 h145) h151) h109) h59) h56))) (C h176 (T (T (T (T (T (T (T (T h2 h6) h140) h137) h101) h100) h85) h106) h178))) (C h27 (T (T (T (T (T (T (T (T (T (T h177 h117) h84) h110) h108) h114) h113) h7) h3) h49) h175))) (C h174 (T (T (T (T (T (T (T h170 h34) h55) h58) h97) h131) h116) h47))) (C (T (T h169 h168) h61) h12)) (C h92 (T (T (T (T (T (T (T (T h44 h115) h151) h109) h59) h56) h2) h143) h166))) (C h27 (T h162 h161))) (C h27 (T (T (T (T (T (T (T (T (T (T h160 h159) h158) h144) h3) h55) h58) h97) h131) h116) h47))) h28) h25) h9) h81) h80) h79) h120) h142) h135) h118)) h134))) (S h133))))) (S h132)) h62) h88) h84) h110) h108) h114) h113) h7) h3) h55) h58) h97) h131) h116) h47) h98
  let v183 := M x (M x v0)
  have h184 := R v183
  have h185 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h44 h115) h151) h109) h59) h56) h2) h6) h140) h137) h101) h100) h85) h67) h63) h132) (C h179 (T (C h15 (T (T h133 (C h8 (T (S h134) (C h179 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h102 h125) h124) h121) h64) h46) h16) h10) h24) h37) (C h27 (T (T (T (T (T (T (T (T (T (T h44 h115) h151) h109) h59) h56) h2) h143) h166) h162) h161))) (C h27 (T h160 h159))) (C h74 (T (T (T (T (T (T (T (T h158 h144) h3) h55) h58) h97) h131) h116) h47))) (C (T (T h60 h173) h171) h12)) (C h176 (T (T (T (T (T (T (T h44 h115) h151) h109) h59) h56) h49) h175))) (C h27 (T (T (T (T (T (T (T (T (T (T h170 h34) h2) h6) h140) h137) h101) h100) h85) h106) h178))) (C h174 (T (T (T (T (T (T (T (T h177 h117) h84) h110) h108) h114) h113) h7) h3))) (C h176 (T (T (T (T (T h55 h58) h97) h131) h154) h123))) h167) h90) (C h27 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h112 h107) h145) h151) h109) h59) h56) h2) h6) h140) h137) h101) h100) h85) h106) h148))) h128) h93) h40) h33))))) (S h180))) (S h181)))) (T (T (T (T (T (T (T (T (T (C h184 h163) h182) h88) h84) h110) h108) h114) h113) h7) h3)
  T (T (T (T (T (T (T (T (T (T (T (T (h x x v0) (h v0 v183 v0)) (C h12 (T h185 (C h184 h155)))) h185) h182) h88) h84) h110) h108) h114) h113) h7) h3

