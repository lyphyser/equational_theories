import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation2958_implies_Equation2917 (G: Type _) [Magma G] (h: Equation2958 G) : Equation2917 G := fun x y z =>
  let v0 := M x y
  let v1 := M y v0
  let v2 := M v1 z
  let v3 := M (M x (M x v2)) v2
  let v4 := M v2 z
  have h5 := h v4 v3 v2
  have h6 := S h5
  have h7 := R v2
  have h8 := R v4
  have h9 := h v2 x v2
  have h10 := R v3
  have h11 := T h9 (C h10 h9)
  have h12 := C (C h11 h8) h7
  let v13 := M (M x (M x v1)) v1
  have h14 := h v2 v13 v1
  have h15 := S h14
  have h16 := R v1
  have h17 := h v1 x v1
  have h18 := R v13
  have h19 := T h17 (C h18 h17)
  have h20 := C (C h19 h7) h16
  have h21 := h (M (M v1 v2) v1) v2 v4
  have h22 := S h21
  have h23 := S h17
  have h24 := T (C h18 h23) h23
  have h25 := C (C h24 h7) h16
  let v26 := M v2 v4
  let v27 := M v2 v26
  have h28 := R v27
  have h29 := R v26
  have h30 := S h9
  have h31 := T (C h10 h30) h30
  have h32 := C (C h31 h29) h7
  have h33 := h v26 v3 v2
  have h34 := C (T (T h33 h32) (C h28 (T h14 h25))) h8
  have h35 := C h29 (T (T (T h34 h22) h20) h15)
  have h36 := h (M v26 v4) v2 z
  have h37 := S h36
  have h38 := R z
  have h39 := S h33
  have h40 := C (C h11 h29) h7
  have h41 := C (T (T (C h28 (T h20 h15)) h40) h39) h8
  have h42 := C h29 (T (T (T h14 h25) h21) h41)
  have h43 := C (C h31 h8) h7
  have h44 := C (T (T h5 h43) h42) h38
  let v45 := M (M x (M x v4)) v4
  let v46 := M v4 z
  have h47 := h v46 v45 v4
  have h48 := S h47
  have h49 := R v46
  have h50 := h v4 x v4
  have h51 := R v45
  have h52 := T h50 (C h51 h50)
  have h53 := C (C h52 h49) h8
  let v54 := M y v4
  let v55 := M y v54
  let v56 := M v55 v4
  have h57 := h (M (M v4 v46) v4) v56 v4
  have h58 := S h57
  have h59 := S h50
  have h60 := T (C h51 h59) h59
  have h61 := C (C h60 h49) h8
  have h62 := C (T (T h35 h12) h6) h38
  have h63 := h v4 y v4
  have h64 := R v56
  have h65 := C h64 h63
  have h66 := T h63 h65
  have h67 := h z v3 v2
  have h68 := C (T (T h67 (C (C h31 h38) h7)) (C h66 (T (T (T (T (T (T (T h14 h25) h21) h41) h36) h62) h47) h61))) h8
  have h69 := C h29 (T (T (T (T (T h68 h58) h53) h48) h44) h37)
  have h70 := S h63
  have h71 := C h64 h70
  have h72 := T h71 h70
  have h73 := C (T (T (C h72 (T (T (T (T (T (T (T h53 h48) h44) h37) h34) h22) h20) h15)) (C (C h11 h38) h7)) (S h67)) h8
  have h74 := T (T (T (T (T (T (T h21 h41) h36) h62) h47) h61) h57) h73
  have h75 := C h29 h74
  have h76 := T (T (T (T (T (T (T h68 h58) h53) h48) h44) h37) h34) h22
  let v77 := M (M x (M x z)) z
  let v78 := M z v4
  have h79 := h v78 v77 z
  have h80 := S h79
  have h81 := R v78
  have h82 := h z x z
  have h83 := R v77
  have h84 := T h82 (C h83 h82)
  have h85 := C (C h84 h81) h38
  let v86 := M (M y (M y z)) z
  let v87 := M z v78
  have h88 := h (M v87 z) v86 z
  have h89 := S h88
  have h90 := h z z v2
  have h91 := S h90
  have h92 := T (T (T (T (T (T (T (T (T h68 h58) h53) h48) h44) h37) h34) h22) h20) h15
  let v93 := M z v2
  have h94 := R v93
  have h95 := S h82
  have h96 := T (C h83 h95) h95
  have h97 := C (C h96 h94) h38
  have h98 := h v93 v77 z
  have h99 := h z y z
  have h100 := S h99
  have h101 := R v86
  have h102 := C h101 h100
  have h103 := T h102 h100
  have h104 := C h103 (T (T (T (T (T (T (T (T (T (T (T h85 h80) h68) h58) h53) h48) h44) h37) h34) h22) h20) h15)
  have h105 := C (C h96 h81) h38
  have h106 := C h101 h99
  have h107 := T h99 h106
  have h108 := C h107 (T h79 h105)
  have h109 := C (T (T (T h108 h104) h98) h97) h92
  have h110 := T (T (T (T (T (T (T (T (T h14 h25) h21) h41) h36) h62) h47) h61) h57) h73
  have h111 := R v87
  have h112 := C h111 h110
  have h113 := C h108 (T (T h112 h109) h91)
  have h114 := C (T (T (T (T (T (T (T (T (T (T (T (T (T h113 h89) h85) h80) h68) h58) h53) h48) h44) h37) h34) h22) h20) h15) h8
  have h115 := h (M v87 v2) z v4
  have h116 := C h111 h92
  have h117 := C h103 (T h85 h80)
  have h118 := C h107 (T (T (T (T (T (T (T (T (T (T (T h14 h25) h21) h41) h36) h62) h47) h61) h57) h73) h79) h105)
  have h119 := S h98
  have h120 := C (C h84 h94) h38
  have h121 := C (T (T (T h120 h119) h118) h117) h110
  have h122 := C (T (T (T (T h90 h121) h116) h115) h114) h76
  have h123 := h (M (M z v93) z) z v2
  have h124 := S h123
  have h125 := S h115
  have h126 := C h117 (T (T h90 h121) h116)
  have h127 := C (T (T (T (T (T (T (T (T (T (T (T (T (T h14 h25) h21) h41) h36) h62) h47) h61) h57) h73) h79) h105) h88) h126) h8
  have h128 := C (T (T (T (T h127 h125) h112) h109) h91) h74
  have h129 := C h29 h76
  have h130 := C h29 (T (T (T (T (T h36 h62) h47) h61) h57) h73)
  have h131 := T (T (T (T (T (T (T (T (T h5 h43) h42) h130) h129) h128) h108) h104) h98) h97
  have h132 := T h120 h119
  have h133 := C h103 h132
  have h134 := C (T (T (T (T (T (T (T (T h40 h39) h127) h125) h112) h109) h91) h99) h106) h131
  have h135 := h v2 v2 v4
  have h136 := h (M v27 v2) z v4
  have h137 := h z v13 v1
  let v138 := M x v0
  let v139 := M v138 y
  have h140 := h v1 v139 y
  have h141 := S h140
  have h142 := R y
  have h143 := h y x y
  have h144 := R v139
  have h145 := T h143 (C h144 h143)
  have h146 := C (C h145 h16) h142
  have h147 := T h146 h141
  have h148 := S h135
  have h149 := T (T (T (T (T (T (T (T (T h120 h119) h118) h117) h122) h75) h69) h35) h12) h6
  have h150 := C (T (T (T (T (T (T (T (T h102 h100) h90) h121) h116) h115) h114) h33) h32) h149
  have h151 := C h107 (T h98 h97)
  have h152 := C (T (T (T (T (T (T (T (T (T (T (T (C (T (T h151 h150) h148) h147) (C (C h19 h38) h16)) (S h137)) h90) h121) h116) h115) h114) h33) h32) h136) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C h111 (T (T (T h40 h39) h127) h125)) h113) h89) h85) h80) h68) h58) h53) h48) h44) h37) h34) h22) h20) h15) h135) h134) h133) h131)) h7
  let v153 := M y v1
  let v154 := M v153 y
  have h155 := h v154 z v2
  have h156 := S h143
  have h157 := T (C h144 h156) h156
  have h158 := C (C h157 h16) h142
  have h159 := R v0
  have h160 := S h155
  have h161 := T h140 h158
  have h162 := C (T (T (T (T (T (T (T (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h151 h150) h148) h14) h25) h21) h41) h36) h62) h47) h61) h57) h73) h79) h105) h88) h126) (C h111 (T (T (T h115 h114) h33) h32))) h149) (S h136)) h40) h39) h127) h125) h112) h109) h91) h137) (C (C h24 h38) h16)) (C (T (T h135 h134) h133) h161)) h7
  let v163 := M v4 v0
  let v164 := M v4 v163
  have h165 := R v164
  have h166 := h v154 v4 y
  have h167 := S h166
  have h168 := h y y v0
  have h169 := S h168
  have h170 := T (T (T (T (T (T (T (T (T (T (T (T h5 h43) h42) h130) h129) h128) h108) h104) h98) h97) h123) h162) h160
  have h171 := C h170 h159
  have h172 := h v163 y v1
  have h173 := S h172
  have h174 := T (T (T (T (T (T (T (T (T (T (T (T h155 h152) h124) h120) h119) h118) h117) h122) h75) h69) h35) h12) h6
  have h175 := C h174 h159
  have h176 := T h168 h175
  let v177 := M y v153
  have h178 := R v177
  have h179 := R v153
  have h180 := h v153 v139 y
  have h181 := C (T (T h180 (C (C h157 h179) h142)) (C h178 h176)) h147
  have h182 := C h179 h170
  have h183 := T (T (T (T h182 h181) h173) h171) h169
  let v184 := M v4 y
  have h185 := R (M v4 v184)
  have h186 := C h185 h170
  have h187 := R v184
  have h188 := C (C h60 h187) h8
  have h189 := h v184 v45 v4
  have h190 := h v163 v45 v4
  have h191 := S h190
  have h192 := R v163
  have h193 := C (C h52 h192) h8
  have h194 := C h72 (T (T (T h193 h191) h171) h169)
  have h195 := C (C h60 h192) h8
  have h196 := T h190 h195
  have h197 := C (T (T (T (T (T (T (T h122 h75) h69) h35) h12) h6) h63) h65) h196
  have h198 := T (T h182 h181) h173
  have h199 := C h111 h198
  have h200 := C h179 h174
  have h201 := T h171 h169
  have h202 := C (T (T (C h178 h201) (C (C h145 h179) h142)) (S h180)) h161
  have h203 := T (T h172 h202) h200
  have h204 := T (T (T (T (T h5 h43) h42) h130) h129) h128
  have h205 := C h204 h203
  have h206 := C (T (T (T (T (T (T h205 h199) h197) h194) h189) h188) h186) h183
  have h207 := C h165 h203
  have h208 := C h165 h176
  have h209 := h (M v164 y) v4 y
  let v210 := M v164 v4
  have h211 := h v210 y v4
  have h212 := S h211
  have h213 := R v55
  have h214 := R v54
  have h215 := C (C h157 h214) h142
  have h216 := h v54 v139 y
  have h217 := h v210 y v0
  have h218 := h v0 v139 y
  have h219 := S h218
  have h220 := C (C h145 h159) h142
  let v221 := M v1 y
  have h222 := h v221 v13 v1
  have h223 := S h222
  have h224 := R v221
  have h225 := C (C h19 h224) h16
  have h226 := T (T (T (T h168 h175) h172) h202) h200
  have h227 := h v1 y v1
  have h228 := S h227
  let v229 := M v177 v1
  have h230 := R v229
  have h231 := C (T (T (T (T (T (C (T (T (T (T (T (T (C h230 h228) h228) h140) h158) (C h179 h226)) (C h179 h198)) (C h179 h196)) (T (T (T h225 h223) h220) h219)) (S h217)) h193) h191) h171) h169) (T (T (T (T (T (T (T (T (T (T (T (T (T (T h140 h158) h155) h152) h124) h120) h119) h118) h117) h122) h75) h69) h35) h12) h6)
  have h232 := h (M (M v1 v221) v1) v229 v1
  have h233 := C (C h24 h224) h16
  have h234 := C (C h157 h159) h142
  have h235 := C (T (T (T (T (T (T (T (T (T (T h218 h234) h222) h233) h232) h231) h216) h215) (C h213 h176)) (C h213 h203)) (C h213 (T (T (T (T h182 h181) h173) h190) h195))) h8
  have h236 := C h165 h201
  have h237 := C h165 h198
  have h238 := T (T (T (T (T h122 h75) h69) h35) h12) h6
  have h239 := C h238 h198
  have h240 := C h111 h203
  have h241 := T h193 h191
  have h242 := C (T (T (T (T (T (T (T h71 h70) h5) h43) h42) h130) h129) h128) h241
  have h243 := C h66 (T (T (T h168 h175) h190) h195)
  have h244 := S h189
  have h245 := C (C h52 h187) h8
  have h246 := C h185 h174
  have h247 := C (T (T (T (T (T (T h246 h245) h244) h243) h242) h240) h239) h226
  have h248 := C h238 h241
  let v249 := M (M x v138) v0
  let v250 := M v0 v4
  have h251 := h v250 v249 v0
  have h252 := S h251
  have h253 := R v250
  have h254 := h v0 x v0
  have h255 := R v249
  have h256 := T h254 (C h255 h254)
  have h257 := C (C h256 h253) h159
  have h258 := T h257 h252
  have h259 := S h254
  have h260 := T (C h255 h259) h259
  have h261 := C (C h260 h253) h159
  have h262 := S h232
  have h263 := C (T (T (T (T (T h168 h175) h190) h195) h217) (C (T (T (T (T (T (T (C h179 h241) (C h179 h203)) (C h179 h183)) h146) h141) h227) (C h230 h227)) (T (T (T h218 h234) h222) h233))) (T (T (T (T (T (T (T (T (T (T (T (T (T (T h5 h43) h42) h130) h129) h128) h108) h104) h98) h97) h123) h162) h160) h146) h141)
  have h264 := S h216
  have h265 := C (C h145 h214) h142
  have h266 := C (T (T (T (T (T (T (T (T (T (T (C h213 (T (T (T (T h193 h191) h172) h202) h200)) (C h213 h198)) (C h213 h201)) h265) h264) h263) h262) h225) h223) h220) h219) h8
  have h267 := T (T (T (T (T (T (T h168 h175) h190) h195) h211) h266) h251) h261
  have h268 := h v4 v4 v0
  have h269 := h y y y
  have h270 := S h269
  let v271 := M (M y (M y y)) y
  have h272 := R v271
  have h273 := h (M v55 y) v271 y
  have h274 := h v0 y v0
  have h275 := S h274
  have h276 := R (M v153 v0)
  have h277 := T (C h276 h275) h275
  have h278 := T h274 (C h276 h274)
  let v279 := M v0 y
  have h280 := h v279 v249 v0
  have h281 := R v279
  have h282 := T (T (T (T (T (T (T h257 h252) h235) h212) h193) h191) h171) h169
  have h283 := T h251 h261
  have h284 := S h273
  have h285 := C (T (T (T (T (T (T (T h122 h75) h69) h35) h12) h6) h268) (C (T (T (T (T (T h193 h191) h171) h169) h269) (C h272 h269)) (T (T (T (T (T (T (T h218 h234) h222) h233) h232) h231) h216) h215))) h282
  have h286 := C h111 h283
  have h287 := C h111 (T h211 h266)
  have h288 := C h204 h196
  let v289 := M (M x (M x x)) x
  have h290 := R x
  have h291 := h x x x
  T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (h x v4 v0) (C (T (T (T (T (T (T (T (T (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T (T h288 h287) h286) h285) h284) h265) h264) h263) h262) h225) h223) h220) h219) h290) (C (C (T h291 (C (R v289) h291)) h142) h290)) (S (h y v289 x))) h168) h175) h190) h195) (h v210 z v4)) (C h248 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h5 h43) h42) h130) h129) h128) h108) h104) h98) h97) h123) h162) h160) h166) h247) h237) h236) h209) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C h185 (T (T (T h208 h207) h206) h167)) h246) h245) h244) h243) h242) h240) h239) h288) h287) h286) h285) h284) h265) h264) h263) h262) h225) h223) h220) h219) (T (T (T (T (T h168 h175) h190) h195) h211) h266))) (C h278 h283)) (C h277 h282)) h280) (C (C h260 h281) h159)))) (C h165 (T (T (T (T (T (T (T (T (T (T (T (T (C (C h256 h281) h159) (S h280)) (C h278 h267)) (C h277 h258)) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h218 h234) h222) h233) h232) h231) h216) h215) h273) (C (T (T (T (T (T (T (T (C (T (T (T (T (T (C h272 h270) h270) h168) h175) h190) h195) (T (T (T (T (T (T (T h265 h264) h263) h262) h225) h223) h220) h219)) (S h268)) h5) h43) h42) h130) h129) h128) h267)) (C h111 h258)) (C h111 (T h235 h212))) h248) h205) h199) h197) h194) h189) h188) h186) (C h185 (T (T (T h166 h247) h237) h236))) (T (T (T (T (T h235 h212) h193) h191) h171) h169))) (S h209)) h208) h207) h206) h167) h155) h152) h124))) (C h165 h132)) (C h165 (T h118 h117))) (C h165 (T (T (T (T (T (T (T (T h108 h104) h98) h97) h123) h162) h160) h146) h141))) h159)) (S (h v1 v4 v0))) h140) h158) h155) h152) h124) h120) h119) h118) h117) h122) h75) h69) h35) h12) h6

