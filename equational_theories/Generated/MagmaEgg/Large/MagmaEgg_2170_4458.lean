import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation2170_implies_Equation4458 (G: Type _) [Magma G] (h: Equation2170 G) : Equation4458 G := fun x y z =>
  have h0 := R z
  let v1 := M z y
  let v2 := M v1 z
  let v3 := M y z
  have h4 := h v1 v3 v2
  have h5 := S h4
  have h6 := h z z y
  have h7 := h v2 y z
  have h8 := C h7 h6
  have h9 := T h8 h5
  let v10 := M v2 z
  have h11 := R (M v1 y)
  have h12 := C (S h7) (S h6)
  have h13 := T h4 h12
  have h14 := R v1
  let v15 := M y x
  have h16 := h y x v15
  have h17 := S h16
  let v18 := M v15 x
  have h19 := h v18 v15 x
  have h20 := S h19
  let v21 := M x v15
  have h22 := R v21
  have h23 := R v18
  have h24 := h v18 v21 v21
  let v25 := M v21 v21
  have h26 := R v25
  have h27 := h v21 x v15
  have h28 := C (T (C h27 h26) (S h24)) h23
  have h29 := h v25 x v15
  have h30 := C (T h29 h28) h22
  have h31 := T h30 h20
  let v32 := M v21 y
  have h33 := R v32
  have h34 := C h33 h31
  have h35 := S h29
  have h36 := C (T h24 (C (S h27) h26)) h23
  have h37 := C (T h36 h35) h22
  have h38 := h v18 v21 x
  have h39 := S h38
  have h40 := h x y x
  have h41 := S h40
  let v42 := M x y
  have h43 := R v42
  have h44 := h v18 v21 v15
  have h45 := S h44
  let v46 := M v15 v21
  have h47 := R v46
  have h48 := h v15 x v15
  have h49 := C h48 h47
  have h50 := C (T h49 h45) h43
  have h51 := h v46 y x
  have h52 := T (T h51 h50) h41
  have h53 := h x x v15
  have h54 := C (T (T (T h51 h50) h41) h53) (C h52 h22)
  have h55 := R v15
  have h56 := C h52 h55
  have h57 := C h47 h56
  let v58 := M v46 v15
  have h59 := R v58
  have h60 := S h51
  have h61 := C h60 h59
  have h62 := h v42 v15 v46
  have h63 := T (T h62 h61) h57
  have h64 := C h47 h63
  have h65 := h v21 y x
  have h66 := T (T (T (T (T h65 h64) h54) h39) h19) h37
  have h67 := C h33 h66
  have h68 := h (M v32 v21) v15 v21
  have h69 := S h68
  let v70 := M v21 v15
  have h71 := R v70
  have h72 := S h65
  have h73 := S h62
  have h74 := C (S h48) h47
  have h75 := C (T h44 h74) h43
  have h76 := T (T h40 h75) h60
  have h77 := C h76 h55
  have h78 := T (C (T h40 h75) h77) h73
  have h79 := C h47 h78
  let v80 := M x v21
  have h81 := R v80
  have h82 := S h53
  have h83 := T (T (T h82 h40) h75) h60
  have h84 := C h83 h81
  have h85 := T (T (T (T (T h30 h20) h38) h84) h79) h72
  have h86 := C h33 h85
  have h87 := T h19 h37
  have h88 := C h33 h87
  have h89 := T (T h16 h88) h86
  have h90 := C (C h76 h89) h71
  have h91 := C h51 h59
  have h92 := C (T h91 h73) h71
  have h93 := h v58 v15 v21
  have h94 := C h47 h77
  have h95 := T (T h94 h91) h73
  let v96 := M v46 v21
  have h97 := h v96 v15 v15
  have h98 := S h97
  let v99 := M v15 v15
  have h100 := R v99
  have h101 := C h100 h63
  have h102 := h v15 y x
  have h103 := h v15 v15 v21
  have h104 := S h103
  have h105 := h v58 y x
  have h106 := S h105
  have h107 := h v15 v21 v15
  have h108 := S h107
  have h109 := h v70 v15 x
  have h110 := S h109
  have h111 := h v18 z v2
  have h112 := S h111
  let v113 := M z v2
  have h114 := h v113 z v1
  have h115 := S h114
  have h116 := R v2
  have h117 := R v113
  let v118 := M z v1
  have h119 := h v118 v2 v1
  let v120 := M v1 v2
  have h121 := R v120
  have h122 := h v1 v1 z
  have h123 := C (T (C (T (T h8 h5) h122) h121) (S h119)) h117
  have h124 := h v120 v2 z
  have h125 := C (T h124 h123) h116
  have h126 := h (M v120 v2) v1 v1
  have h127 := R (M v1 v1)
  have h128 := S h122
  have h129 := C (T (C (T h119 (C (T (T h128 h4) h12) h121)) h117) (S h124)) h116
  have h130 := h v10 v2 z
  have h131 := h v1 z y
  have h132 := h v3 v1 v1
  have h133 := h v3 v1 v21
  have h134 := S h133
  let v135 := M v21 v1
  have h136 := R v135
  have h137 := h v21 z y
  have h138 := C h137 h136
  have h139 := h v135 x v15
  have h140 := C (T h139 (C (T (T (T (T (T (T (T h138 h134) h132) (C (S h131) h127)) (C (T (T (T h4 h12) h130) (C (C h9 h9) (T h114 h129))) h127)) (S h126)) h125) h115) h23)) h13
  have h141 := h (M v135 v1) v21 x
  have h142 := S h139
  have h143 := C (S h137) h136
  have h144 := C (T (C (T (T (T (T (T (T (T h114 h129) h126) (C (T (T (T (C (C h13 h13) (T h125 h115)) (S h130)) h8) h5) h127)) (C h131 h127)) (S h132)) h133) h143) h23) h142) h9
  let v145 := M v21 x
  have h146 := R v145
  have h147 := T (T (T (C (T (T (T (T h51 h50) h41) h53) (C h146 (T h111 h144))) h81) (S h141)) h140) h112
  have h148 := h v80 v15 v21
  have h149 := C (T h148 (C h147 h71)) h22
  let v150 := M v80 v21
  have h151 := h v150 x v15
  have h152 := S h151
  have h153 := S h148
  have h154 := C h146 (T h140 h112)
  have h155 := T (T (T h111 h144) h141) (C (T (T (T (T h154 h82) h40) h75) h60) h81)
  have h156 := C (T (C h155 h71) h153) h22
  have h157 := T h109 h156
  have h158 := h v42 v15 v21
  have h159 := T (T h158 (C h72 h71)) (C h22 h157)
  have h160 := C (T (T (T (C h159 h23) h152) h149) h110) h55
  have h161 := h v18 x y
  have h162 := T (T (T h49 h45) h161) h160
  have h163 := C h162 h47
  have h164 := C (T h163 h108) h59
  have h165 := h v46 v15 v46
  have h166 := C (T (C (T h165 h164) h95) h106) h71
  have h167 := h v96 v15 v21
  have h168 := h v96 v21 x
  have h169 := h v145 v21 v15
  have h170 := S h169
  have h171 := h v150 v15 x
  have h172 := S h171
  have h173 := C h147 h157
  have h174 := C (T (T (T (C (T h148 h173) h56) h172) h149) h110) h146
  have h175 := h v58 x v21
  have h176 := C (T h175 h174) h47
  have h177 := C h77 h47
  have h178 := T (T h177 h176) h170
  have h179 := C h56 h47
  have h180 := S h175
  have h181 := T h149 h110
  have h182 := C h155 h181
  have h183 := C (T (T (T h109 h156) h171) (C (T h182 h153) h77)) h146
  have h184 := C (T h183 h180) h47
  have h185 := h v145 v15 v15
  have h186 := h v99 v46 v21
  have h187 := T (T h169 h184) h179
  have h188 := S h167
  have h189 := S h165
  have h190 := S h161
  have h191 := S h158
  have h192 := T (T (C h22 h181) (C h65 h71)) h191
  have h193 := C (T (T (T h109 h156) h151) (C h192 h23)) h55
  have h194 := T (T (T h193 h190) h44) h74
  have h195 := C h194 h47
  have h196 := C (T h105 (C (T (C (T h107 h195) h59) h189) h63)) h71
  have h197 := S h102
  have h198 := C h100 h95
  have h199 := h v145 v46 v21
  have h200 := h v99 v21 v46
  have h201 := C (T (T (T (T (T (T (C (T (T h200 (C (T (T (T (T (C (T (T (T (T h177 h176) h170) h199) (C (T (C (T h97 (C (T (T (T (T h198 h197) h103) h196) h188) h100)) h187) (S h186)) h178)) h100) (S h185)) h169) h184) h179) h95)) (C h178 h63)) h81) (S h168)) h167) h166) h104) h102) h101) h100
  have h202 := h v80 v15 v15
  have h203 := T (T (T (T (T (T (T (T (T (T (T (T h38 h84) (C h47 (T (T h202 h201) h98))) (C h47 h95)) h72) h77) h93) h92) h90) h69) h67) h34) h17
  have h204 := T (T (T h65 h64) h54) h39
  have h205 := h z x v15
  have h206 := S h205
  have h207 := S h93
  have h208 := C (T h62 h61) h71
  have h209 := T (T h67 h34) h17
  have h210 := C h52 h209
  have h211 := C h210 h71
  have h212 := T (T (T (T (T (T (T (T h68 h211) h208) h207) h56) h65) h64) h54) h39
  let v213 := M v21 z
  have h214 := R v213
  have h215 := C h214 h212
  have h216 := C h214 h89
  have h217 := T (T (T (T (T (T (T h77 h93) h92) h90) h69) h67) h34) h17
  have h218 := h (M v213 y) x v15
  have h219 := C h214 h203
  have h220 := R v118
  have h221 := S h218
  have h222 := T (T (T (T (T (T h16 h88) h86) h68) (C (T (T h210 h62) h61) h71)) h207) h56
  have h223 := C h222 (T h205 h219)
  have h224 := h v118 v15 x
  have h225 := S h224
  have h226 := h v18 v21 v2
  let v227 := M v2 v21
  have h228 := R v227
  have h229 := h v2 x v15
  have h230 := C (T (C h229 h228) (S h226)) h220
  have h231 := h v227 v1 z
  have h232 := T h231 h230
  have h233 := C h232 h22
  let v234 := M v227 v21
  have h235 := S (h v234 v21 v15)
  have h236 := R v234
  have h237 := C h159 h31
  have h238 := C (T (T (C h23 (T h193 h190)) h36) h35) h22
  have h239 := h (M v70 v15) v15 x
  have h240 := T h239 h238
  have h241 := C h43 h240
  have h242 := h v96 v21 v15
  have h243 := S h242
  have h244 := h v58 x y
  have h245 := C (T (T (T h183 h180) h244) (C (T (T (T (C (T (T (T (T (T (T (T h62 h61) h57) h97) (C (T (T (T (T (T (T h198 h197) h103) h196) h188) h168) (C (T (T (C h187 h95) (C (T (T (T (T h177 h176) h170) h185) (C (T (T (T (T (C (T h186 (C (T (C (T (T (T (T h167 h166) h104) h102) h101) h100) h98) h178)) h187) (S h199)) h169) h184) h179) h100)) h63)) (S h200)) h81)) h100)) (S h202)) h148) h173) h56) h172) h149) h110) (T (T h103 h196) h188))) h47
  have h246 := C (T (T (T (T (T h176 h245) h243) h94) h91) h73) h162
  have h247 := h v46 v46 v15
  have h248 := T (T (T (T (T (T h247 h246) h241) h237) h152) h149) h110
  have h249 := C h228 h56
  have h250 := S h231
  have h251 := T h226 (C (S h229) h228)
  have h252 := T (C h251 h220) h250
  have h253 := C h252 h77
  have h254 := T (T h224 h253) h249
  have h255 := h v46 v46 v2
  have h256 := C (T (T (T (T (T (T (T h169 h245) h243) h167) h166) h104) h107) h195) h59
  have h257 := C h146 h77
  have h258 := h (M v145 v21) z v1
  have h259 := S h258
  have h260 := h v2 v15 x
  have h261 := S h260
  have h262 := C (T (C h77 h116) (C (T (T (T (T h56 h65) h64) h54) h39) h116)) h56
  let v263 := M v21 v2
  have h264 := R v263
  have h265 := C h264 h77
  have h266 := T (T h265 h262) h261
  have h267 := C h146 h56
  have h268 := C (T (T (T (C (T (T (T h109 h156) h171) (C (T (T (T (T (T (T (T h182 h153) h202) h201) h98) h94) h91) h73) h77)) (T (T h167 h166) h104)) (S h244)) h175) h174) h47
  have h269 := C (T (T (T (T (T (T (T h163 h108) h103) h196) h188) h242) h268) h170) h59
  have h270 := T (T h165 h269) h267
  have h271 := h v234 v2 x
  let v272 := M x v2
  have h273 := R v272
  let v274 := M v2 x
  have h275 := R v274
  have h276 := h x v1 z
  have h277 := S h247
  have h278 := C (T (T (T (T (T h62 h61) h57) h242) h268) h184) h194
  have h279 := T h161 h160
  have h280 := T (C (T (T h29 h28) (C h23 h279)) h22) (S h239)
  have h281 := C h43 h280
  have h282 := C h192 h87
  have h283 := h v272 v21 v15
  have h284 := C (T h283 (C (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T h109 h156) h151) h282) h281) h278) h277) h51) h50) h41) h276) (C h275 h254)) h273) (S h271)) (C h228 h77)) (C h232 h56)) h225) h270)) h266
  have h285 := C h264 h56
  have h286 := C (T (C (T (T (T (T (T (T h161 h160) h239) h238) (h (M v25 v21) v21 x)) (C (T (T (T (T (T (T (T (T (C h146 h280) (C h146 (T (T (T h193 h190) h111) h144))) h154) h82) h40) h75) h60) h165) h164) h78)) h106) h116) (C h56 h116)) h77
  have h287 := T (T h260 h286) h285
  have h288 := T (T (T (T (T (C h273 h287) h284) h259) h257) h256) h189
  have h289 := C h116 h288
  have h290 := T (T h257 h256) h189
  have h291 := T h233 h225
  have h292 := C (T (C (T (T (T (T h224 h253) h249) h271) (C (T (T (T (T (T (T (T (T (T (T (T (C h275 h291) (S h276)) h40) h75) h60) h247) h246) h241) h237) h152) h149) h110) h273)) h290) (S h283)) h287
  have h293 := T (T (T (T (T h165 h269) h267) h258) h292) (C h273 h266)
  have h294 := h (M v263 v21) x v2
  have h295 := C (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T h109 h156) h151) h282) h281) h278) h277) h165) h269) h267) h258) h292) h275) (S h294)) h265) h262) h261) h293
  have h296 := h v274 v21 v15
  have h297 := R (M v46 v2)
  have h298 := h v2 v15 v21
  have h299 := h v274 v1 z
  have h300 := C (T (T h299 (C (T (C (T (T h298 (C h297 (T (T (T (T (T (T (T (T (T h109 h156) h151) h282) h281) h278) h277) h165) h269) h267))) (C h297 h290)) (T (T h296 h295) h289)) (S h255)) h254)) (C h248 h236)) h76
  let v301 := M v274 x
  have h302 := h v301 x v15
  have h303 := T (T (T (T (T (T (T (T (T (T (T h16 h88) h86) h68) h211) h208) h207) h56) h65) h64) h54) h39
  have h304 := R v301
  have h305 := h v46 y z
  have h306 := h v3 v1 x
  let v307 := M x v1
  have h308 := R v307
  have h309 := h x z y
  have h310 := h v307 v21 v15
  have h311 := T (T (C h116 h293) (C (T (T (T (T h260 h286) h285) h294) (C (T (T (T (T (T (T (T (T (T (T (T h284 h259) h257) h256) h189) h247) h246) h241) h237) h152) h149) h110) h275)) h288)) (S h296)
  have h312 := S h299
  have h313 := C (T h255 (C (T (T (C h297 h270) (C h297 (T (T (T (T (T (T (T (T (T h257 h256) h189) h247) h246) h241) h237) h152) h149) h110))) (S h298)) h311)) h291
  have h314 := T (T (T (T (T (T h109 h156) h151) h282) h281) h278) h277
  have h315 := h v234 z v1
  have h316 := h v118 v2 v2
  let v317 := M v2 v2
  have h318 := R v317
  have h319 := h v2 v1 z
  have h320 := h v317 v1 z
  have h321 := R (M y v1)
  have h322 := R (M v2 y)
  have h323 := R x
  have h324 := T (T (T (T (T (T (T (T (C (T (T h158 (C (T h72 h77) h71)) h104) h323) h38) (C h83 h78)) h72) h77) h93) h92) h90) h69
  have h325 := C (T (T h103 (C (T h56 h65) h71)) h191) h323
  T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h77 h93) h92) h90) h69) h67) h34) h17) (h y y z)) (C (T (T (T (T (C h223 h303) h221) h216) h215) h206) h14)) h224) (C h252 h22)) (C h228 h66)) (C h228 h31)) (C h228 h325)) (C h228 h324)) (C h228 h209)) (h (M v227 y) y v1)) (C (T (T (T (T (T (T (C h321 (T (T (T (T (T (T (T (T (T (T (T (T (C h228 h89) (C h228 h212)) (C h228 h279)) (C h228 h240)) (C h228 h85)) (h v234 v15 v21)) (C (T h313 h312) h157)) (C h275 (T (T (T (C (T (T (T (T (T h202 h201) h98) h167) h166) h104) h22) h51) h50) h41))) h302) (C (T (T (T (C h204 h304) (C h251 (T (T (T h300 h235) h233) h225))) h250) (C h116 h217)) h23)) (C h322 h325)) (C h322 h324)) (C h322 h209))) (C h321 (T (T (T (T (T (C (T (T (T (T (T (T (T (T (C h116 h89) (C h116 h212)) (C h116 h279)) (C h116 h240)) (C h116 h85)) h231) h230) (C h23 (T (T (T (T (h v118 v21 v15) (C (T (T (T (T (T (T (T (T (C h71 (T (T (T (T (T h224 h253) h249) h315) (C (T (T (C h220 h291) (C (T h316 (C (S h319) h318)) h220)) (S h320)) h287)) (C h318 h266))) (C h314 (R (M v317 v2)))) (C h248 (T (T (C h318 h287) (C (T (T h320 (C (T (C h319 h318) (S h316)) h220)) (C h220 h254)) h266)) (S h315)))) (C h314 h236)) h313) h312) h296) h295) h289) h270)) (C (R (M v2 v46)) h290)) (C h311 (T h305 (C (T (C (T h306 (C (T (T (T (T (T (T (T (T (T (T (S h309) h40) h75) h60) h247) h246) h241) h237) h152) h149) h110) h308)) h47) (S h310)) h14)))) (C h275 (T (T (T (T (C (T h310 (C (T (C (T (T (T (T (T (T (T (T (T (T h109 h156) h151) h282) h281) h278) h277) h51) h50) h41) h309) h308) (S h306)) h47)) h14) (S h305)) h51) h50) h41))))) (C (T (T (T h38 h84) h79) h72) h304)) h303) (S h302)) h300) h235) h233) h225))) (C (T (T (T (T (T (T (T (C h222 h14) h139) (C (T (T h138 h134) h223) h23)) h221) h216) h215) h206) h6) h220)) (S (h v3 v1 z))) (h v3 z v1)) (C (T (T (T (C (T h119 (C h128 h121)) (R v3)) (S (h v120 z y))) h124) h123) h116)) h115) h11)) (C (C (T (T (T (T (T (T h205 h219) h218) (C (T (T (C h217 (T (T h216 h215) h206)) h133) h143) h23)) h142) (C h204 h14)) (C h203 h14)) (C h13 h0)) h11)) (S (h (M v10 z) y v1))) (C h9 h0)

