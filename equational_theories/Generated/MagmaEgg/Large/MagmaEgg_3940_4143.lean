import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3940_implies_Equation4143 (G: Type _) [Magma G] (h: Equation3940 G) : Equation4143 G := fun x y z =>
  let v0 := M x z
  let v1 := M v0 y
  let v2 := M x v0
  have h3 := R v2
  have h4 := h x z x
  have h5 := R v0
  have h6 := h v0 y v1
  have h7 := S h6
  let v8 := M v1 y
  let v9 := M v0 v8
  have h10 := h v0 v8 v0
  have h11 := R v9
  have h12 := h x z v1
  have h13 := S h12
  let v14 := M v1 z
  let v15 := M x v14
  have h16 := R v15
  have h17 := C (T (C h16 h7) h13) h11
  have h18 := h v15 v1 v9
  have h19 := T (T h12 h18) h17
  have h20 := C h19 h5
  have h21 := T h20 (S h10)
  let v22 := M v0 v0
  have h23 := S h18
  have h24 := C (T h12 (C h16 h6)) h11
  have h25 := T (T (T (C h5 h21) h24) h23) h13
  have h26 := R v1
  have h27 := T (T h24 h23) h13
  have h28 := C h27 h5
  have h29 := T h10 h28
  have h30 := C h29 h26
  have h31 := T h6 h30
  have h32 := C h31 h25
  have h33 := T (T (T h12 h18) h17) (C h5 h29)
  have h34 := C h21 h26
  have h35 := T h34 h7
  have h36 := h v0 y v0
  have h37 := S h36
  let v38 := M v0 v1
  have h39 := R v38
  have h40 := h v38 v22 v0
  have h41 := C (T (T (T (C h39 h29) h40) (C (T (T (T (C h39 h25) h37) h6) h30) h5)) (C h35 h33)) h5
  have h42 := h v38 v8 v0
  have h43 := h v38 v8 x
  have h44 := S h43
  have h45 := R x
  have h46 := h x v8 v0
  have h47 := h x v0 v0
  have h48 := C (C h39 (T (T h47 (C (C h45 h21) h5)) (S h46))) h45
  have h49 := h v38 v0 x
  have h50 := R v14
  have h51 := R v22
  have h52 := S h40
  have h53 := C (T (T (T h34 h7) h36) (C h39 h33)) h5
  have h54 := h v9 v1 v1
  have h55 := S h54
  let v56 := M v1 v1
  have h57 := R v56
  have h58 := h v1 y v0
  have h59 := C (C h5 (S h58)) h57
  have h60 := h v0 v0 v56
  have h61 := h v0 v0 v22
  have h62 := C h13 h5
  have h63 := h v15 y v0
  let v64 := M v0 (M y y)
  have h65 := h v15 y v64
  have h66 := S h65
  have h67 := R v64
  have h68 := h v0 y y
  have h69 := C (T h12 (C h16 h68)) h67
  have h70 := C (T (C h16 (S h68)) h13) h67
  have h71 := S h63
  have h72 := C h12 h5
  let v73 := M x y
  have h74 := h x z v73
  have h75 := S h74
  let v76 := M v73 y
  let v77 := M x v76
  let v78 := M x (M v73 z)
  have h79 := h v78 v73 v77
  have h80 := S h79
  have h81 := R v77
  have h82 := h x y v73
  have h83 := R v78
  have h84 := C (T h74 (C h83 h82)) h81
  have h85 := T (T h84 h80) h75
  have h86 := h v0 v77 v0
  have h87 := C (T (C h83 (S h82)) h75) h81
  have h88 := h x z v0
  have h89 := S h88
  let v90 := M v0 z
  let v91 := M x v90
  have h92 := h v91 v0 v0
  have h93 := S h92
  have h94 := h v0 z x
  have h95 := h x x v22
  have h96 := T h95 (C (C h45 (S h94)) h51)
  have h97 := C (T (T (T (T (T (C h96 h25) h93) h89) h12) h18) h17) h5
  let v98 := M x x
  have h99 := h v98 v22 v0
  have h100 := h x x v1
  have h101 := S h100
  have h102 := h v38 v0 v91
  have h103 := S h102
  have h104 := R v91
  have h105 := C (T h36 (C h39 h88)) h104
  have h106 := T (T h105 h103) h37
  have h107 := h v1 v90 x
  have h108 := C (C h45 (T h107 (C h106 h45))) h26
  let v109 := M x (M v1 v90)
  have h110 := R v109
  have h111 := C (T (T (C h110 h35) h108) h101) h51
  have h112 := h v109 v1 v22
  have h113 := S h107
  have h114 := C (T (C h39 h89) h37) h104
  have h115 := T (T h36 h102) h114
  have h116 := C h115 h45
  have h117 := C (C h45 (T h116 h113)) h26
  have h118 := T (T (T (T (T (T h100 h117) h112) h111) h99) h97) h28
  have h119 := R v90
  have h120 := h v0 y v14
  have h121 := S h120
  let v122 := M v0 (M v14 y)
  have h123 := h v122 v14 v14
  have h124 := S h123
  have h125 := h v1 z v1
  have h126 := S h125
  have h127 := h v1 v14 v1
  have h128 := h v1 v22 v0
  have h129 := T (T (T (T (T (T h128 (C (T (T (T h32 h53) h52) (C h39 h21)) h5)) (S h42)) h43) (C (C h39 (T (T h46 (C (C h45 h29) h5)) (S h47))) h45)) (S h49)) h37
  let v130 := M v1 v14
  let v131 := M v1 v130
  have h132 := R v131
  have h133 := h v131 v22 v1
  have h134 := h v131 v22 v0
  have h135 := R v130
  have h136 := R v122
  have h137 := h v122 v1 v130
  have h138 := h v122 y v0
  let v139 := M y z
  let v140 := M v1 v139
  have h141 := h v122 y v140
  have h142 := R v140
  have h143 := h v1 z y
  let v144 := M v1 v140
  have h145 := h v144 v0 v0
  have h146 := h v144 v22 v1
  have h147 := T (T (T (T (T (T h36 h49) h48) h44) h42) h41) (S h128)
  have h148 := R v144
  have h149 := h v1 v139 v1
  have h150 := h v1 v139 x
  let v151 := M x v139
  have h152 := R v151
  have h153 := h x z y
  have h154 := h v38 y v151
  have h155 := h v38 y v0
  have h156 := h v38 v1 v15
  have h157 := S h156
  have h158 := C (T h36 (C h39 h12)) h16
  have h159 := h (M v1 v15) z x
  have h160 := R z
  have h161 := C (T (C h39 h13) h37) h16
  have h162 := h v1 v91 v1
  have h163 := S h162
  let v164 := M v14 z
  let v165 := M v1 v164
  have h166 := h v122 v14 v165
  have h167 := S h166
  have h168 := R v165
  have h169 := h v1 z v14
  have h170 := C (T h120 (C h136 h169)) h168
  have h171 := T (T h170 h167) h121
  have h172 := C (T (C h136 (S h169)) h121) h168
  have h173 := T (T h120 h166) h172
  have h174 := C h173 h26
  have h175 := h v122 z v1
  let v176 := M z z
  let v177 := M v1 v176
  have h178 := h v122 z v177
  have h179 := R v177
  have h180 := h v1 z z
  have h181 := C (T (T (T (T (T (C (T h120 (C h136 h180)) h179) (S h178)) h175) (C h121 h26)) h174) (C h171 h115)) h26
  have h182 := h v1 v176 v1
  have h183 := h v0 v176 v1
  have h184 := h v0 z z
  have h185 := h v90 y v0
  let v186 := M v122 (M v14 v14)
  have h187 := R v186
  have h188 := h v186 y v90
  have h189 := h v186 y v140
  have h190 := T (T (T (C (T (T h120 h123) (C h187 h143)) h142) (S h189)) h188) (C (T (T (C h187 (T (T (T (T (T (T (T h185 (C (T (C (T (T (T (T (T (T h184 (C (T (T (T h183 (C (C h5 (T (T (T (T (T h182 h181) h163) h105) h103) h37)) h26)) h156) h161) h160)) h159) (C (T (T (T (C (T h158 h157) h5) (S h155)) h154) (C (T (C h39 (S h153)) h37) h152)) h45)) (S h150)) h149) (C h148 h147)) h26) (S h146)) h5)) (S h145)) (C (T (T (T (T (C (T h120 (C h136 h143)) h142) (S h141)) h138) (C (T h137 (C (T (C h136 h126) h121) h135)) h5)) (C h132 h33)) h5)) (S h134)) h133) (C (T (C h132 h129) (S h127)) h26)) h126)) h124) h121) h119)
  have h191 := h x v140 v1
  let v192 := M x v140
  have h193 := h v192 v98 v1
  have h194 := R v98
  have h195 := h v38 v0 v98
  have h196 := R v192
  have h197 := h x v139 v1
  have h198 := S h197
  have h199 := h v192 v22 v1
  have h200 := S h60
  have h201 := C (C h5 h58) h57
  have h202 := h v22 v56 v1
  have h203 := C h171 h26
  have h204 := h v1 v164 v1
  have h205 := C (T (T (T (T (T (T (T (T (T (C h196 (T (T (T (T (T h174 (C (T (T (T (T (T h170 h167) h121) h6) h54) (C (T h201 h200) (T (T (T h120 h166) h172) (C h26 (T h204 h203))))) h26)) (S h202)) (C h21 h57)) h201) h200)) h199) (C (T (C h196 h129) h198) h26)) (C (T h197 (C h196 (T (T h36 h195) (C (T (C h39 (T (T (C h96 h5) h93) h89)) h37) h194)))) h26)) (S h193)) (C (T (T (T (T (T (T h191 (C (C h45 h190) h26)) h112) h111) h99) h97) h28) h118)) (C (T h20 (C h27 (T (T (T (T (T h74 h79) h87) h86) (C (T (T (T (T (T (C h19 h85) h28) h72) h71) h65) h70) h5)) (C (T (T (T h69 h66) h63) h62) h5)))) h51)) (S h61)) h60) h59) h26
  let v206 := M x v176
  have h207 := S h143
  have h208 := C (T (T (C h187 h207) h124) h121) h142
  have h209 := S h188
  have h210 := C (T (T h120 h123) (C h187 (T (T (T (T (T (T (T h125 (C (T h127 (C h132 h147)) h26)) (S h133)) h134) (C (T (T (T (T (C h132 h25) (C (T (C (T h120 (C h136 h125)) h135) (S h137)) h5)) (S h138)) h141) (C (T (C h136 h207) h121) h142)) h5)) h145) (C (T h146 (C (T (T (T (T (T (T (C h148 h129) (S h149)) h150) (C (T (T (T (C (T h36 (C h39 h153)) h152) (S h154)) h155) (C (T h156 h161) h5)) h45)) (S h159)) (C (T (T (T h158 h157) (C (C h5 (T (T (T (T (T h36 h102) h114) h162) (C (T (T (T (T (T (C h173 h106) h203) (C h120 h26)) (S h175)) h178) (C (T (C h136 (S h180)) h121) h179)) h26)) (S h182))) h26)) (S h183)) h160)) (S h184)) h26)) h5)) (S h185)))) h119
  have h211 := T (h v0 v76 x) (C h85 h45)
  let v212 := M v151 v76
  let v213 := M x v73
  have h214 := T (C (C h45 h94) h51) (S h95)
  have h215 := S h112
  have h216 := C (T (T h100 h117) (C h110 h31)) h51
  have h217 := S h99
  have h218 := C (T (T (T (T (T h24 h23) h13) h88) h92) (C h214 h33)) h5
  T (T (T (T (T (T (T (T (T h82 (h v77 v73 x)) (h (M v77 v213) x v14)) (C (C (T (T (T (T (T (h v77 v213 v0) (C (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (h x v76 v0) (C (C h45 h211) h5)) (S (h x x v0))) h100) h117) h112) h111) h99) h97) h28) h61) (C (T (C h19 (T (T (T (T (T (C (T (T (T h72 h71) h65) h70) h5) (C (T (T (T (T (T h69 h66) h63) h62) h20) (C h27 (T (T h74 h79) h87))) h5)) (S h86)) h84) h80) h75)) h28) h51)) (C (T (T (T (T (T (T h20 h218) h217) h216) h215) (C (C h45 (T (T (T h210 h209) h189) h208)) h26)) (S h191)) (T (T (T (T (T (T h20 h218) h217) h216) h215) h108) h101))) h193) (C (T (C h196 (T (T (C (T h36 (C h39 (T (T h88 h92) (C h214 h5)))) h194) (S h195)) h37)) h198) h26)) (C (T h197 (C h196 h147)) h26)) (S h199)) (C h196 (T (T (T (T (T h60 h59) (C h29 h57)) h202) (C (T (T (T (T (T (C (T h60 h59) (T (T (T (C h26 (T h174 (S h204))) h170) h167) h121)) h55) h7) h120) h166) h172) h26)) h203))) (T (T (T (T (T (T (T (T (T (T (C (T (T h153 (h v151 y v73)) (C (R v212) (h x y x))) (R v213)) (S (h v212 x v213))) (h v212 x x)) (C (T (T (T (T (T (T (T (T (T (h v212 v98 v0) (C (C (T (T (T (T (T (T (T (T (h v151 v76 v14) (C (C (T (T (T (T h197 (h v192 v1 v1)) h205) h55) h7) (T (T (h v14 v76 v0) (C (C h50 h211) h5)) (S (h v14 x v0)))) h50)) (S (h v1 x v14))) h116) h113) h210) h209) h189) h208) (R (M v0 v98))) h5)) (S (h v144 v98 v0))) (C h190 h118)) (C (C h26 h94) h51)) (S (h v1 x v22))) (C h36 h45)) (S (h v38 z x))) (h v38 z v206)) (C (T (C h39 (S (h x z z))) h37) (R v206))) h45)) (S (h v1 v176 x))) h182) h181) h163) h105) h103) h37)) h205) h55) h30) h5)) h53) h52) (C (C h5 h31) h51)) (S (h v0 v1 v22))) (R (M v14 x))) h50)) (S (h v38 x v14))) (h v38 x v2)) (C (T (C h39 (S h4)) h37) h3)) (C (T (T (T (T (T (T h36 h49) h48) h44) h42) h41) (C (T (T (T (T h32 (S (h v22 y v0))) (C h21 (R y))) (h v9 y v0)) (C h7 h5)) h4)) h3)) (S (h (M v1 v0) x v2))) (S (h v1 z x))

