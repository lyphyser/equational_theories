import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3385_implies_Equation4491 (G: Type _) [Magma G] (h: Equation3385 G) : Equation4491 G := fun x y z =>
  let v0 := M z x
  have h1 := h v0 z y
  have h2 := S h1
  let v3 := M v0 z
  have h4 := h y (M v0 (M z y)) v3
  have h5 := S h4
  have h6 := R v3
  have h7 := h z y y
  let v8 := M y y
  have h9 := h z v8 v8
  have h10 := S h9
  have h11 := h y y y
  have h12 := S h11
  have h13 := R v8
  have h14 := C h13 h12
  have h15 := h y y v8
  have h16 := T h15 h14
  have h17 := R z
  have h18 := C h17 h16
  have h19 := C h13 (T (T (C h13 h18) h10) h18)
  have h20 := h v8 z v8
  let v21 := M x v8
  have h22 := h v8 z v21
  have h23 := h z x v8
  have h24 := R v21
  have h25 := T (T (T (T (C h24 h23) (S h22)) h20) h19) h10
  have h26 := R y
  have h27 := R v0
  have h28 := C h27 (T (C h26 h25) (S h7))
  have h29 := h y v21 v0
  have h30 := h y v21 v21
  have h31 := S h30
  have h32 := h x v8 v8
  have h33 := S h32
  have h34 := R x
  have h35 := C h34 h16
  have h36 := C h13 (T (T (C h13 h35) h33) h35)
  have h37 := h v8 v8 v21
  have h38 := S h15
  have h39 := C h13 h11
  have h40 := h v8 v8 x
  have h41 := h v8 x v8
  have h42 := S h41
  have h43 := T h39 h38
  have h44 := C h34 h43
  have h45 := C h13 (T (T h44 h32) (C h13 h44))
  have h46 := C h24 (T (C h26 (T (T (T (C h34 (T h32 (C h13 (T (T (T h44 h32) h45) h42)))) (S h40)) h39) h38)) (C h26 (T (T (T h15 h14) h37) (C h24 (T h36 h33)))))
  have h47 := h y x v21
  have h48 := h y x y
  have h49 := h x y y
  have h50 := h y (M y v21) v3
  have h51 := S h29
  have h52 := C h17 h43
  have h53 := C h27 (T h7 (C h26 (T (T (T (T h9 (C h13 (T (T h52 h9) (C h13 h52)))) (S h20)) h22) (C h24 (S h23)))))
  have h54 := C h6 (C h26 (C (T (T (T (T (T (T (C h26 (T (T (T (T h1 h4) (C h6 (C h26 (C (T h53 h51) h6)))) (S h50)) (C h26 (S h49)))) (S h48)) h47) h46) h31) h29) h28) h6))
  have h55 := C h26 (T (T (T (T (C h26 h49) h50) (C h6 (C h26 (C (T h29 h28) h6)))) h5) h2)
  have h56 := h v0 z v3
  have h57 := S h56
  let v58 := M v0 (M z v3)
  have h59 := h v3 v58 v3
  have h60 := S h59
  have h61 := h z v3 v8
  let v62 := M y v3
  have h63 := h y v62 v3
  have h64 := T (T (T h63 h54) h5) h2
  have h65 := C h64 h13
  have h66 := h y y v3
  have h67 := S h63
  have h68 := C h34 (T (C h13 (T (T (T h41 h36) h33) h35)) h33)
  have h69 := C h6 (C h26 (C (T (T (T (T (T (T h53 h51) h30) (C h24 (T (C h26 (T (T (T (C h24 (T h32 h45)) (S h37)) h39) h38)) (C h26 (T (T (T h15 h14) h40) h68))))) (S h47)) h48) h55) h6))
  have h70 := T (T (T h1 h4) h69) h67
  have h71 := C h64 h70
  have h72 := C h70 (T h71 (S h66))
  have h73 := C h70 h64
  let v74 := M y v62
  have h75 := h v3 v74 v8
  have h76 := S h75
  have h77 := C h6 h72
  have h78 := h v3 v74 v3
  have h79 := C h13 (T (T (T (C h70 h6) h71) h78) h77)
  have h80 := C h6 (T (T h79 h76) h73)
  have h81 := h v8 v3 v3
  have h82 := T (T (T h81 h80) h72) h65
  have h83 := C h17 h82
  have h84 := h v8 v0 z
  have h85 := h v8 v8 v0
  have h86 := T (T (T h15 h14) h85) (C h27 (T (C h13 (T h84 h83)) (S h61)))
  have h87 := C h86 h6
  have h88 := S h81
  have h89 := S h78
  have h90 := C h64 (T h66 h73)
  have h91 := C h6 h90
  have h92 := C h13 (T (T (T h91 h89) h73) (C h64 h6))
  have h93 := C h6 (T (T h71 h75) h92)
  have h94 := C h6 (T (T (T (T h79 h76) h78) h77) (C h6 (T (T (T h90 h93) h88) h87)))
  have h95 := C h70 h13
  have h96 := T (T (T (T (T h95 h90) h93) h94) h60) h57
  let v97 := M v8 v3
  have h98 := h x v97 v3
  have h99 := S h84
  have h100 := T (T (T h95 h90) h93) h88
  have h101 := C h17 h100
  have h102 := T (T (T (C h27 (T h61 (C h13 (T h101 h99)))) (S h85)) h39) h38
  have h103 := C h102 h6
  have h104 := C h6 (T (T (T (T (C h6 (T (T (T h103 h81) h80) h72)) h91) h89) h75) h92)
  have h105 := h v0 z v0
  have h106 := S h105
  have h107 := h v0 (M v0 (M z v0)) v3
  have h108 := S h107
  have h109 := h z v0 z
  have h110 := C h17 h96
  have h111 := T (T h84 h83) h110
  have h112 := h z v8 v0
  have h113 := C h6 (C h27 (C (T h112 (C h27 (T (C h17 h111) (S h109)))) h6))
  have h114 := h v0 (M z v8) v3
  have h115 := C (T (T (T (T (T (T (T h114 h113) h108) h106) h56) h59) h104) h88) h6
  have h116 := S h114
  have h117 := S h112
  have h118 := T (T (T (T (T h56 h59) h104) h80) h72) h65
  have h119 := T (T (C h17 h118) h101) h99
  have h120 := C h17 h119
  have h121 := C h6 (C h27 (C (T (C h27 (T h109 h120)) h117) h6))
  have h122 := T (T (T h105 h107) h121) h116
  have h123 := C h122 (T (T (T (T (T (T (C h13 h82) (C h86 h96)) h103) h81) h94) h60) h57)
  have h124 := h v8 v8 v3
  have h125 := C h34 (T (T (T (T h15 h14) h124) h123) h115)
  have h126 := T (T (T h114 h113) h108) h106
  have h127 := T (T (T (T (T (C h70 h24) (C (T (T (T (T (T (T (T h63 h54) h5) h2) h105) h107) h121) h116) h24)) (C h126 h125)) (S h98)) (C h34 h82)) (C h34 h96)
  have h128 := S h124
  have h129 := C h126 (T (T (T (T (T (T h56 h59) h104) h88) h87) (C h102 h118)) (C h13 h100))
  have h130 := C (T (T (T (T (T (T (T h81 h94) h60) h57) h105) h107) h121) h116) h6
  have h131 := C h34 (T (T (T (T h130 h129) h128) h39) h38)
  have h132 := T (T (T h81 h94) h60) h57
  have h133 := T (T (T h56 h59) h104) h88
  have h134 := C h133 h131
  have h135 := S (h x v97 v0)
  have h136 := S (h z x z)
  have h137 := S (h z (M z (M x z)) v3)
  have h138 := h x z v3
  have h139 := h v8 z x
  have h140 := C h102 h17
  have h141 := h v3 v58 z
  have h142 := C h6 (T (T (T (T h140 h20) h19) h10) (C h17 (T (T (T (T (T h15 h14) h124) h123) h115) (C (T (T (T (T h81 h94) h60) h141) (C h17 (T (C h6 (T (T h140 h139) (C h34 h111))) (S h138)))) h6))))
  have h143 := C h27 (T (C h34 h25) (C h34 (T (T (h z v8 v3) (C h6 (T h99 (C h86 h27)))) (C h133 (T (T (T (T (T (T (T (T (T (T (T (C h102 h27) h84) h83) h110) (h z v3 v21)) (C h24 (T (T (T (T (T (T (T (C h17 h127) (S (h x v0 z))) (h x v0 v0)) (C h27 (S (h v0 z x)))) (C h27 (T (T (T (T h56 h141) (C h17 (T (T h142 h137) h136))) h109) h120))) h117) (h z v8 x)) (C h34 (C h17 (T (T h41 h36) h33)))))) (S (h x z v21))) h138) (C h6 (T (T (C h34 h119) (S h139)) (C h86 h17)))) h142) h137) h136)))))
  have h144 := h x v21 v0
  have h145 := S (h y v8 x)
  have h146 := C h34 (C h26 (T (T h32 h45) h42))
  have h147 := C h34 (T (T (T (T (C h13 (T (T h47 h46) h31)) (S (h y x v8))) h47) h46) h31)
  have h148 := h v8 y x
  T (T (T (T (T (h x v8 y) (h y (M x (M v8 y)) v3)) (C h6 (C h26 (C (T (T (T (C h34 (T (T (T (T (T h148 h147) h146) h145) (h y v8 y)) (C h26 (T (T (T (T (T (T (T (T (T (T (T (T (C h26 (T (T (T h148 h147) h146) h145)) h12) h15) h14) h40) h68) h144) h143) h135) h98) h134) (C h132 (T (T (T h125 (C h34 (T (T (T (T (T (T (T (T (T h130 h129) h128) h40) h68) h144) h143) h135) h98) h134))) (C h34 (T (T (T (C h132 h125) (C h122 h131)) (C (T (T (T (T (T (T (T h114 h113) h108) h106) h1) h4) h69) h67) h24)) (C h64 h24)))) (C h34 h127)))) (S (h x x v3)))))) (S (h y x x))) h48) h55) h6)))) h54) h5) h2

