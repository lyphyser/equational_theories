import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation2349_implies_Equation2271 (G: Type _) [Magma G] (h: Equation2349 G) : Equation2271 G := fun x y z =>
  let v0 := M y z
  let v1 := M x (M x (M v0 v0))
  have h2 := h z v1 y
  have h3 := S h2
  have h4 := R y
  have h5 := h v0 x v0
  have h6 := R v1
  have h7 := C (T h5 (C h6 h5)) h4
  let v8 := M y v0
  let v9 := M v0 (M v0 v8)
  have h10 := h y v1 v9
  have h11 := S h10
  have h12 := R v9
  have h13 := h v0 v0 y
  have h14 := C (T h5 (C h6 (T h5 (C h6 h13)))) h12
  have h15 := T h14 h11
  have h16 := R v0
  have h17 := C h16 h15
  have h18 := T (T h17 h7) h3
  let v19 := M x v8
  have h20 := R v19
  have h21 := C h20 h18
  have h22 := S h5
  have h23 := C (T (C h6 (T (C h6 (S h13)) h22)) h22) h12
  have h24 := T h10 h23
  let v25 := M x (M x (M v8 v8))
  have h26 := h v0 v25 y
  have h27 := S h26
  have h28 := h v8 x v8
  have h29 := R v25
  have h30 := C (T h28 (C h29 h28)) h4
  have h31 := R v8
  have h32 := C h31 h15
  let v33 := M v0 v9
  have h34 := h v33 y v0
  have h35 := S h34
  have h36 := T (T h32 h30) h27
  have h37 := C h16 h24
  have h38 := C (T (C h6 h22) h22) h4
  have h39 := T (T h2 h38) h37
  have h40 := C h4 h39
  have h41 := C h4 (T (T (T h32 h30) h27) h40)
  have h42 := C h31 h24
  have h43 := S h28
  have h44 := C (T (C h29 h43) h43) h4
  have h45 := T (T h26 h44) h42
  have h46 := C h4 h45
  have h47 := C (T h46 h41) h36
  have h48 := C h31 (T h47 h35)
  have h49 := C h4 h36
  have h50 := C h4 h18
  have h51 := C h4 (T (T (T h50 h26) h44) h42)
  have h52 := C (T h51 h49) h45
  let v53 := M y v8
  have h54 := h y y v53
  have h55 := R v53
  have h56 := h z y y
  let v57 := M v19 z
  have h58 := h v8 v57 v0
  have h59 := S h58
  have h60 := h v33 v8 v8
  have h61 := R v57
  have h62 := C (C h61 (C h61 (T h60 (C (T (T (T h48 h32) h30) h27) h31)))) h16
  have h63 := h v9 v57 v0
  have h64 := C (T (T (T (T (C h31 (T (T (T (T (T (T (C h31 (T (C h4 (T (T (T h63 h62) h59) h46)) (C h4 h49))) (C (C h4 (C h4 h56)) h55)) (S h54)) h10) h23) h34) h52)) h48) h32) h30) h27) h24
  have h65 := h v9 v8 y
  have h66 := C h20 (T h65 h64)
  have h67 := S h65
  have h68 := S h63
  have h69 := C h31 (T h34 h52)
  have h70 := C (C h61 (C h61 (T (C (T (T (T h26 h44) h42) h69) h31) (S h60)))) h16
  have h71 := C (T (T (T (T h26 h44) h42) h69) (C h31 (T (T (T (T (T (T h47 h35) h14) h11) h54) (C (C h4 (C h4 (S h56))) h55)) (C h31 (T (C h4 h46) (C h4 (T (T (T h49 h58) h70) h68))))))) h15
  let v72 := M x (M x (M v57 v57))
  have h73 := h z v72 v19
  have h74 := S h73
  have h75 := h v57 x v57
  have h76 := R v72
  have h77 := C (T h75 (C h76 h75)) h20
  let v78 := M z v57
  let v79 := M z v78
  let v80 := M x (M x (M z z))
  have h81 := h v19 v80 v79
  have h82 := S h81
  have h83 := R v79
  have h84 := h z z v19
  have h85 := R v80
  have h86 := h z x z
  have h87 := C (T h86 (C h85 (T h86 (C h85 h84)))) h83
  have h88 := T (T (T (T (T (T (T h58 h70) h68) h65) h64) h17) h7) h3
  have h89 := C h88 h83
  have h90 := C h61 (T (T h89 h87) h82)
  have h91 := R v78
  have h92 := C h88 h91
  have h93 := C h31 h92
  have h94 := C h61 h93
  have h95 := C h20 (T (T (T (T (T (T (T (T h94 h90) h77) h74) h2) h38) h37) h71) h67)
  have h96 := T (T (T (T (T (T (T h2 h38) h37) h71) h67) h63) h62) h59
  have h97 := C h96 h91
  have h98 := C h31 h97
  have h99 := C h61 h98
  let v100 := M v8 v78
  have h101 := h (M v8 v100) y v57
  have h102 := S h101
  have h103 := T h66 h21
  have h104 := C h96 h83
  have h105 := S h86
  have h106 := S h84
  have h107 := C (T (C h85 (T (C h85 h106) h105)) h105) h83
  have h108 := C h61 (T (T h81 h107) h104)
  have h109 := S h75
  have h110 := C (T (C h76 h109) h109) h20
  have h111 := C h4 (T (T (T (T (T (T h17 h7) h3) h73) h110) h108) h99)
  have h112 := C h4 h111
  have h113 := C (T (T h46 h41) h112) h103
  have h114 := C h20 (T h71 h67)
  have h115 := C h20 h39
  have h116 := T h115 h114
  have h117 := C h96 h116
  have h118 := C h61 (T (T (T h117 h113) h102) h93)
  have h119 := T h118 h99
  have h120 := C h20 h119
  have h121 := C h88 h103
  have h122 := C h20 (T (T h58 h70) h68)
  have h123 := C h31 h122
  have h124 := T h123 h121
  have h125 := C h61 h124
  have h126 := C h20 h125
  have h127 := C h20 (T (T h63 h62) h59)
  have h128 := C h31 h127
  have h129 := T h117 h128
  have h130 := C h61 h129
  have h131 := C h4 (T (T (T (T (T (T h94 h90) h77) h74) h2) h38) h37)
  have h132 := C h4 h131
  have h133 := C (T (T h132 h51) h49) h116
  have h134 := C h61 (T (T (T h98 h101) h133) h121)
  let v135 := M v19 v8
  have h136 := h (M v8 v135) v8 z
  have h137 := S h136
  have h138 := C h88 h129
  have h139 := h v100 v57 v8
  have h140 := S h139
  have h141 := C h61 h125
  have h142 := C (T h141 (C h61 h119)) h31
  have h143 := h v135 v57 v8
  have h144 := T (T (T (T (T (T h115 h114) h127) h143) h142) h140) (C h31 (T (T (T h117 h113) h102) (C h31 h138)))
  have h145 := C h144 (T (T (T (T h125 h118) h90) h77) h74)
  have h146 := C (T (T (T (T (T (T h115 h114) h127) h143) h142) h140) h92) (T (T (T (T (T (T (T (T h145 h137) h123) h113) h102) h93) h89) h87) h82)
  have h147 := S h143
  have h148 := C h61 h130
  have h149 := T h94 h134
  have h150 := C (T (C h61 h149) h148) h31
  have h151 := C h96 h124
  have h152 := T (T (T (T (T (T (C h31 (T (T (T (C h31 h151) h101) h133) h121)) h139) h150) h147) h122) h66) h21
  have h153 := C h152 (T (T (T (T h73 h110) h108) h134) h130)
  have h154 := C h61 h148
  have h155 := C h144 (T (T h154 h146) h106)
  have h156 := C h61 h141
  have h157 := C (T (T (T (T (T (T h97 h139) h150) h147) h122) h66) h21) (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h153)
  have h158 := h (M v57 v78) v57 v57
  have h159 := S h158
  have h160 := C h152 (T (T h84 h157) h156)
  have h161 := C (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) (T (T (T (T (T (T h151 h139) h150) h147) h122) h66) h21)
  have h162 := C h20 h138
  have h163 := C h20 h97
  have h164 := C h61 (T (T (T (T (T (T (T (T (T (T h163 h162) h161) h159) h118) h90) h77) h74) h84) h157) h156)
  have h165 := C h61 (T (T h164 h155) h153)
  have h166 := C h20 (T (T (T (T (T (T h120 h95) h127) h143) h142) h140) h92)
  have h167 := C h20 h126
  have h168 := C h20 h130
  have h169 := C h20 h149
  have h170 := C h20 (T h169 h168)
  have h171 := C h20 (T (T (T (T (T (T (T (T h65 h64) h17) h7) h3) h73) h110) h108) h99)
  have h172 := C h20 h171
  have h173 := C h20 h114
  have h174 := C h20 h115
  have h175 := C h61 (T (T (T (T (T h174 h173) h172) h170) h167) h166)
  have h176 := C h61 h175
  have h177 := T (T (T (T (T (T (T (T h176 h165) h146) h106) h73) h110) h108) h134) h130
  have h178 := C h20 h177
  let v179 := M v19 v57
  let v180 := M v57 v179
  let v181 := M v57 v180
  have h182 := h v181 z v57
  have h183 := S h182
  have h184 := R (M v57 v181)
  have h185 := C h20 h21
  have h186 := C h20 h66
  have h187 := C h61 (T (T (C h20 h122) h186) h185)
  have h188 := C h61 h187
  have h189 := C h61 h188
  have h190 := C h61 (T (T h174 h173) (C h20 h127))
  have h191 := C h61 h190
  have h192 := C h20 h95
  have h193 := C h20 (T h126 h120)
  have h194 := C h20 h168
  have h195 := C h20 (T (T (T (T (T (T h97 h139) h150) h147) h122) h171) h169)
  have h196 := C h61 (T (T (T (T (T h195 h194) h193) h192) h186) h185)
  have h197 := C h61 h196
  have h198 := C h20 h92
  have h199 := C h20 h151
  have h200 := C (T (T (T (T (T (T (T (T h155 h137) h123) h113) h102) h93) h89) h87) h82) (T (T (T (T (T (T h115 h114) h127) h143) h142) h140) h138)
  have h201 := C h61 (T (T (T (T (T (T (T (T (T (T h154 h146) h106) h73) h110) h108) h134) h158) h200) h199) h198)
  have h202 := C h61 (T (T h145 h160) h201)
  have h203 := C h61 (T (T (T (T (T (T (T (T (T (T (T (T h163 h162) h161) h159) h118) h90) h77) h74) h84) h157) h202) h197) h191)
  have h204 := T (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h203) h189
  have h205 := C h61 h198
  have h206 := C h61 h205
  have h207 := h v100 v57 v19
  have h208 := C h61 (T (T (T (T (T (T (T (T (T (T (T (T h188 h176) h165) h146) h106) h73) h110) h108) h134) h158) h200) h199) h198)
  have h209 := C h61 h191
  have h210 := h v180 v57 v57
  have h211 := C (T (T (T (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h196) h210) (C (T (T (T (T (T (T (T (T (T (T (T (C h61 (T h209 h208)) h165) h146) h106) h2) h38) h37) h71) h67) h63) h62) h59) (T (T (T (T (T (T (T h115 h114) h127) h143) h142) h140) h207) (C (T (T (T (T (T (T (T (T (T (T (T h206 h165) h146) h106) h2) h38) h37) h71) h67) h63) h62) h59) h204)))) (C h88 (C h88 h184))) (T (T (T (T (T h178 h126) h120) h95) h66) h21)
  have h212 := C h20 (T h211 h183)
  have h213 := T (T (T (T (T (T (T (T h125 h118) h90) h77) h74) h84) h157) h202) h197
  have h214 := C h20 h213
  have h215 := h v57 v57 v19
  have h216 := S h215
  have h217 := C (T (T (T (T (T (T (T (T (T (T (T h58 h70) h68) h65) h64) h17) h7) h3) h84) h157) h202) h197) (T (T (T (T (T (T (T (T (T (T h175 h164) h155) h137) h123) h113) h102) h93) h89) h87) h82)
  have h218 := R v180
  have h219 := C h96 h218
  have h220 := C h20 (T (T (T (T (T (T (T (T h219 h217) h216) h115) h114) h171) h169) h168) h214)
  have h221 := C h20 h220
  have h222 := C h88 h218
  have h223 := C h20 h222
  have h224 := C h20 h223
  have h225 := C h20 h219
  have h226 := C (T (T (T (T (T (T (T (T (T (T (T h176 h165) h146) h106) h2) h38) h37) h71) h67) h63) h62) h59) (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h196)
  have h227 := C h20 (T (T (T (T (T (T (T (T h178 h126) h120) h95) h66) h21) h215) h226) h222)
  have h228 := T (T (T (T (T (T (T (T (T (T (T h209 h208) h164) h155) h137) h123) h113) h102) h93) h89) h87) h82
  have h229 := C h61 h163
  have h230 := C h61 h229
  have h231 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (C h96 (C h96 h184)) (C (T (T (T (T (T (T (T (T (T (T (T h58 h70) h68) h65) h64) h17) h7) h3) h84) h157) h202) (C h61 (T h203 h189))) (T (T (T (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T h58 h70) h68) h65) h64) h17) h7) h3) h84) h157) h202) h230) h228) (S h207)) h139) h150) h147) h122) h66) h21))) (S h210)) h175) h164) h155) h137) h123) h113) h102) h93) h89) h87) h82) (T (T (T (T (T h115 h114) h171) h169) h168) h214)
  have h232 := h v180 v0 x
  have h233 := S h232
  have h234 := R x
  let v235 := M x v19
  have h236 := R v235
  have h237 := h v0 x y
  have h238 := h y v1 v235
  have h239 := C h4 h119
  have h240 := C h4 h125
  have h241 := C h4 h177
  have h242 := C h4 (T h240 h239)
  have h243 := C h4 h130
  have h244 := C h4 h243
  have h245 := C h4 (T h241 h240)
  have h246 := h v181 y y
  have h247 := C (T (T (T (T (T h84 h157) h202) h197) h246) (C (T (T (T (T (T (C h4 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h245 h244) h242) h132) h51) h49) h58) h70) h68) h65) h64) h17) h7) h3) h84) h157) h202) h197)) h241) h240) h239) h131) h50) (T (T h238 (C (T (C h6 (T (C h6 (S h237)) h22)) h22) h236)) (C h16 (T (C h234 h204) (C h234 (T (T h209 h208) h196))))))) h234
  have h248 := C h61 (T (T (T h247 h233) h175) h229)
  have h249 := C h20 (T (T (T (T (T (T h248 h206) h197) h182) h231) h227) h225)
  have h250 := C h4 h213
  have h251 := C h4 (T h243 h250)
  have h252 := C h4 h240
  have h253 := C h4 h149
  have h254 := C h4 (T h253 h243)
  have h255 := C (T (T (T (T (T (C (T (T (T (T (T h40 h111) h253) h243) h250) (C h4 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h176 h165) h146) h106) h2) h38) h37) h71) h67) h63) h62) h59) h46) h41) h112) h254) h252) h251))) (T (T (C h16 (T (C h234 (T (T h175 h203) h189)) (C h234 h228))) (C (T h5 (C h6 (T h5 (C h6 h237)))) h236)) (S h238))) (S h246)) h176) h165) h146) h106) h234
  have h256 := C h61 (T (T (T h205 h196) h232) h255)
  have h257 := h v179 v8 v57
  have h258 := S h257
  have h259 := T (T (T (T (T (T (T (T (T h249 h224) h221) h212) h178) h126) h120) h95) h66) h21
  have h260 := R (M v8 v180)
  have h261 := C h96 h260
  have h262 := C h96 h187
  have h263 := R z
  have h264 := C h263 h262
  have h265 := C h88 h190
  have h266 := C h88 (T h219 h265)
  have h267 := C (T (T (T (T (T h245 h244) h242) h132) h51) h49) (T (T h215 h226) h222)
  have h268 := h v180 y v57
  have h269 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h196) h268) h267) h266) h264) h261) h259
  have h270 := T (T (T (T (T (T (T (T (T h115 h114) h171) h169) h168) h214) (C h20 (T h182 h231))) (C h20 h227)) (C h20 h225)) (C h20 (T (T (T (T (T (T h223 h220) h211) h183) h176) h230) h256))
  have h271 := S h268
  have h272 := C (T (T (T (T (T h46 h41) h112) h254) h252) h251) (T (T h219 h217) h216)
  have h273 := C h96 (T h262 h222)
  have h274 := C h263 h265
  have h275 := C h88 h260
  have h276 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h275 h274) h273) h272) h271) h175) h164) h155) h137) h123) h113) h102) h93) h89) h87) h82) h270
  let v277 := M z x
  let v278 := M v57 v277
  have h279 := h v278 z v19
  have h280 := S h279
  have h281 := h v180 v8 v8
  have h282 := S h281
  have h283 := R (M z v180)
  have h284 := C h96 h283
  have h285 := C h88 h283
  have h286 := C (T (T (T (T (T h215 h226) (C h88 (T (T h268 h267) h285))) (C h96 h284)) (C h88 (T h266 h264))) (C h96 h261)) (T (T (T (T (T (T (T (T (T (T (T (T h248 h206) h165) h146) h106) h2) h38) h37) h71) h67) h63) h62) h59)
  have h287 := T (T (T (T (T (T (T (T (T (T (T (T h286 h282) h175) h164) h155) h137) h123) h113) h102) h93) h89) h87) h82
  have h288 := R (M v19 v278)
  have h289 := C h88 h288
  have h290 := C h88 h289
  have h291 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h269 h258) h174) h173) h172) h170) h167) h166) h163) h162) h161) h159) h118) h90) h77) h74) h2) h38) h37) h71) h67) h63) h62) h59) h270
  have h292 := h v277 v19 v57
  have h293 := C h96 (T (T (T h232 h255) h292) h291)
  have h294 := C (T (T (T (T h215 h226) h222) h293) h290) h287
  have h295 := C (T (T (T (T (T (C h88 h275) (C h96 (T h274 h273))) (C h88 h285)) (C h96 (T (T h284 h272) h271))) h217) h216) (T (T (T (T (T (T (T (T (T (T (T (T h58 h70) h68) h65) h64) h17) h7) h3) h84) h157) h202) h230) h256)
  have h296 := S h292
  have h297 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h58 h70) h68) h65) h64) h17) h7) h3) h73) h110) h108) h134) h158) h200) h199) h198) h195) h194) h193) h192) h186) h185) h257) h276) h259
  have h298 := C h88 (T (T (T h297 h296) h247) h233)
  have h299 := C h96 h288
  have h300 := C h96 h299
  have h301 := C (T (T (T (T h300 h298) h219) h217) h216) (T (T (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h196) h281) h295)
  have h302 := h v278 v57 v57
  have h303 := C h88 (T (T (T (T (T (T h286 h282) h232) h255) h292) h291) h289)
  have h304 := T (T (T (T (T h303 h300) h298) h219) h217) h216
  have h305 := C h61 (T h279 h301)
  have h306 := C h96 (T (T (T (T (T (T h299 h297) h296) h247) h233) h281) h295)
  have h307 := T (T (T (T (T h215 h226) h222) h293) h290) h306
  have h308 := C h61 (T h294 h280)
  have h309 := h v278 v8 v57
  let v310 := M v57 v278
  have h311 := h v310 v57 v57
  have h312 := S h311
  have h313 := C (T (T (T (T (T (T (T h84 h157) h202) h230) h256) h279) h301) (C h61 h305)) h304
  have h314 := R (M v8 v310)
  have h315 := C h88 h314
  have h316 := C h96 h314
  have h317 := C (T (T (T (T (T (T (T (C h61 h308) h294) h280) h248) h206) h165) h146) h106) h307
  T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (h x v57 z) (C h287 (T (T (T (T (T (T h84 h157) h202) h230) h256) h309) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h315 h313) h312) h286) h282) h175) h164) h155) h137) h123) h113) h102) h93) h89) h87) h82) (T (T (T (T (T (T (T (T h215 h226) h222) h293) h290) h306) (C h88 (T h311 h317))) (C h96 h316)) (C h88 (T (T h315 h313) h312))))))) (C h20 (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h196) h281) h295) h311) h317) h316) (T (T (T (T (T (T (T (T (C h96 (T (T h311 h317) h316)) (C h88 h315)) (C h96 (T h313 h312))) h303) h300) h298) h219) h217) h216)) (S h309)) h302) (C (T (T (T (T (T (T (T (T (T (T (T (T (T h308 h286) h282) h175) h164) h155) h137) h123) h113) h102) h93) h89) h87) h82) h307)))) (C h20 (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T (T (T h81 h107) h104) h98) h101) h133) h128) h136) h160) h201) h196) h281) h295) h305) h304) (S h302)) h279) h301))) (C h20 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h294 h280) h248) h206) h165) h146) h106) h73) h110) h108) h134) h158) h200) h199) h198) h195) h194) h193) h192) h186) h185) h257) h276))) (C h20 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h269 h258) h174) h173) h172) h170) h167) h166) h163) h162) h161) h159) h118) h90) h77) h74) h84) h157) h202) h230) h256))) h249) h224) h221) h212) h178) h126) h120) h95) h66) h21

