import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation2170_implies_Equation1504 (G: Type _) [Magma G] (h: Equation2170 G) : Equation1504 G := fun x y z =>
  let v0 := M y z
  let v1 := M z v0
  have h2 := R v1
  have h3 := h x z v0
  let v4 := M y x
  let v5 := M v4 v1
  let v6 := M v0 z
  have h7 := h v6 v1 v5
  have h8 := S h7
  have h9 := h v1 y x
  have h10 := h v5 x y
  let v11 := M x y
  have h12 := h v4 v11 v5
  have h13 := T h12 (C (S h10) (S h9))
  have h14 := h v5 z v0
  have h15 := C h14 h13
  let v16 := M v5 v4
  have h17 := h v16 v0 v1
  have h18 := S h17
  let v19 := M v1 v0
  have h20 := R v19
  have h21 := R v16
  let v22 := M v0 v1
  have h23 := h v22 y z
  have h24 := S h23
  let v25 := M z y
  have h26 := R v25
  have h27 := R v22
  have h28 := h v0 z v0
  have h29 := C (S h28) h27
  have h30 := h v6 v1 v0
  have h31 := T h30 h29
  have h32 := C h31 h26
  have h33 := h v6 v1 v4
  have h34 := S h33
  have h35 := R v5
  have h36 := h v4 z v0
  have h37 := C h36 h35
  have h38 := T h37 h34
  have h39 := C (T (T (C h38 h26) h32) h24) h21
  have h40 := h v25 v4 v5
  have h41 := h y y z
  have h42 := S h41
  have h43 := h v25 v0 v1
  have h44 := S h43
  have h45 := h v1 y z
  have h46 := R (M v1 z)
  let v47 := M z v1
  have h48 := C (S h36) h35
  have h49 := T h33 h48
  have h50 := h v47 v0 v1
  have h51 := h v19 z y
  have h52 := S h51
  have h53 := R v0
  have h54 := S h40
  have h55 := S h30
  have h56 := C h28 h27
  have h57 := T h56 h55
  have h58 := C h57 h26
  have h59 := C (T (T h23 h58) (C h49 h26)) h21
  have h60 := T (C h10 h9) (S h12)
  have h61 := S h14
  have h62 := C h61 h60
  have h63 := T (C (T (T (T h7 h62) h17) (C (T h59 h54) h20)) h53) h52
  have h64 := R v47
  have h65 := h z y z
  have h66 := h z z v0
  have h67 := h v6 z y
  have h68 := S h67
  have h69 := R v6
  have h70 := h v19 z v0
  have h71 := C (T h70 (C (T (C h45 h20) h44) h69)) h53
  have h72 := h (M v19 v0) v1 z
  have h73 := h v25 v22 v0
  let v74 := M v22 v0
  have h75 := h v74 v4 v1
  have h76 := S h75
  let v77 := M v1 v4
  have h78 := R v77
  have h79 := R v74
  have h80 := h v5 y x
  have h81 := S h80
  have h82 := R v11
  have h83 := h v11 v0 v22
  have h84 := C (T h83 (C (T (C (T (T (T h56 h55) h33) h48) h82) h81) h79)) h78
  have h85 := h v11 v4 v5
  have h86 := C (T (C h80 h21) (S h85)) h78
  have h87 := h v16 v4 v1
  have h88 := T (T (T (T (T h7 h62) h87) h86) h84) h76
  have h89 := h v6 v0 v1
  have h90 := h v4 v0 v22
  have h91 := R v4
  have h92 := h v6 v4 v1
  have h93 := h v11 v4 v22
  have h94 := R (M v22 v4)
  have h95 := h v22 y x
  have h96 := h v22 v5 v1
  let v97 := M v1 v5
  have h98 := R v97
  have h99 := h v97 v4 v22
  have h100 := T (T (T h99 (C (T (C (C h13 h27) h98) (S h96)) h94)) (C h95 h94)) (S h93)
  have h101 := R (M v4 v5)
  have h102 := h v6 x y
  have h103 := h v97 v5 v4
  have h104 := h v77 v1 v5
  have h105 := C (T (C (T (T h104 (C (T (C (T h103 (C (T (T (C (T (T (T (C (T h14 (C h100 h69)) h91) (S h102)) h33) h48) h98) (C h101 h100)) h81) h38)) h78) (S h92)) h60)) (C h31 h91)) h79) (S h90)) h35
  have h106 := h v74 v1 v4
  let v107 := M v6 v0
  have h108 := C (T (T (T (C (T h40 h39) h20) h18) h15) h8) h53
  have h109 := C (S h45) h20
  have h110 := T (T (T (T (T h75 (C (T (C (T h80 (C (T (T (T h37 h34) h30) h29) h82)) h79) (S h83)) h78)) (C (T h85 (C h81 h21)) h78)) (S h87)) h15) h8
  have h111 := T (T (T h93 (C (S h95) h94)) (C (T h96 (C (C h60 h27) h98)) h94)) (S h99)
  have h112 := C (T (C h111 h69) h61) h91
  have h113 := C h63 h53
  have h114 := C (T (T (T (C (T h43 h109) h69) (S h70)) h51) h108) h53
  have h115 := S h65
  have h116 := h v0 v0 v1
  let v117 := M v0 y
  have h118 := R v117
  have h119 := C h118 (T (T h116 (C (T (T (T (T (T (T (T h106 h105) h37) h34) (h v6 z v1)) (C (T (C (T h50 (C (T (T (T (T (T (C (T (T (T (T h23 h58) h115) h66) (C h46 (T (T h67 h114) h113))) h64) (S h72)) h71) h68) h102) h112) (T (T (T (T h51 (C (T (T (T (T (T (C (T h73 (C (T (T (C h110 h26) h32) h24) h57)) h20) (S h89)) h33) h48) (C (T h90 (C (T (T (C h57 h91) (C (T h92 (C (T (C (T (T h80 (C h101 h111)) (C (T (T (T h37 h34) h102) h112) h98)) h49) (S h103)) h78)) h13)) (S h104)) h79)) h35)) (S h106)) h53)) (C h110 h53)) (h v107 v0 z)) (C (T (C (T (T (T h67 (C (T (T (T (T (C (T (T h43 h109) (C h2 (T h51 h108))) h69) (S (h v107 z v0))) (C h88 h53)) (C (T (T (T (T (T h106 h105) h37) h34) h89) (C (T (C (T (T h23 h58) (C h88 h26)) h31) (S h73)) h20)) h53)) h52) h53)) h72) (C (T (T (T (T (C h46 (T h71 h68)) (S h66)) h65) h32) h24) h64)) h63) (S h50)) h2)))) h49) (S (h (M v47 v1) v5 v4))) h46)) (S (h v1 z v1))) h45) h20)) h44)
  have h120 := T (T h23 h58) h115
  have h121 := h (M v117 v0) v0 v1
  have h122 := h v0 v1 v0
  have h123 := T (T h65 h32) h24
  have h124 := h v6 v4 v5
  have h125 := S h124
  have h126 := h v6 v1 v1
  let v127 := M v1 v1
  have h128 := R v127
  have h129 := h v1 z v0
  have h130 := h v127 z v0
  have h131 := C (T h130 (C (T (T (T (C h129 h128) (S h126)) h33) h48) h69)) h21
  have h132 := C h128 (T h7 h62)
  have h133 := C h118 (T (C (T (T (T (T (T (T h129 h132) h131) h125) h67) h114) h113) h123) (S h122))
  have h134 := S h129
  have h135 := C h118 (T (T (T (T (T (T h43 h109) (C (T (T (T (T (T h129 h132) h131) h125) h33) h48) h20)) (C (T (T (T (T (T (T (T h37 h34) h7) h62) h87) h86) h84) h76) h20)) (S h116)) h122) (C (T (T (T (T (T h71 h68) h124) (C (T (C (T (T (T h37 h34) h126) (C h134 h128)) h69) (S h130)) h21)) (C h128 (T h15 h8))) h134) h120))
  let v136 := M v1 x
  have h137 := R v136
  have h138 := T (T (T (T (T (T h7 h62) h17) (C (T (T h59 h54) (C h123 (T (T h41 h135) h133))) h20)) (S h121)) h119) h42
  T (T (T h3 (C h137 h138)) (h (M v136 y) v0 z)) (C (C h138 (T (C h137 (T (T (T (T (T (T (T h41 h135) h133) h121) (C (T (T (C h120 (T h119 h42)) h40) h39) h20)) h18) h15) h8)) (S h3))) h2)

