import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation2170_implies_Equation3370 (G: Type _) [Magma G] (h: Equation2170 G) : Equation3370 G := fun x y z =>
  let v0 := M z x
  let v1 := M z v0
  let v2 := M y v1
  let v3 := M v2 y
  have h4 := h v3 v0 v1
  have h5 := S h4
  let v6 := M v1 v0
  have h7 := R v6
  have h8 := R v3
  let v9 := M v0 v1
  have h10 := h v9 z x
  have h11 := S h10
  let v12 := M x z
  have h13 := R v12
  have h14 := R v9
  have h15 := h v0 z v0
  have h16 := S h15
  let v17 := M v0 z
  have h18 := h v17 v1 v0
  have h19 := T h18 (C h16 h14)
  have h20 := C h19 h13
  have h21 := h v12 v1 y
  have h22 := S h21
  have h23 := R v2
  let v24 := M v1 y
  let v25 := M v0 v2
  have h26 := R v25
  have h27 := h v0 y v1
  have h28 := C (T (h v25 z x) (C (T (C h27 h26) (S (h v24 v2 v0))) h13)) h23
  have h29 := T h28 h22
  have h30 := R v17
  have h31 := C h30 h29
  have h32 := h (M v25 v2) v0 z
  have h33 := S h32
  have h34 := R v1
  have h35 := h v25 v1 z
  have h36 := S h35
  have h37 := h z z x
  have h38 := S h37
  have h39 := C h38 h34
  have h40 := h v12 v0 z
  have h41 := T h40 h39
  let v42 := M v1 z
  have h43 := h v42 v9 v0
  have h44 := S h43
  have h45 := R (M v0 v9)
  have h46 := R v42
  let v47 := M v9 v0
  have h48 := h v47 v0 v1
  have h49 := S h48
  have h50 := h v6 v1 y
  have h51 := S h50
  have h52 := h v24 v2 v9
  let v53 := M v9 v2
  have h54 := R v53
  have h55 := h v9 y v1
  have h56 := h v53 v0 v1
  have h57 := T (T h37 h20) h11
  have h58 := C (T (T (C h57 h23) h56) (C (T (C h55 h54) (S h52)) h7)) h23
  have h59 := T h58 h51
  have h60 := R v47
  have h61 := C h11 h60
  have h62 := h v12 v0 v9
  have h63 := S h40
  have h64 := C h37 h34
  have h65 := C (T (T (T h64 h63) h62) h61) h59
  have h66 := C (T h65 h49) h46
  let v67 := M (M z v2) v2
  have h68 := h v67 z v1
  have h69 := T (C h15 h14) (S h18)
  have h70 := C h69 h13
  have h71 := T (T h10 h70) h38
  have h72 := C (T (T (C (T h52 (C (S h55) h54)) h7) (S h56)) (C h71 h23)) h23
  have h73 := h v6 x z
  have h74 := R v0
  have h75 := S h62
  have h76 := C h10 h60
  have h77 := C (T (T (T (T (T (C (T h48 (C (T h76 h75) h7)) h74) (S h73)) h50) h72) h68) h66) h45
  have h78 := h v0 v9 v0
  have h79 := h v24 v1 y
  have h80 := S h79
  have h81 := R v24
  have h82 := h v24 v2 v2
  let v83 := M v2 v2
  have h84 := R v83
  have h85 := h v2 y v1
  have h86 := h v83 y v1
  have h87 := C (T h86 (C (T (C h85 h84) (S h82)) h81)) h23
  let v88 := M v2 v0
  have h89 := R v88
  have h90 := h (M v83 v2) v2 v0
  have h91 := C (T (C (T h82 (C (S h85) h84)) h81) (S h86)) h23
  have h92 := T (T (T h79 h91) h90) (C (T (T (T (T (C h89 (T h87 h80)) (S h27)) h78) h77) h44) h26)
  have h93 := C (T (C h92 h41) h36) h23
  have h94 := T h21 h93
  have h95 := C h30 h94
  have h96 := C (T (T h10 h70) h95) h34
  have h97 := T h96 h33
  let v98 := M v9 v1
  have h99 := R v98
  have h100 := h v17 v1 y
  have h101 := S h100
  have h102 := h y z v0
  have h103 := C h102 h23
  have h104 := T h103 h101
  have h105 := C (T (T (T (T (C h104 h99) (C h30 h97)) h31) h20) h11) h8
  have h106 := h v98 y v2
  have h107 := C (T h106 h105) h7
  have h108 := h v1 v0 v1
  have h109 := C h71 h74
  have h110 := h z y v1
  have h111 := h v24 v2 y
  have h112 := S h111
  have h113 := S h102
  have h114 := C h113 h23
  have h115 := T h100 h114
  have h116 := h y y v1
  have h117 := h v24 v2 v1
  let v118 := M v1 v2
  have h119 := R v118
  have h120 := h v1 y v1
  have h121 := C h57 h74
  have h122 := S h106
  have h123 := C (T (T h31 h20) h11) h34
  have h124 := T h32 h123
  have h125 := C (T (T (T (T h10 h70) h95) (C h30 h124)) (C h115 h99)) h8
  have h126 := C (T (T (C (T (T (T h4 (C (T h125 h122) h7)) (S h108)) h121) h119) (C (T h109 h120) h119)) (S h117)) h104
  have h127 := h v118 v2 y
  have h128 := C (T (T (T h127 h126) h113) h116) h115
  have h129 := h v2 z v0
  have h130 := h v2 z x
  have h131 := S h130
  have h132 := h v98 v1 v0
  have h133 := C (T h20 h11) h34
  have h134 := h v67 v2 y
  have h135 := h v17 y x
  have h136 := S h135
  let v137 := M x y
  have h138 := R v137
  let v139 := M y x
  have h140 := h v139 v137 v1
  let v141 := M v1 v137
  have h142 := R v141
  have h143 := h v1 x y
  have h144 := h v141 z v0
  have h145 := C (T h144 (C (T (C h143 h142) (S h140)) h30)) h138
  have h146 := T h50 h72
  have h147 := C (T (T (T h76 h75) h40) h39) h146
  have h148 := S h68
  have h149 := C (T h48 h147) h46
  have h150 := T (T h43 (C (T (T (T h149 h148) h58) h51) h69)) h16
  have h151 := h v42 v0 v1
  have h152 := C (T (T (T (C (T h151 (C (T (T (T (T (C h14 h150) h48) h147) (C (T (T (T (T (T (T (T h64 h63) h21) h93) h32) h123) h106) h105) h59)) h5) h146)) (T (T (T h145 h136) h100) h114)) (S h134)) h58) h51) (T h64 h133)
  have h153 := h (M v141 v137) v1 z
  have h154 := C (T (C (T h140 (C (S h143) h142)) h30) (S h144)) h138
  have h155 := h v17 z v1
  have h156 := S h155
  have h157 := h v12 v0 v1
  have h158 := h v1 z x
  have h159 := h v6 z v0
  have h160 := C (T (T h159 (C (T (C h158 h7) (S h157)) h30)) (C h41 h30)) h46
  have h161 := h v42 v1 v0
  have h162 := C h26 (T (T (T (T (T (T (T h15 (C (T (T (T h50 h72) h68) h66) h19)) h44) h161) (C (T (T (T (T (T h160 h156) h135) h154) h153) h152) h14)) (S h132)) (C (T h10 h70) h34)) h63)
  have h163 := T (T (T (T h162 h131) h129) h128) h112
  let v164 := M v2 z
  have h165 := R v164
  have h166 := C h26 h150
  have h167 := S h161
  have h168 := C (T (C (T (T (T h64 h63) h157) (C (S h158) h7)) h30) (S h159)) h46
  have h169 := S h153
  have h170 := T (T h78 h77) h44
  have h171 := C (T (T (T h50 h72) h134) (C (T (C (T (T (T (T h4 (C (T (T (T (T (T (T (T h125 h122) h96) h33) h28) h22) h40) h39) h146)) h65) h49) (C h14 h170)) h59) (S h151)) (T (T (T h103 h101) h135) h154))) (C h71 h34)
  have h172 := C (T (T (T (T (T h171 h169) h145) h136) h155) h168) h14
  have h173 := C h26 (T (T (T (T h40 h133) h132) h172) h167)
  have h174 := T (T h130 h173) h166
  let v175 := M v137 y
  have h176 := h v175 y x
  have h177 := S h176
  have h178 := R v175
  have h179 := h v139 v137 x
  let v180 := M x v137
  have h181 := R v180
  have h182 := h x x y
  have h183 := h x y v1
  have h184 := S h183
  let v185 := M v2 x
  have h186 := R v185
  have h187 := h (M v185 v2) v1 v2
  have h188 := S h187
  let v189 := M v2 v1
  have h190 := R v189
  have h191 := T h162 h131
  have h192 := C h92 (T (T (T h28 h22) h40) h39)
  have h193 := C h81 h97
  have h194 := h v12 v1 v0
  have h195 := S h194
  have h196 := C (T (T (T (T (T (T (T h160 h156) h135) h154) h153) h152) (C h7 h97)) (C h7 h29)) h14
  have h197 := C h81 (T (T (T (T (T (T h161 h196) h195) h21) h93) h32) h123)
  let v198 := M v25 v0
  have h199 := h v198 z v0
  have h200 := h v198 v0 v2
  have h201 := h v0 v1 y
  have h202 := S h78
  have h203 := C (T (T (T (T (T h149 h148) h58) h51) h73) (C (T (C (T h62 h61) h7) h49) h74)) h45
  have h204 := h v88 x z
  have h205 := C h81 (T (T h132 h172) h167)
  have h206 := C h81 h124
  have h207 := C (T (T (T (C (T (T (T (T h43 h203) h202) h27) (C h89 (T h79 h91))) h26) (S h90)) h87) h80) (T (T (T h64 h63) h21) h93)
  have h208 := S h199
  have h209 := S h127
  have h210 := C (T (T h117 (C (T (S h120) h121) h119)) (C (T (T (T h109 h108) h107) h5) h119)) h115
  have h211 := S h116
  have h212 := C (T (T (T (T h211 h102) h210) h209) (C h34 h174)) h104
  have h213 := C (C (T (T h102 h210) h209) (T (T (T h183 (C h186 (T (T (T (T (T h111 h212) h208) (C h26 h170)) (C (T (T (T (T (T h35 h207) h206) h205) (C (T (T (T (T h111 h212) h208) h200) (C (T (T (T (T (T (T (T (C (T (T (T (T h35 h207) h206) h205) (C h81 h150)) h191) (S h201)) h78) h77) h44) h161) h196) h195) h89)) h150)) (S h204)) h46)) (C h89 h150)))) (C h186 (T (T (C h89 h170) (C (T (T (T (T (T h204 (C (T (T (T (T (C (T (T (T (T (T (T (T h194 (C (T (T (T (T (T (T (T (C h7 h94) (C h7 h124)) h171) h169) h145) h136) h155) h168) h14)) h167) h43) h203) h202) h201) (C (T (T (T (T (C h81 h170) h197) h193) h192) h36) h174)) h89) (S h200)) h199) (C (T (T (T (T (C h34 h191) h127) h126) h113) h116) h115)) h112) h170)) h197) h193) h192) h36) h46)) h166))) (C h186 h191))) h190
  have h214 := h v139 v137 y
  let v215 := M y v137
  have h216 := R v215
  have h217 := h y x y
  have h218 := T (C (T (T (T h127 h126) h113) h217) h216) (S h214)
  have h219 := C h218 h190
  have h220 := h v215 v1 v2
  have h221 := h v180 y v137
  have h222 := C (T h221 (C (T (C (T (T (T (T (T (T h220 h219) h213) h188) (C h186 (T (T h129 h128) h112))) h184) h182) h181) (S h179)) h178)) h138
  let v223 := M v180 v137
  have h224 := S h220
  have h225 := C (T h214 (C (T (T (T (S h217) h102) h210) h209) h216)) h190
  have h226 := C (C (T (T h127 h126) h113) (T (T (C h186 h174) (C h186 h163)) h184)) h190
  have h227 := S h129
  have h228 := C (T (T (T h211 h102) h210) h209) h104
  have h229 := T (T h111 h228) h227
  have h230 := C h186 h229
  have h231 := C (T (C (T h179 (C (T (T (T (T (T (T (S h182) h183) h230) h187) h226) h225) h224) h181)) h178) (S h221)) h138
  have h232 := h v2 v2 x
  let v233 := M x v2
  have h234 := R v233
  have h235 := h v233 y v137
  have h236 := h v137 y v1
  let v237 := M v2 v137
  have h238 := R v237
  T (T (T (T h236 (C h238 h229)) (h (M v237 v2) y v137)) (C (T (C (T h220 (C h218 (T (h v189 y v1) (C (T (T (T (C h129 h190) (S (h v17 v1 v2))) h100) h114) h229)))) (T (T (C h238 h174) (C h238 h163)) (S h236))) (S (h (M (M y v2) v2) y x))) (T (T (T (T (T (T (T (T (T h176 h231) (h v223 v1 y)) (C (T (T (C h229 (R v223)) (C (T h232 (C (T (T (T h187 h226) h225) h224) h234)) (T h222 h177))) (S h235)) h23)) (h (M v233 v2) x z)) (C (T (T (T (T (T (T (T (C (T (C (R x) h57) (C (T (T (T (T (T h183 h230) h187) h226) h225) h224) (T (T (T (T (T h10 h70) h38) h110) (C h165 (T (T (T (T (T h111 h228) h227) h130) h173) h166))) (C h165 h191)))) (T (T (T (T (T (C h234 h174) (C h234 h163)) (C (T h235 (C (T (C (T (T (T h220 h219) h213) h188) h234) (S h232)) (T h176 h231))) h81)) (S (h v223 y v1))) h222) h177)) (S (h (M v164 v2) y v137))) (C h165 h174)) (C h165 h163)) (S h110)) h37) h20) h11) h74)) h109) h108) h107) h5))) (S (h v2 y v2))

