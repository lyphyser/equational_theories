import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3358_implies_Equation41 (G: Type _) [Magma G] (h: Equation3358 G) : Equation41 G := fun x y z =>
  let v0 := M y z
  have h1 := S (h y z v0)
  have h2 := h v0 y y
  have h3 := S h2
  have h4 := h z y y
  have h5 := R y
  have h6 := C h5 h4
  have h7 := T h6 h3
  have h8 := R z
  have h9 := C h8 (C h8 h7)
  let v10 := M z y
  have h11 := h v10 z y
  have h12 := S (h v10 z z)
  have h13 := h y z z
  have h14 := C h8 h13
  have h15 := h z v0 y
  have h16 := R v0
  let v17 := M x x
  have h18 := h v0 v0 v17
  have h19 := S h18
  have h20 := h v17 v0 x
  have h21 := S h20
  have h22 := h x x x
  have h23 := S h22
  have h24 := R x
  have h25 := C h24 h23
  have h26 := h v17 x x
  have h27 := T h26 h25
  have h28 := C h24 h27
  have h29 := h (M x (M v17 x)) x x
  have h30 := h x x v17
  have h31 := S h26
  have h32 := C h24 h22
  have h33 := T h32 h31
  have h34 := C h24 h33
  have h35 := C h16 (C h16 (T (T (T (T (T (T h22 h34) (C h24 (T (T h26 h25) (C h24 h30)))) (S h29)) (C (T h28 h23) h24)) h26) h25))
  have h36 := C h16 (T h35 h21)
  have h37 := h v17 v0 v0
  have h38 := h x v0 x
  have h39 := T (T (T (T h14 h12) h11) h9) h1
  have h40 := h y z x
  have h41 := S h40
  have h42 := C h8 h41
  let v43 := M x y
  have h44 := h v43 z z
  have h45 := h v43 z y
  have h46 := S h45
  have h47 := h x y v17
  have h48 := S h47
  have h49 := C h5 (C h5 h33)
  have h50 := h v17 y x
  have h51 := T (T h50 h49) h48
  have h52 := C h5 h51
  have h53 := S h50
  have h54 := C h5 (C h5 h27)
  have h55 := h x y x
  have h56 := S h55
  have h57 := C h5 (T (T (T h56 h47) h54) h53)
  have h58 := h v17 y y
  have h59 := S h58
  have h60 := C h5 (T (T (T h50 h49) h48) h55)
  have h61 := C h5 (T (T (T (T (T h60 h59) h50) h49) h48) h55)
  have h62 := h y y v17
  have h63 := h z (M y y) v0
  have h64 := R (M v0 z)
  have h65 := S h62
  have h66 := C h5 (T (T (T (T (T h56 h47) h54) h53) h58) h57)
  have h67 := T (T h58 h66) h65
  have h68 := T (T h47 h54) h53
  have h69 := h z v43 v0
  have h70 := h z v43 x
  have h71 := S h70
  let v72 := M x z
  have h73 := h v43 v72 y
  have h74 := h y y z
  have h75 := S h74
  have h76 := C h5 (S h4)
  have h77 := T h2 h76
  have h78 := C h5 h77
  have h79 := T (T (T (T (T h78 h75) h62) h61) h57) h52
  have h80 := R v72
  have h81 := C h5 h7
  have h82 := T (T (T (T (T (T (T h47 h54) h53) h58) h66) h65) h74) h81
  have h83 := h y v72 x
  have h84 := R v43
  have h85 := C h84 (T (T (T h83 (C h80 (C h80 h82))) (C h80 (C h80 h79))) (S h73))
  let v86 := M y v72
  have h87 := h v43 v86 y
  have h88 := S h87
  have h89 := T (T (T (T (T h47 h54) h53) h58) h57) h52
  have h90 := R v86
  have h91 := C h90 (C h90 h89)
  have h92 := h y v86 x
  have h93 := h z y x
  have h94 := C h8 (T (T (T (T (T (T (T (T (T (T h93 h92) h91) h88) h85) h71) h69) (C h68 (C h68 h64))) (C h67 (C h67 h64))) (S h63)) (C h8 (T (T (T h62 h61) h57) h52)))
  have h95 := h z v10 y
  have h96 := S h95
  have h97 := S h13
  let v98 := M z v10
  have h99 := h z v98 z
  let v100 := M z z
  have h101 := h v98 v100 z
  have h102 := R v100
  have h103 := C h102 (C h102 (T h41 h13))
  let v104 := M z v43
  have h105 := h v104 v100 z
  have h106 := R v98
  have h107 := R v10
  let v108 := M v104 v100
  have h109 := h v108 v10 v98
  have h110 := h v108 v10 v10
  have h111 := S h105
  have h112 := C h102 (C h102 (T h97 h40))
  have h113 := h v100 v0 v0
  have h114 := h z v0 z
  have h115 := h z v10 z
  have h116 := S h115
  have h117 := C h8 (T (C h8 h116) h97)
  let v118 := M v10 v100
  have h119 := h v118 z v10
  have h120 := h v118 z v43
  have h121 := S h120
  have h122 := h v10 v100 y
  have h123 := h y v100 v0
  have h124 := h y v100 x
  have h125 := T (T (T (T (T (T (T h78 h75) h62) h61) h59) h50) h49) h48
  have h126 := C h5 h68
  have h127 := T (T (T (T (T h126 h60) h66) h65) h74) h81
  have h128 := h v43 v100 y
  have h129 := h z v43 z
  have h130 := C h8 (C h8 (T (T (T (T (T (T (T h93 h92) h91) h88) h85) h71) h129) (C h84 (T (T (T (T (T (T h128 (C h102 (C h102 h127))) (C h102 (C h102 h125))) (S h124)) h123) (C h102 (C h102 h77))) (S h122)))))
  have h131 := C h16 (T (T (T h35 h21) h37) h36)
  have h132 := C h16 (C h16 (T (T (T (T (T (T h32 h31) (C (T h22 h34) h24)) h29) (C h24 (T (T (C h24 (S h30)) h32) h31))) h28) h23))
  have h133 := S h37
  have h134 := C h16 (T h20 h132)
  have h135 := C h16 (T (T (T h134 h133) h20) h132)
  have h136 := C h16 (T (T (T (T (T (C h16 h97) h18) h135) h133) h20) h132)
  have h137 := h v98 v0 z
  have h138 := h v98 v0 v0
  have h139 := S h138
  have h140 := h v10 v0 z
  have h141 := h v10 v0 y
  have h142 := S h141
  have h143 := C h16 (C h16 h77)
  have h144 := h y v0 v0
  have h145 := C h16 (T (T (T h144 h143) h142) h140)
  have h146 := S h144
  have h147 := C h16 h146
  let v148 := M v0 y
  have h149 := h v148 v0 v0
  have h150 := h v148 v0 y
  have h151 := S h150
  have h152 := T (T (T (T (T h126 h60) h59) h50) h49) h48
  have h153 := C h16 h152
  have h154 := C h16 (T h153 (C h16 h82))
  have h155 := C h16 h89
  have h156 := C h16 h155
  have h157 := h y v0 x
  have h158 := C h16 (C h16 h7)
  have h159 := S h93
  have h160 := S h92
  have h161 := C h90 (C h90 h152)
  have h162 := C h84 (T (T (T h73 (C h80 (C h80 h127))) (C h80 (C h80 h125))) (S h83))
  have h163 := C h8 (C h8 (T (T (T (T (T (T (T (C h84 (T (T (T (T (T (T h122 (C h102 (C h102 h7))) (S h123)) h124) (C h102 (C h102 h82))) (C h102 (C h102 h79))) (S h128))) (S h129)) h70) h162) h87) h161) h160) h159))
  have h164 := S h119
  have h165 := C h8 (T h13 (C h8 h115))
  have h166 := S h157
  have h167 := C h16 h153
  have h168 := C h16 (T (C h16 h125) h155)
  have h169 := S h149
  have h170 := C h16 h144
  have h171 := C h16 (T (T (T (S h140) h141) h158) h146)
  have h172 := S h137
  have h173 := C h16 (T (T (T (T (T h35 h21) h37) h131) h19) (C h16 h13))
  let v174 := M v17 v0
  have h175 := h v174 v10 v0
  have h176 := h z v43 y
  have h177 := S h176
  have h178 := T (T h62 h61) h59
  have h179 := h v0 v43 z
  have h180 := h v0 v43 v10
  have h181 := h v43 v0 y
  have h182 := S h181
  have h183 := h v174 v43 v0
  have h184 := R v174
  have h185 := h v43 v174 y
  have h186 := h v100 v10 v10
  have h187 := h v10 v10 z
  have h188 := h y v10 z
  have h189 := h v10 v148 z
  have h190 := C h8 (T (T (T (T (T (T (T (T (T (T (C h8 (T (T (T h126 h60) h66) h65)) h63) (C h178 (C h178 h64))) (C h51 (C h51 h64))) (S h69)) h70) h162) h87) h161) h160) h159)
  have h191 := S h44
  have h192 := C h8 h40
  have h193 := R v148
  T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (h x x z) (C h24 (T (T (C h24 (h z x y)) (S (h v0 x x))) (h v0 x z)))) (S (h (M z v0) x x))) (C (T (T (T h192 h191) h45) h190) h24)) (h v98 x z)) (C h24 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C h24 h97) h38) h35) h21) h37) h173) h172) h138) h171) h170) h169) (C h193 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h13 h130) h121) h119) h117) h192) h191) h45) h190) h95) (C h107 (C h107 (T (T h13 h99) (C h106 (T (T h101 h112) h111)))))) (S h109)) h110) (C h107 (T (T (T (C h107 (T (C h107 (T (T (T (T h105 h103) (C h102 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C h102 h97) h113) (C h16 (T (T (T (T (T (S h114) h165) h164) h120) h163) h97))) h18) h135) h173) h172) h138) h171) h170) h169) h150) h168) h167) h166) h144) h143) h142) (C h107 (T (T (T (T (T (T (T (T (T (T h13 h130) h121) h119) h117) h192) h191) h45) h190) h95) (C h107 (T (T (T (T (T (T (T (T (T (T (T (T (T h141 h158) h146) h157) h156) h154) h151) h149) h147) h145) h139) h137) h136) h36))))) (S h175)) (C h184 (T (T (T (T (T (T (T (T (T (T (T (T h93 h92) h91) h88) h85) h71) h176) (C h84 (T (T (C h68 h16) (C h67 h16)) (C (T (T (T (T (T h62 h61) h59) h50) h49) h48) (T (T (T (T h13 h130) h121) h119) h117))))) (S h179)) h180) (C h84 (T (T (T (T (T (T (T (C h84 (T (T (T (T (T h141 h158) h146) h157) h156) h182)) h177) h70) h162) h87) h161) h160) h159))) (C h84 (T (T (T (T (T (T (T h93 h92) h91) h88) h85) h71) h176) (C h84 (T (T (T (T (T (T (T (T (T h181 h154) h151) h149) h147) h145) h139) h137) h136) h36))))) (S h183)))) (C h184 (C h184 h89))) (S h185)) (C h84 (T (T (T (T (T (T (T (T (T h37 h173) h172) h138) h171) h170) h169) h150) h168) h182))) h177) h70) h162) h87) h161) h160) h159))) h186) (C h107 h116))) (S h187))) (S h188)) h6) h3))) h189) (C h193 (T (T (T (T (T (T (T (C h193 (T (T (T (T (T (T (T (T h94 h46) h44) h42) h165) h164) h120) h163) h97)) h149) h147) h145) h139) h137) h136) h133))) (C h193 (T (T (T (T (T (T (T (T (T (T (T (T (T h37 h173) h172) h138) h171) h170) h169) h150) h168) h167) h166) h144) h143) h142))))) (S (h v0 v148 v10))) (h v0 v148 z)) (C h193 (T (T (T (T (T (T (T (C h193 h39) h149) h147) h145) h139) h137) h136) h133))) (C h193 (T (T (T (T (T (T (T h37 h173) h172) h138) h171) h170) h169) (C h193 (T (T (T (T (T (T (T (T h13 h130) h121) h119) h117) h192) h191) h45) h190))))) (S h189)) (C h107 (T (T (T h2 h76) h188) (C h107 (T h187 (C h107 (T (T (T (T (C h107 h115) (S h186)) (C h102 (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h93 h92) h91) h88) h85) h71) h176) (C h84 (T (T (T (T (T (T (T (T (T h181 h154) h151) h149) h147) h145) h139) h137) h136) h133))) h185) (C h184 (C h184 h152))) (C h184 (T (T (T (T (T (T (T (T (T (T (T (T h183 (C h84 (T (T (T (T (T (T (T (C h84 (T (T (T (T (T (T (T (T (T h134 h173) h172) h138) h171) h170) h169) h150) h168) h182)) h177) h70) h162) h87) h161) h160) h159))) (C h84 (T (T (T (T (T (T (T h93 h92) h91) h88) h85) h71) h176) (C h84 (T (T (T (T (T h181 h167) h166) h144) h143) h142))))) (S h180)) h179) (C h84 (T (T (C (T (T (T (T (T h47 h54) h53) h58) h66) h65) h39) (C h178 h16)) (C h51 h16)))) h177) h70) h162) h87) h161) h160) h159))) h175) (C h107 (T (T (T (T (T (T (T (T (T (T (C h107 (T (T (T (T (T (T (T (T (T (T (T (T (T h134 h173) h172) h138) h171) h170) h169) h150) h168) h167) h166) h144) h143) h142)) h96) h94) h46) h44) h42) h165) h164) h120) h163) h97))) h141) h158) h146) h157) h156) h154) h151) h149) h147) h145) h139) h137) h136) h131) h19) (C h16 (T (T (T (T (T h13 h130) h121) h119) h117) h114))) (S h113)) (C h102 h13)))) h112) h111))))))) (S h110)) h109) (C h107 (C h107 (T (T (C h106 (T (T h105 h103) (S h101))) (S h99)) h97)))) h96) h94) h46) h44) h42))) (C h24 h39)) h38) h35) h21) h37) h36) (C h16 (T h37 h36))) h19) (h v0 v0 z)) (C h16 (T (C h16 h15) (S (h v0 v0 v0))))) (S h15)) h14) h12) h11) h9) h1

