import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3940_implies_Equation4146 (G: Type _) [Magma G] (h: Equation3940 G) : Equation4146 G := fun x y z =>
  let v0 := M x z
  let v1 := M v0 z
  have h2 := S (h v1 y v0)
  have h3 := R v0
  let v4 := M v0 y
  have h5 := R v1
  let v6 := M v1 v4
  let v7 := M v1 y
  have h8 := h v0 z v7
  have h9 := S h8
  let v10 := M v7 z
  let v11 := M v0 v10
  have h12 := R v11
  have h13 := h v0 v10 x
  have h14 := S h13
  have h15 := R x
  let v16 := M x v10
  have h17 := R v16
  have h18 := h x z v0
  have h19 := S h18
  have h20 := h x z v7
  let v21 := M x v1
  have h22 := R v21
  have h23 := h v21 v7 v16
  have h24 := R v7
  have h25 := h x v1 v1
  have h26 := S h25
  let v27 := M v7 y
  let v28 := M v1 v27
  have h29 := h v11 v7 v28
  have h30 := S h29
  have h31 := R v28
  have h32 := h v1 y v7
  have h33 := C (T h8 (C h12 h32)) h31
  have h34 := h v1 v27 v1
  have h35 := C (C h15 (T h34 (C (T (T h33 h30) h9) h5))) h5
  have h36 := h x v27 v1
  have h37 := T (T h36 h35) h26
  have h38 := h x y v7
  let v39 := M x y
  have h40 := h x y v39
  have h41 := S h40
  let v42 := M v39 y
  let v43 := M x v42
  have h44 := h v43 v39 v39
  have h45 := S h44
  have h46 := R v39
  let v47 := M v39 v39
  have h48 := R v47
  have h49 := h v39 y x
  have h50 := h x x v47
  let v51 := M v0 v0
  have h52 := h x x v51
  have h53 := S h52
  have h54 := R v51
  have h55 := h v0 z x
  have h56 := C (C h15 h55) h54
  have h57 := T (T (T h56 h53) h50) (C (C h15 (S h49)) h48)
  have h58 := C h57 h46
  let v59 := M v39 z
  let v60 := M x v59
  let v61 := M v21 v51
  have h62 := h v61 v39 v60
  have h63 := S h62
  have h64 := R v60
  have h65 := h x z v39
  have h66 := R v61
  have h67 := h v21 v0 v0
  have h68 := C (T (T h18 h67) (C h66 h65)) h64
  have h69 := C (T (T (T (T (T (T (T (T h68 h63) h58) h45) h41) h38) (C h37 h24)) h23) (C (T (C h22 (S h20)) h19) h17)) h15
  have h70 := S h67
  have h71 := C (T (T (C h66 (S h65)) h70) h19) h64
  have h72 := S h55
  have h73 := C (C h15 h72) h54
  have h74 := T (T (T (C (C h15 h49) h48) (S h50)) h52) h73
  have h75 := C h74 h46
  have h76 := C (T (T (T (T h40 h44) h75) h62) h71) h15
  have h77 := h (M v43 v47) y x
  have h78 := R y
  let v79 := M x (M y z)
  have h80 := h v61 y v79
  have h81 := R v79
  have h82 := h x z y
  have h83 := S h82
  have h84 := h v21 y v79
  have h85 := h (M x v27) y v1
  have h86 := T (T (T (T (T (T (T (T (T (T (T (T (C h38 h5) (S h85)) (C h37 h78)) h84) (C (T (C h22 h83) h19) h81)) (C (T (T h18 h67) (C h66 h82)) h81)) (S h80)) (C h57 h78)) h77) (C (T h45 h41) h15)) h76) h69) h14
  have h87 := h v0 z v39
  have h88 := S h87
  let v89 := M v0 v59
  have h90 := h v89 v39 v43
  have h91 := R v43
  have h92 := R v89
  have h93 := h x v42 v1
  have h94 := h v1 v42 v1
  let v95 := M v1 v42
  have h96 := R v95
  have h97 := h v1 y v39
  have h98 := h v11 v39 v95
  have h99 := h v0 v59 x
  have h100 := S h34
  have h101 := C (T (C h12 (S h32)) h9) h31
  have h102 := C (C h15 (T (C (T (T h8 h29) h101) h5) h100)) h5
  let v103 := M v1 z
  have h104 := h v0 v103 v0
  have h105 := S h104
  let v106 := M v0 v103
  have h107 := R v106
  have h108 := h x z v1
  have h109 := S h108
  have h110 := h v0 z v1
  have h111 := S h110
  let v112 := M x v103
  have h113 := R v112
  have h114 := h v112 v1 v106
  have h115 := C (T (T h108 h114) (C (T (C h113 h111) h109) h107)) h3
  have h116 := T h115 h105
  have h117 := T (T (h x v0 v0) (C (C h15 h116) h3)) (S (h x v103 v0))
  have h118 := h x y v0
  have h119 := T (T (C (T h18 (C h22 h18)) h22) (S (h v21 v0 v21))) h19
  let v120 := M x v4
  have h121 := R v120
  have h122 := h x v1 v39
  have h123 := S h38
  have h124 := T (T h25 h102) (S h36)
  have h125 := C (T (T (T (T h68 h63) h58) h45) h41) h15
  have h126 := C (T (T (T (T (T (T (T (T (C (T h18 (C h22 h20)) h17) (S h23)) (C h124 h24)) h123) h40) h44) h75) h62) h71) h15
  have h127 := h x x v39
  have h128 := h v21 v51 v0
  have h129 := h x z x
  have h130 := S h129
  let v131 := M x v0
  have h132 := h v131 x v51
  have h133 := S h132
  have h134 := h v0 z y
  have h135 := S h134
  have h136 := R v131
  have h137 := C h136 (T h135 h55)
  have h138 := h v131 v1 v106
  have h139 := C h136 (T h72 h134)
  have h140 := C (T (T (T (T (T h139 (C h136 h135)) h138) (C (T (C h136 (T h111 h134)) h137) (T h104 (C (T (T (C (T h108 (C h113 h110)) h107) (S h114)) h109) h3)))) h133) h130) h54
  have h141 := C (T (T (T (T (T h129 h132) (C (T h139 (C h136 (T h135 h110))) h116)) (S h138)) (C h136 h134)) h137) h54
  have h142 := h v0 v0 v0
  have h143 := S h142
  have h144 := C (T (T (T (T (C h22 (T (T h141 h133) h130)) h19) h129) h132) h140) h3
  have h145 := S h127
  have h146 := C (T (C h15 h86) (C h15 (T (T h13 h126) h125))) h46
  have h147 := h x v4 v1
  have h148 := S (h v106 v1 v0)
  let v149 := M v0 v1
  have h150 := h v0 v103 v1
  let v151 := M v0 (M v1 v103)
  have h152 := R v151
  have h153 := C (T (T (C h152 h119) (h v151 v0 v149)) (C (T (C h152 (S (h v0 z v0))) (S h150)) (R v149))) h3
  have h154 := h v151 v21 v0
  have h155 := S (h v151 v21 v1)
  have h156 := C (T (T (T (T (T (T (T (T (T (T (T h122 h146) h145) h52) h73) h128) h144) h143) h115) h105) h150) (C h152 (T (T (T h87 h90) (C (T (C h92 h41) h88) h91)) (C h5 (T (T (T h93 (C (C h15 (T (T h94 (C (T (T (T (T (T (T (C (T h8 (C h12 h97)) h96) (S h98)) (C (T (T h13 h126) (S h99)) h46)) h88) h8) h29) h101) h5)) h100)) h5)) h35) h26))))) h5
  let v157 := M x v6
  have h158 := R v157
  T (T h118 (C (T (T (T (T (T h147 (h v157 v1 v21)) (C (T (T (T (T (T (T (T (T (C h158 (T (T (T (T (T h156 h155) h154) h153) h148) h111)) (h v157 v1 x)) (C (C h158 (T (T h122 h146) h145)) h15)) (S (h v157 x x))) (h v157 x v21)) (C (T (C h158 (T (T (T (T (T (T (T (T (T (T (h v21 x v131) (C (T (C h22 h130) h19) h136)) (C h3 h117)) (C (T h18 (C h22 h108)) h113)) (S (h v21 v1 v112))) h156) h155) h154) h153) h148) h111)) (S h147)) (T (T (T (T (T (T (T h122 h146) h145) h52) h73) h128) h144) h143))) (C h121 (T (T (T (T (T (T (T h142 (C (T (T (T (T h141 h133) h130) h18) (C h22 (T (T h129 h132) h140))) h3)) (S h128)) h56) h53) h127) (C (T (C h15 (T (T h76 h69) h14)) (C h15 (T (T (T (T (T (T (T (T (T (T (T (T h13 h126) h125) (C (T h40 h44) h15)) (S h77)) (C h74 h78)) h80) (C (T (T (C h66 h83) h70) h19) h81)) (C (T h18 (C h22 h82)) h81)) (S h84)) (C h124 h78)) h85) (C h123 h5)))) h46)) (S h122)))) (h v120 v21 v0)) (C (T (C h121 h119) (S h118)) h3)) h22)) (h (M v39 v0) v21 v1)) (C (T (T (T (T (T (C (T (T (h v39 v0 x) (C (C h46 h117) h15)) (S (h v39 v103 x))) (T (T (T (C h5 (T (T (T h25 h102) (C (C h15 (T (T h34 (C (T (T (T (T (T (T h33 h30) h9) h87) (C (T (T h99 h69) h14) h46)) h98) (C (T (C h12 (S h97)) h9) h96)) h5)) (S h94))) h5)) (S h93))) (C (T h87 (C h92 h40)) h91)) (S h90)) h88)) (S (h v39 z v1))) (h v39 z v0)) (C h86 h3)) (h v11 v0 v6)) (C (T (C h12 h2) h9) (R v6))) h5)) (S (h v1 v4 v1))) h3)) h2

