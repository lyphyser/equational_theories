import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3404_implies_Equation3973 (G: Type _) [Magma G] (h: Equation3404 G) : Equation3973 G := fun x y z =>
  let v0 := M z x
  let v1 := M y v0
  have h2 := h v1 z x
  have h3 := S h2
  let v4 := M v1 z
  have h5 := h x v1 v4
  have h6 := S h5
  have h7 := R (M v4 x)
  have h8 := h y v0 v1
  have h9 := S h8
  let v10 := M v1 y
  have h11 := h v0 v10 y
  have h12 := S h11
  have h13 := h v10 v1 v0
  have h14 := S h13
  have h15 := R v0
  have h16 := C h15 h8
  have h17 := h y v0 x
  have h18 := S h17
  have h19 := C h15 h18
  let v20 := M x y
  have h21 := h v20 x v0
  have h22 := h v20 x y
  have h23 := S h22
  have h24 := h y y x
  have h25 := R y
  have h26 := C h25 h24
  have h27 := C h25 (T (T (T (T (T h26 h23) h21) h19) h16) h14)
  have h28 := h y y y
  have h29 := h y y v1
  have h30 := S h29
  have h31 := h v1 y v0
  have h32 := S h21
  have h33 := C h15 h17
  have h34 := C h15 h9
  have h35 := h y v0 y
  have h36 := R v1
  have h37 := C h36 (T h35 (C h25 (T (C h15 (T (T (T h28 h27) (C h25 (T (T (T h13 h34) h33) h32))) (C h25 (T h21 h19)))) (S h31))))
  have h38 := C h36 (T (T (T (T h37 h30) h28) h27) h12)
  have h39 := h v1 v1 z
  have h40 := h x y z
  have h41 := R z
  have h42 := C h36 (T (C h41 (C h36 h40)) (S h39))
  have h43 := h v20 z v1
  have h44 := T (T (T h43 h42) h38) h9
  have h45 := R v4
  have h46 := C h45 (C h44 h7)
  let v47 := M v20 z
  have h48 := h x v47 v4
  have h49 := h v20 z z
  have h50 := S h49
  have h51 := S h40
  have h52 := C h41 h51
  have h53 := h v1 z z
  have h54 := C h41 (T h53 (C h41 h52))
  have h55 := R x
  have h56 := C h41 (T (T (T (C h55 (T h54 h50)) h48) h46) h6)
  have h57 := h v4 x z
  have h58 := h v1 z y
  have h59 := S h58
  have h60 := h y v1 y
  have h61 := C h36 (T h37 h30)
  have h62 := h v4 y z
  have h63 := C h25 (T h62 (C h41 (T (C h25 (T (T (T (T h54 h50) h43) h42) h61)) (S h60))))
  have h64 := C h45 (T h63 h59)
  have h65 := h y y v4
  have h66 := C h55 (T h65 h64)
  let v67 := M y y
  have h68 := h z z v4
  have h69 := h v4 z v0
  have h70 := S h69
  have h71 := S h53
  have h72 := C h41 h40
  have h73 := h z v20 v20
  have h74 := S h73
  have h75 := S h43
  have h76 := C h36 (T h39 (C h41 (C h36 h51)))
  have h77 := S h28
  have h78 := C h25 (S h24)
  have h79 := C h25 (T (T (T (T (T h13 h34) h33) h32) h22) h78)
  have h80 := C h36 (T (C h25 (T h31 (C h15 (T (T (T (C h25 (T h33 h32)) (C h25 (T (T (T h21 h19) h16) h14))) h79) h77)))) (S h35))
  have h81 := C h36 (T (T (T (T h11 h79) h77) h29) h80)
  have h82 := T (T (T h8 h81) h76) h75
  have h83 := R v20
  have h84 := h v20 v1 v20
  have h85 := h x y y
  have h86 := h y (M y (M y x)) x
  have h87 := h y x y
  have h88 := S h65
  have h89 := C h41 (T (C h41 h72) h71)
  have h90 := C h25 (T (C h41 (T h60 (C h25 (T (T (T (T (T (C h36 (T (T h28 h27) h12)) h81) h76) h75) h49) h89)))) (S h62))
  have h91 := C h45 (T h58 h90)
  have h92 := C h55 (T h57 h56)
  have h93 := C h45 (T (T (T h92 h3) h58) h90)
  have h94 := h x x v4
  have h95 := h x x z
  have h96 := S h95
  have h97 := h v0 z x
  have h98 := h v0 z y
  have h99 := h v20 y y
  have h100 := h (M v20 y) v20 v0
  have h101 := h y v0 v20
  have h102 := C h83 (T (T (C h55 (T (T (T (T h21 h19) (C h15 h101)) (S h100)) (C (T h99 (C h25 (T (T (C h25 (T (C h25 h40) (S h98))) (C h25 (T (T h97 (C h55 (T (T (T h96 h94) h93) h64))) (C h55 (T h91 h88))))) (S h87)))) h83))) (S h86)) (S h85))
  have h103 := h x x v20
  have h104 := h z x v1
  have h105 := C h55 (S h104)
  have h106 := h v4 v1 x
  have h107 := h y v0 z
  have h108 := S h107
  have h109 := C h41 (T (T (C h45 h108) h106) h105)
  let v110 := M v0 (M z y)
  have h111 := h v110 v4 z
  have h112 := h z v110 v1
  have h113 := h v20 z x
  have h114 := h v1 x z
  have h115 := h v1 x x
  have h116 := h x v47 v20
  have h117 := S h116
  have h118 := R (M v20 x)
  have h119 := C h82 h118
  have h120 := h v0 v1 y
  have h121 := S h120
  have h122 := C h36 (T (T h121 h33) h32)
  have h123 := h v1 y v1
  have h124 := h v1 y x
  have h125 := S h124
  have h126 := h v0 x y
  have h127 := C h55 h126
  have h128 := h v0 x x
  have h129 := h v4 v1 z
  have h130 := h v1 v1 v1
  have h131 := h x z x
  have h132 := C h55 (T (C h55 (T h131 (C h55 (T (T (T (C h41 (T (T (T (T (T (T h94 h93) h88) h29) h80) h130) (C h36 (T (T (T h76 h75) h49) h89)))) (S h129)) h106) h105)))) (S h128))
  have h133 := h z x x
  have h134 := h z x v20
  have h135 := C h83 (T (T (T (T (T (T h133 h132) h127) h125) h123) h122) h119)
  have h136 := h v0 v20 v20
  have h137 := S h112
  have h138 := S h111
  have h139 := S h106
  have h140 := C h55 h104
  have h141 := C h41 (T (T h140 h139) (C h45 h107))
  have h142 := R (M x x)
  have h143 := h x v47 x
  have h144 := h v0 x v20
  have h145 := S h126
  have h146 := C h83 (T (T (T (T (T (C h25 (T (T (T (T h135 h117) h48) h46) h6)) h145) h144) (C h83 (T (T (T (T (T (T (T (T (C h55 (T (T (T (T (T (T h135 h117) h143) (C h55 (T (T (T (T (T (C h44 h142) (C h36 (T (T h95 h141) h138))) h137) h108) h17) (C h55 (T (T (T (T (T h136 (C h83 (T (T (T (T (T (T (T (T (C h83 (T h135 h117)) (S h134)) h133) h132) h127) h125) h123) h122) h119))) h117) h48) h46) h6))))) (S h115)) h114) (C h41 (C h55 h51)))) (S h113)) h43) h42) h38) h9) h107) h112) (C h36 (T (T (T (T h111 h109) h96) h103) h102))))) (S h84)) (C h83 h82))
  have h147 := h v0 y v20
  have h148 := C h15 (T (C h41 (T (T (T h147 h146) h74) h72)) h71)
  have h149 := h y z v0
  have h150 := C h41 (T h149 h148)
  have h151 := h y z x
  have h152 := S h151
  have h153 := C h41 h152
  have h154 := h v20 x z
  have h155 := h v20 x v20
  have h156 := C h15 (T (T (T (T (C h83 (T h97 (C h55 (T (T h96 h103) h102)))) (S h155)) h154) h153) h150)
  have h157 := h z v20 v0
  have h158 := T (T h94 (C h45 (T (T (T h92 h3) h53) (C h41 (T (T (T h52 h157) h156) h70))))) (S h68)
  let v159 := M x v0
  have h160 := S h157
  have h161 := S h97
  have h162 := S h103
  have h163 := S h94
  have h164 := T h49 h89
  have h165 := S h48
  have h166 := C h45 (C h82 h7)
  have h167 := C h55 (T (C h41 (T (T (T h5 h166) h165) (C h55 h164))) (S h57))
  have h168 := C h45 (T (T (T h63 h59) h2) h167)
  have h169 := C h83 (T (T h85 h86) (C h55 (T (T (T (T (C (T (C h25 (T (T h87 (C h25 (T (T h66 (C h55 (T (T (T h91 h168) h163) h95))) h161))) (C h25 (T h98 (C h25 h51))))) (S h99)) h83) h100) (C h15 (S h101))) h33) h32)))
  have h170 := S h149
  have h171 := S h147
  have h172 := S h133
  have h173 := C h55 (T h128 (C h55 (T (C h55 (T (T (T h140 h139) h129) (C h41 (T (T (T (T (T (T (C h36 (T (T (T h54 h50) h43) h42)) (S h130)) h37) h30) h65) h168) h163)))) (S h131))))
  have h174 := C h55 h145
  have h175 := S h123
  have h176 := C h36 (T (T h21 h19) h120)
  have h177 := C h44 h118
  have h178 := C h83 (T (T (T (T (T (T h177 h176) h175) h124) h174) h173) h172)
  have h179 := C h83 (T (T (T (T (T (C h83 h44) h84) (C h83 (T (T (T (T (T (T (T (T (C h36 (T (T (T (T h169 h162) h95) h141) h138)) h137) h108) h8) h81) h76) h75) h113) (C h55 (T (T (T (T (T (T (C h41 (C h55 h40)) (S h114)) h115) (C h55 (T (T (T (T (T (C h55 (T (T (T (T (T h5 h166) h165) h116) (C h83 (T (T (T (T (T (T (T (T h177 h176) h175) h124) h174) h173) h172) h134) (C h83 (T h116 h178))))) (S h136))) h18) h107) h112) (C h36 (T (T h111 h109) h96))) (C h82 h142)))) (S h143)) h116) h178))))) (S h144)) h126) (C h25 (T (T (T (T h5 h166) h165) h116) h178)))
  have h180 := C h15 (T h53 (C h41 (T (T (T h52 h73) h179) h171)))
  have h181 := C h15 (T (T (T (T (C h41 (T h180 h170)) (C h41 h151)) (S h154)) h155) (C h83 (T (C h55 (T (T h169 h162) h95)) h161)))
  have h182 := C h41 (T (T (T h69 h181) h160) h72)
  have h183 := S (h y x v0)
  have h184 := C h55 (T (T h69 h181) h160)
  have h185 := h x (M v4 z) z
  have h186 := S h185
  have h187 := h (M v0 y) v0 v0
  have h188 := h y v0 v0
  have h189 := C h25 (T (T (T h91 h88) h29) h80)
  have h190 := C h25 (T (T (T (T h169 h162) h94) h93) h64)
  have h191 := C h25 (T h103 h102)
  have h192 := C h45 (T (T (T h182 h71) h2) h167)
  have h193 := C h25 (T (T h68 h192) h163)
  have h194 := C h41 (T (T (T (T (T (T (T h193 h191) h190) h189) h121) (C h15 h188)) (S h187)) (C (T (T (T (T (T h147 h146) h74) h157) h156) h70) h15))
  have h195 := h z y z
  have h196 := C h15 (T (T (T (T h195 h194) h186) h184) (C h55 (T (T h73 h179) h171)))
  have h197 := C h41 (T (T (T (T (T (T (T (C (T (T (T (T (T h69 h181) h160) h73) h179) h171) h15) h187) (C h15 (S h188))) h120) (C h25 (T (T (T h37 h30) h65) h64))) (C h25 (T (T (T (T h91 h168) h163) h103) h102))) (C h25 (T h169 h162))) (C h25 h158))
  have h198 := C h55 (T (T h157 h156) h70)
  have h199 := C h41 (T (T (T (T (T (C h55 (T (T (T (T (T (T h195 h194) h186) h184) h152) h149) h148)) (C h55 (T (T (T (T (T (T (T (T h180 h170) h151) h198) h185) h197) (S h195)) (h z y v20)) (C h83 (T (T (C h25 h164) (C h25 (T (T (T (T (T (T (T h54 h50) h43) h42) h38) h9) h107) (C h41 (T h196 h183))))) (S (h x z y))))))) (S (h z v20 x))) h157) h156) h70)
  have h200 := h y x z
  T (T (T (T (T (T (T (h x y v20) (C h83 (T (C h25 (T h22 h78)) h77))) (h v20 v67 v1)) (C h36 (T (T (T (C (R v67) (T (T (T (C h36 (T h40 (h z v1 v1))) (S (h v4 v1 v1))) h106) h105)) (h v67 v159 v4)) (C h45 (C (R v159) (T (T (T (T (T (T (C h45 (T (T h65 h168) h163)) (C h45 (T (h x x x) (C h55 (T (T (C h55 h158) (C h55 (T (T (T (T (T h68 h192) h93) h88) h28) (C h25 (T (T (T (T (T (T h26 h23) h154) h153) h150) (C h41 (T (T (T (T (T (T (T (T (T h180 h170) h151) h198) h185) h197) (C h41 (T (T (T (T (T (T h193 h191) h190) h189) h121) h33) h32))) (C h41 (T (T h21 h19) (C h15 h107)))) (S (h v110 v0 z))) (C (T (T (T (T (T h196 h183) h200) h199) h182) h71) h15)))) (S (h x v4 z))))))) (S (h v4 y x))))))) (S (h y x v4))) h200) h199) h182) h71)))) (C h45 (T (T (T (T (T (T (T (h v159 v4 z) (C h41 (T (C h45 h96) (C h45 h158)))) (S (h z v4 z))) h54) h50) h43) h42) h61))))) (S (h v67 v4 v1))) (h v67 v4 x)) (C h55 (T (T (T (C h45 h66) (S (h v4 x v4))) h57) h56))) h3

