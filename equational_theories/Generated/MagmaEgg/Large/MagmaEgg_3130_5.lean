import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation3130_implies_Equation5 (G: Type _) [Magma G] (h: Equation3130 G) : Equation5 G := fun x y =>
  have h0 := R x
  let v1 := M y x
  let v2 := M x v1
  have h3 := h y (M v2 y) v1
  have h4 := S h3
  have h5 := R y
  have h6 := R v1
  have h7 := h v1 x y
  have h8 := h v1 x v1
  have h9 := C (S h8) h6
  have h10 := h v1 v2 v1
  have h11 := C (T (T h10 h9) (C h7 h6)) h5
  have h12 := S h10
  have h13 := C h8 h6
  have h14 := h v1 (M (M v1 x) v1) x
  have h15 := S h14
  have h16 := h x v1 v1
  have h17 := C (C h16 h0) h6
  have h18 := h x y x
  have h19 := C (S h18) h0
  have h20 := h x v1 x
  have h21 := C (T h20 h19) h6
  have h22 := T (T h21 h17) h15
  have h23 := C h6 h22
  have h24 := T (T h23 h13) h12
  have h25 := C h24 h5
  have h26 := S h20
  have h27 := C h18 h0
  have h28 := C (T h27 h26) h6
  have h29 := C (C (S h16) h0) h6
  have h30 := T (T h14 h29) h28
  have h31 := C h6 h30
  have h32 := h v2 v1 v1
  have h33 := S h32
  have h34 := h v2 v1 y
  have h35 := S h34
  have h36 := T (T h10 h9) h31
  have h37 := C h36 h5
  have h38 := C (T (T (C (S h7) h6) h13) h12) h5
  have h39 := C (T (T h3 h38) h37) h5
  let v40 := M x y
  have h41 := h y (M v40 y) y
  have h42 := h y x y
  have h43 := h y x x
  have h44 := C (T (T (C (C (S h43) h5) h5) (C (C h42 h5) h5)) (S h41)) h5
  have h45 := h y (M (M v40 x) x) y
  have h46 := C (T (T h45 h44) h39) h30
  have h47 := C h36 h22
  have h48 := C (T (T (T (T h10 h9) h31) h47) (C h47 h6)) (T h46 h35)
  have h49 := C (T (T (T (T (T (T (T h48 h33) h21) h17) h15) h10) h9) h31) h5
  have h50 := S h45
  have h51 := C (T (T h41 (C (C (S h42) h5) h5)) (C (C h43 h5) h5)) h5
  have h52 := C (T (T h25 h11) h4) h5
  have h53 := C (T (T h52 h51) h50) h22
  have h54 := C h24 h30
  have h55 := C (T (T (T (T (C h54 h6) h54) h23) h13) h12) (T h34 h53)
  let v56 := M y v1
  have h57 := h v56 v1 y
  have h58 := S h57
  have h59 := R v56
  have h60 := C (T (T (T (T (T (T (T h23 h13) h12) h14) h29) h28) h32) h55) h5
  have h61 := C h60 h5
  have h62 := C (T (T (T h45 h44) h39) h61) h59
  have h63 := T (T (T (T (T h62 h58) h46) h35) h32) h55
  have h64 := C h63 h5
  have h65 := C h49 h5
  have h66 := C (T (T (T h65 h52) h51) h50) h59
  have h67 := h v56 y x
  have h68 := S h67
  have h69 := T (T (T (T (T h48 h33) h34) h53) h57) h66
  have h70 := C h69 h0
  have h71 := C h70 h0
  have h72 := T (T (T (T h14 h29) h28) h32) h55
  have h73 := C h72 h0
  have h74 := h v1 x x
  have h75 := C (T (T (C (S h74) h6) h13) h12) h0
  have h76 := h x (M v2 x) v1
  have h77 := C (T (T h76 h75) h73) h0
  have h78 := C (T (T (T h20 h19) h77) h71) h59
  have h79 := T (T (T h78 h68) h57) h66
  have h80 := C h79 h5
  have h81 := S h76
  have h82 := C (T (T h10 h9) (C h74 h6)) h0
  have h83 := T (T (T (T h48 h33) h21) h17) h15
  have h84 := C h83 h0
  have h85 := C (T (T h84 h82) h81) h0
  have h86 := C h63 h0
  have h87 := C h86 h0
  have h88 := C (T (T (T h87 h85) h27) h26) h59
  have h89 := h v56 x v1
  have h90 := S h89
  have h91 := T (T (T (T h14 h29) h28) h34) h53
  have h92 := T (T (T (T h46 h35) h21) h17) h15
  have h93 := h v56 v1 v1
  have h94 := S h93
  have h95 := C h72 h92
  have h96 := C (T (T (T (T (T (T (T h62 h58) h46) h35) h32) h55) h95) (C h95 h6)) h91
  have h97 := C (T (T (T (T (C (T (T (T h96 h94) h57) h66) h6) h96) h94) h67) h88) h92
  have h98 := h v56 y v1
  have h99 := C (T (T h98 h97) (C (T (T (T h78 h68) h98) h97) h6)) h91
  have h100 := T (T (T (T (T (T h99 h90) h46) h35) h21) h17) h15
  have h101 := C h91 h100
  have h102 := T (T (T (T h101 h99) h90) h67) h88
  have h103 := C h102 h5
  have h104 := S h98
  have h105 := C h83 h91
  have h106 := C (T (T (T (T (T (T (T (C h105 h6) h105) h48) h33) h34) h53) h57) h66) h92
  have h107 := C (T (T (T (T h78 h68) h93) h106) (C (T (T (T h62 h58) h93) h106) h6)) h91
  have h108 := C (T (T (C (T (T (T h107 h104) h67) h88) h6) h107) h104) h92
  have h109 := T (T (T (T (T (T h14 h29) h28) h34) h53) h89) h108
  have h110 := C h92 h109
  let v111 := M v56 v1
  have h112 := h v111 v1 y
  have h113 := S h112
  have h114 := R v111
  have h115 := T (T (T (T h78 h68) h89) h108) h110
  have h116 := C h115 h5
  have h117 := C h116 h5
  have h118 := T (T (T h62 h58) h67) h88
  have h119 := C h118 h5
  have h120 := C h119 h5
  have h121 := C h69 h5
  have h122 := C h121 h5
  have h123 := C (T (T (T (T (T (T h45 h44) h39) h61) h122) h120) h117) h114
  have h124 := T (T h123 h113) h110
  have h125 := C h124 h5
  have h126 := C h64 h5
  have h127 := C h80 h5
  have h128 := C h103 h5
  have h129 := C (T (T (T (T (T (T h128 h127) h126) h65) h52) h51) h50) h114
  have h130 := h v111 y x
  have h131 := S h130
  have h132 := T (T h101 h112) h129
  have h133 := C h132 h0
  have h134 := C h133 h0
  have h135 := C h115 h0
  have h136 := C h135 h0
  have h137 := C h118 h0
  have h138 := C h137 h0
  have h139 := C (T (T (T (T (T (T h20 h19) h77) h71) h138) h136) h134) h114
  have h140 := T (T (T h139 h131) h112) h129
  have h141 := C h140 h5
  have h142 := C h79 h0
  have h143 := C h142 h0
  have h144 := C h102 h0
  have h145 := C h144 h0
  have h146 := C h124 h0
  have h147 := C h146 h0
  have h148 := C (T (T (T (T (T (T h147 h145) h143) h87) h85) h27) h26) h114
  have h149 := h v111 x v1
  have h150 := S h149
  have h151 := h v111 v1 v1
  have h152 := S h151
  have h153 := C (T (T (T (T (T (T (T h14 h29) h28) h34) h53) h89) h108) h110) h100
  have h154 := C (T (T (T (T h123 h113) h110) h153) (C h153 h6)) h109
  have h155 := C (T (T (T (T (C (T (T (T h154 h152) h112) h129) h6) h154) h152) h130) h148) h100
  have h156 := h v111 y v1
  have h157 := C (T (T h156 h155) (C (T (T (T h139 h131) h156) h155) h6)) h109
  have h158 := T (T (T (T (T (T (T (T h157 h150) h99) h90) h46) h35) h21) h17) h15
  have h159 := C h109 h158
  have h160 := T (T (T (T h159 h157) h150) h130) h148
  have h161 := C h160 h5
  have h162 := S h156
  have h163 := C (T (T (T (T (T (T (T h101 h99) h90) h46) h35) h21) h17) h15) h109
  have h164 := C (T (T (T (T (C h163 h6) h163) h101) h112) h129) h100
  have h165 := C (T (T (T (T h139 h131) h151) h164) (C (T (T (T h123 h113) h151) h164) h6)) h109
  have h166 := C (T (T (C (T (T (T h165 h162) h130) h148) h6) h165) h162) h100
  have h167 := T (T (T (T (T (T (T (T h14 h29) h28) h34) h53) h89) h108) h149) h166
  have h168 := C h100 h167
  let v169 := M v111 v1
  have h170 := h v169 v1 y
  have h171 := S h170
  have h172 := R v169
  have h173 := T (T (T (T h139 h131) h149) h166) h168
  have h174 := C h173 h5
  have h175 := C h174 h5
  have h176 := T (T (T h123 h113) h130) h148
  have h177 := C h176 h5
  have h178 := C h177 h5
  have h179 := C h132 h5
  have h180 := C h179 h5
  have h181 := C (T (T (T (T (T (T (T (T (T h45 h44) h39) h61) h122) h120) h117) h180) h178) h175) h172
  have h182 := T (T h181 h171) h168
  have h183 := C h182 h5
  have h184 := C h125 h5
  have h185 := C h141 h5
  have h186 := C h161 h5
  have h187 := C (T (T (T (T (T (T (T (T (T h186 h185) h184) h128) h127) h126) h65) h52) h51) h50) h172
  have h188 := h v169 y x
  have h189 := S h188
  have h190 := T (T h159 h170) h187
  have h191 := C h190 h0
  have h192 := C h173 h0
  have h193 := C h176 h0
  have h194 := C (T (T (T (T (T (T (T (T (T h20 h19) h77) h71) h138) h136) h134) (C h193 h0)) (C h192 h0)) (C h191 h0)) h172
  have h195 := T (T (T h194 h189) h170) h187
  have h196 := C h195 h5
  have h197 := C h140 h0
  have h198 := C h160 h0
  have h199 := C h182 h0
  have h200 := C (T (T (T (T (T (T (T (T (T (C h199 h0) (C h198 h0)) (C h197 h0)) h147) h145) h143) h87) h85) h27) h26) h172
  have h201 := C (T (T (T (T (T h89 h108) h149) h166) h188) h200) h5
  have h202 := T (T (T (T (T (T (T (T (T (T (T (T h201 h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4
  have h203 := C h91 h202
  have h204 := C (T (T (T (T (T (T (T (T (T (T (T (T (T h203 h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4) h0
  have h205 := C (T (T (T (T (T h194 h189) h157) h150) h99) h90) h5
  have h206 := T (T (T h181 h171) h188) h200
  have h207 := C h206 h5
  have h208 := C h190 h5
  have h209 := T (T (T (T (T (T (T (T (T (T (T (T h3 h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205
  have h210 := C h92 h209
  let v211 := M v56 y
  have h212 := h v211 v1 y
  have h213 := S h212
  have h214 := R v211
  have h215 := C (T h205 h210) h5
  have h216 := C h207 h5
  have h217 := C h208 h5
  have h218 := C (T (T (T (T (T (T (T (T (T (T (T (T (T h45 h44) h39) h61) h122) h120) h117) h180) h178) h175) h217) h216) h215) (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h203 h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4) h45) h44) h39) h61) h122) h120) h117) h180) h178) h175) h217) h216) h215) h5)) h214
  have h219 := T (T h218 h213) h210
  have h220 := C h219 h0
  have h221 := C h183 h5
  have h222 := C h196 h5
  have h223 := C (T h203 h201) h5
  have h224 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h223 h222) h221) h186) h185) h184) h128) h127) h126) h65) h52) h51) h50) h3) h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205) h210) h5) h223) h222) h221) h186) h185) h184) h128) h127) h126) h65) h52) h51) h50) h214
  have h225 := h v211 y x
  have h226 := S h225
  have h227 := T (T h203 h212) h224
  have h228 := C h227 h0
  have h229 := C h228 h0
  have h230 := C (T (T (T (T (T (T (T (T (T (T (T (T (T h3 h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205) h210) h0
  have h231 := C (T (T (T (T (T (T (T (T (T (T (T h194 h189) h157) h150) h99) h90) h46) h35) h21) h17) h15) h230) h0
  have h232 := C h206 h0
  have h233 := C (T (T (T (T (T (T (T (T (T (T (T (T h76 h75) h73) h70) h137) h135) h133) h193) h192) h191) h232) h231) h229) h214
  have h234 := T (T (T h233 h226) h212) h224
  have h235 := C h234 h0
  have h236 := C h195 h0
  have h237 := C (T (T (T (T (T (T (T (T (T (T (T h204 h14) h29) h28) h34) h53) h89) h108) h149) h166) h188) h200) h0
  have h238 := C h220 h0
  have h239 := C (T (T (T (T (T (T (T (T (T (T (T (T h238 h237) h236) h199) h198) h197) h146) h144) h142) h86) h84) h82) h81) h214
  have h240 := h v211 x v1
  have h241 := S h240
  have h242 := h v211 x y
  have h243 := S h242
  have h244 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T h218 h213) h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4) h209
  have h245 := C (T (T (T (T (T (C h244 h5) h244) h218) h213) h225) h239) h202
  have h246 := h v211 y y
  have h247 := C (T (T h246 h245) (C (T (T (T h233 h226) h246) h245) h5)) h209
  have h248 := T (T (T h218 h213) h225) h239
  have h249 := h v169 x y
  have h250 := h v1 y v1
  have h251 := C (T (T (T h250 (C (T h249 (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h222 h221) h186) h185) h184) h128) h127) h126) h65) h52) h51) h50) h3) h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205) h210) h158)) h6)) (C (C h227 h6) h6)) (C (C h248 h6) h6)) (T h247 h243)
  have h252 := C (T (T (T h251 h241) h225) h239) h0
  have h253 := S h246
  have h254 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T h3 h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205) h212) h224) h202
  have h255 := C (T (T (T (T (T h233 h226) h212) h224) h254) (C h254 h5)) h209
  have h256 := C (T (T (C (T (T (T h255 h253) h225) h239) h5) h255) h253) h202
  have h257 := C (T (T (T (C (C h234 h6) h6) (C (C h219 h6) h6)) (C (T (C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h203 h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4) h45) h44) h39) h61) h122) h120) h117) h180) h178) h175) h217) h216) h167) (S h249)) h6)) (S h250)) (T h242 h256)
  let v258 := M v211 y
  have h259 := h v258 v1 y
  have h260 := S h259
  have h261 := R v258
  have h262 := C (T h240 h257) h5
  have h263 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h3 h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205) h242) h256) h262) (C (T (T (T (T h251 h241) h242) h256) h262) h5)) h261
  have h264 := C (T (T (T (T (T h263 h260) h247) h243) h240) h257) h0
  have h265 := C (T h251 h241) h5
  have h266 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (C (T (T (T (T h265 h247) h243) h240) h257) h5) h265) h247) h243) h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4) h261
  have h267 := h v258 y x
  have h268 := S h267
  have h269 := C (T (T (T (T (T h251 h241) h242) h256) h259) h266) h0
  have h270 := C h269 h0
  have h271 := C (T (T (T h233 h226) h240) h257) h0
  have h272 := C h271 h0
  have h273 := C h248 h0
  have h274 := C h273 h0
  have h275 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h76 h75) h73) h70) h137) h135) h133) h193) h192) h191) h232) h231) h229) h274) h272) h270) h261
  have h276 := C (T (T (T h275 h268) h259) h266) h0
  have h277 := C h235 h0
  have h278 := C h252 h0
  have h279 := C h264 h0
  have h280 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h279 h278) h277) h238) h237) h236) h199) h198) h197) h146) h144) h142) h86) h84) h82) h81) h261
  have h281 := C (T (T (T h263 h260) h267) h280) h0
  have h282 := C (T (T (T (T (T (T (T (T (T (T h46 h35) h21) h17) h15) h230) h228) h273) h271) h269) h281) h0
  have h283 := T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h282 (C h276 h0)) h279) h278) h277) h238) h237) h236) h199) h198) h197) h146) h144) h142) h86) h84) h82) h81
  have h284 := T (T (T (T (T (T (T (T (T (T (T (T (T (T h3 h38) h37) h60) h121) h119) h116) h179) h177) h174) h208) h207) h205) h242) h256
  have h285 := C (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h263 h260) h247) h243) h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4) h284
  have h286 := C (T (T (T (T (T (C h285 h5) h285) h263) h260) h267) h280) (T (T (T (T (T (T (T (T (T (T (T (T (T (T h247 h243) h201) h196) h183) h161) h141) h125) h103) h80) h64) h49) h25) h11) h4)
  have h287 := h v258 y y
  T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T (T h76 h75) h73) h70) h137) h135) h133) h193) h192) h191) h232) h231) h229) h274) h272) h270) (C h281 h0)) (C (T (T (T (T (T (T (T (T (T (T h276 h264) h252) h235) h220) h204) h14) h29) h28) h34) h53) h0)) (h (M v56 x) v1 y)) (C (T (T (T (C (T (T (T (T (C (T (C h91 h283) h282) h284) (S (h v258 x x))) h287) h286) (C (T (T (T h275 h268) h287) h286) h5)) h284) (S (h v258 x y))) h267) h280) h283)) h276) h264) h252) h235) h220) h204

