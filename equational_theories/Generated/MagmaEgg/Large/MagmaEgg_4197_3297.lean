import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation4197_implies_Equation3297 (G: Type _) [Magma G] (h: Equation4197 G) : Equation3297 G := fun x y z =>
  let v0 := M z y
  let v1 := M z v0
  have h2 := h y v1 v0
  have h3 := S h2
  let v4 := M y v1
  have h5 := h (M (M v0 y) v1) v0 v4
  have h6 := S h5
  have h7 := R v4
  have h8 := R v0
  have h9 := R v1
  have h10 := h v0 y z
  have h11 := S h10
  have h12 := C h11 h9
  have h13 := h y z v1
  have h14 := h y z x
  have h15 := R x
  have h16 := R z
  have h17 := h x y v4
  have h18 := S h17
  have h19 := h v1 x y
  have h20 := h z v0 v1
  have h21 := S h20
  let v22 := M (M v1 z) v0
  have h23 := h v22 v1 v4
  have h24 := S h23
  have h25 := h y v1 v4
  have h26 := S h25
  let v27 := M v4 y
  have h28 := h v27 v1 y
  have h29 := S h28
  have h30 := R y
  have h31 := h z v0 y
  have h32 := S h31
  let v33 := M y z
  have h34 := h (M v33 v0) y v4
  have h35 := S h34
  have h36 := h v33 v0 v4
  have h37 := S h13
  have h38 := C h10 h9
  have h39 := C (C (C h7 (T (T (T h2 h5) (C (C (C h7 (T h38 h37)) h8) h7)) (S h36))) h30) h7
  have h40 := h v4 y v4
  have h41 := T (T (T h40 h39) h35) h32
  have h42 := S h40
  have h43 := C (C (C h7 (T (T (T h36 (C (C (C h7 (T h13 h12)) h8) h7)) h6) h3)) h30) h7
  have h44 := T (T (T h31 h34) h43) h42
  have h45 := C h30 h44
  have h46 := C h45 h41
  have h47 := C h7 h44
  have h48 := C (T h47 h46) h30
  have h49 := C (T h48 h29) h7
  have h50 := C h7 h41
  have h51 := C h30 h41
  have h52 := C h51 h44
  have h53 := C (T h52 h50) h30
  have h54 := h v27 v1 v0
  have h55 := S h54
  have h56 := h v0 v1 z
  have h57 := C (T (S h56) (C h8 h44)) h9
  have h58 := h v1 z v1
  have h59 := h v1 z y
  have h60 := S h59
  have h61 := h v1 y v4
  have h62 := T (T h61 h49) h26
  have h63 := C h62 h16
  have h64 := T h10 h63
  have h65 := C (T (T (T (C h64 h30) h60) h58) h57) h8
  have h66 := h y y v0
  have h67 := h y y z
  have h68 := S h67
  have h69 := S h61
  have h70 := C (T h28 h53) h7
  have h71 := T (T h25 h70) h69
  have h72 := C h71 h16
  have h73 := T h72 h11
  have h74 := C h73 h16
  have h75 := C (T (T (T (T (T (T h74 h68) h66) h65) h55) h28) h53) h7
  have h76 := h z z v4
  have h77 := h z z z
  have h78 := S h77
  have h79 := S h76
  have h80 := C h64 h16
  have h81 := S h66
  have h82 := S h58
  have h83 := C (T (C h8 h41) h56) h9
  have h84 := C (T (T (T h83 h82) h59) (C h73 h30)) h8
  have h85 := C (T (T (T (T (T (T h48 h29) h54) h84) h81) h67) h80) h7
  have h86 := T (T h61 h85) h79
  have h87 := C (T h72 (C h86 h16)) h16
  have h88 := C (T h58 h57) h8
  have h89 := h v22 v1 v1
  have h90 := S h89
  have h91 := C (T h83 h82) h8
  have h92 := T h54 h91
  have h93 := C h9 h92
  have h94 := T (T h76 h75) h69
  have h95 := C (T (C h94 h16) h63) h16
  have h96 := C h9 (T (T (T (T (T (T (T (T (T h61 h85) h79) h77) h95) h74) h68) h66) h65) h55)
  have h97 := C (C (T h96 h93) h9) h9
  have h98 := h (M v1 y) v1 v1
  have h99 := T (T (T h98 h97) h90) h21
  have h100 := C h7 h92
  have h101 := C (T (T (T (T (T (T (T (T (T (T (T (T h48 h29) h54) h84) h81) h67) h80) h87) h78) h76) h75) h49) h26) (T (T (T (T (T (T (T (T (T (T h25 h70) h85) h79) h77) h95) h74) h68) h66) h65) h55)
  have h102 := C (T (T (T h25 h70) h101) h100) h99
  have h103 := S h98
  have h104 := C h9 (T (T (T (T (T (T (T (T (T h54 h84) h81) h67) h80) h87) h78) h76) h75) h69)
  have h105 := T h88 h55
  have h106 := C h9 h105
  have h107 := C (C (T h106 h104) h9) h9
  have h108 := T (T (T h20 h89) h107) h103
  have h109 := h y y v1
  have h110 := S h109
  have h111 := C (T (T (T (T h31 h34) h43) h42) (C h71 h30)) h99
  have h112 := C (T (T (T (T (T (T (T (T (T h111 h110) h67) h80) h87) h78) h76) h75) h49) h26) h108
  have h113 := C (T (T (T (T (C h62 h30) h40) h39) h35) h32) h108
  have h114 := T (T (T (T (T (T (T h98 h97) h90) h21) h31) h34) h43) h42
  have h115 := C h30 h114
  have h116 := C (T (T (T (T (T (T (T (T (T (T (T h115 h51) h25) h70) h85) h79) h77) h95) h74) h68) h109) h113) h9
  have h117 := C h30 (T (T (T (T (T (T (T h40 h39) h35) h32) h20) h89) h107) h103)
  have h118 := C (T (T (T (T (T (T (T (T (T (T (T (T h88 h84) h81) h67) h80) h87) h78) h76) h75) h49) h26) h45) h117) h9
  have h119 := C (T (T (T (T h20 h118) h116) h112) h102) (T (T (T (T (T (T (T (T (T (T h88 h84) h81) h67) h80) h87) h78) h76) h75) h49) h26)
  have h120 := C h9 h71
  have h121 := C h9 h62
  have h122 := C (T (T (T (T (T (T (T (T (T (T (T (T h115 h51) h25) h70) h85) h79) h77) h95) h74) h68) h66) h65) h91) h9
  have h123 := C (T (T (T (T (T (T (T (T (T (T (T h111 h110) h67) h80) h87) h78) h76) h75) h49) h26) h45) h117) h9
  have h124 := C (T (T (T (T (T (T (T (T (T h25 h70) h85) h79) h77) h95) h74) h68) h109) h113) h99
  have h125 := C (T (T (T (T (T (T (T (T (T (T (T (T h25 h70) h85) h79) h77) h95) h74) h68) h66) h65) h55) h28) h53) (T (T (T (T (T (T (T (T (T (T h54 h84) h81) h67) h80) h87) h78) h76) h75) h49) h26)
  have h126 := C h7 h105
  have h127 := C (T (T (T h126 h125) h49) h26) h108
  have h128 := C (T (T (T (T h127 h124) h123) h122) h21) (T (T (T (T (T (T (T (T (T (T h25 h70) h85) h79) h77) h95) h74) h68) h66) h65) h91)
  have h129 := C (T (T (C (T (T (T (T (T (T (T (T (T (T (T h47 h46) (C (T (T (T (T h51 h25) h70) h101) h100) h9)) h127) h124) h123) h122) h23) h128) h106) h104) h121) h15) (C (T (T (T (T (T h120 h96) h93) h119) h24) h21) h15)) h19) h7
  have h130 := h v1 x v4
  have h131 := T (T h130 h129) h18
  have h132 := C h131 h16
  have h133 := h v0 x z
  have h134 := C (C h7 (T (T (T (C (T h133 h132) h15) (S h14)) h13) h12)) h8
  have h135 := S h133
  have h136 := S h130
  have h137 := T (T (T (T (T h20 h23) h128) h106) h104) h121
  have h138 := S h19
  have h139 := C (T (T h138 (C h137 h15)) (C (T (T (T (T (T (T (T (T (T (T (T h120 h96) h93) h119) h24) h118) h116) h112) h102) (C (T (T (T (T h126 h125) h49) h26) h45) h9)) h52) h50) h15)) h7
  have h140 := C (T (T h17 h139) h136) h16
  have h141 := C (T h140 h135) h15
  let v142 := M x x
  have h143 := h x x v0
  have h144 := S h143
  have h145 := h (M (M v0 x) x) v0 v4
  have h146 := S h145
  have h147 := C (C (C h7 (T (T (T h38 h37) h14) h141)) h8) h7
  have h148 := h v142 y x
  have h149 := S h148
  have h150 := h x v142 x
  have h151 := S h150
  have h152 := R v142
  have h153 := h x x x
  have h154 := S h153
  have h155 := h x x v142
  have h156 := C (T h155 (C h154 h152)) h15
  have h157 := h v142 x x
  have h158 := S h157
  have h159 := C (T (T (T (T (T (T (T (T (T (T h76 h75) h49) h26) h2) h5) h147) h146) h144) h153) (C (T h156 h151) h15)) h15
  have h160 := C h86 h15
  have h161 := C h71 h15
  have h162 := C (T (T (T (T h17 h139) h136) h19) (C (T (T (T (T (T h161 h160) h159) h158) h156) h151) h30)) h15
  let v163 := M v1 x
  have h164 := h v163 x v4
  have h165 := h x y v0
  have h166 := h x y x
  have h167 := h y x x
  have h168 := h x z y
  have h169 := h (M (M x z) v0) x v4
  have h170 := h z v0 x
  have h171 := C (T (C h153 h152) (S h155)) h15
  T (T (T (h x x v4) (C (T (T (T (T (T (T (T (h (M v4 x) x v4) (C (C (C h7 (T (T (T h161 h160) h159) h158)) h15) h7)) (S (h (M v142 x) x v4))) h154) (h x x v1)) (h (M v163 x) v1 v0)) (C (T (T (T (T (T (C (C h8 (T (T (T (T (T (T (T h164 (C (C (C h7 (T (T (T (T h130 h129) h18) h165) (C (T (C (T (T h133 h132) (C (T (T h166 (C (T h148 (C (T (T (T (T (C (T (T (T (T (T h150 h171) h157) (C (T (T (T (T (T (T (T (T (T (T (C (T h150 h171) h15) h154) h143) h145) (C h134 h7)) h6) h3) h25) h70) h85) h79) h15)) (C h94 h15)) (C h62 h15)) h30) h138) h130) h129) h18) h15)) h15)) (S h167)) h16)) h30) (S h168)) h8))) h15) h7)) (S h169)) (S h170)) h20) h89) h107) h103)) h9) (C (C h8 h114) h9)) h83) h82) (h v1 z v0)) (C (S (h y v1 z)) (T (T (T (T (h z y v4) (C (T (T h60 (C h137 h16)) (C (T (T (T (T (T (T (T (T (T (T (T (T h120 h96) h93) h119) h24) h21) h170) h169) (C (C (C h7 (T (T (T (T (C (T h168 (C (T (T (C (T (T h167 (C (T h162 h149) h15)) (S h166)) h16) h140) h135) h30)) h8) (S h165)) h17) h139) h136)) h15) h7)) (S h164)) (C h131 h15)) h162) h149) h16)) (T (T (T (T h2 h5) h147) h146) h144))) (S (h y z v142))) h14) h141))) h8)) h134) h7)) h6) h3

