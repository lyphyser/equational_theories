import equational_theories.AllEquations
import equational_theories.Magma

private def congr_op {G: Type _} [Magma G] {a b c d: G} (h1: a = b) (h2: c = d): a âˆ˜ c = b âˆ˜ d := by
  rw [h1, h2]
private abbrev T := @Eq.trans
private abbrev S := @Eq.symm
private abbrev R := @Eq.refl
private abbrev M := @Magma.op
private abbrev C := @congr_op

set_option maxRecDepth 999999

@[equational_result]
theorem Equation4197_implies_Equation3943 (G: Type _) [Magma G] (h: Equation4197 G) : Equation3943 G := fun x y z =>
  let v0 := M z z
  let v1 := M x v0
  let v2 := M v1 y
  have h3 := h v1 y v2
  have h4 := S h3
  let v5 := M (M v2 v1) y
  have h6 := h v5 v2 v0
  have h7 := S h6
  have h8 := R v0
  have h9 := R v2
  have h10 := R y
  have h11 := h x v0 y
  have h12 := S h11
  let v13 := M (M y x) v0
  have h14 := h v13 y v2
  have h15 := S h14
  have h16 := h y x v1
  have h17 := S h16
  have h18 := R v1
  have h19 := h v0 y x
  have h20 := C h19 h18
  have h21 := C (T h20 h17) h8
  have h22 := h y v1 v0
  have h23 := T h22 h21
  have h24 := C (C (C h9 h23) h10) h9
  let v25 := M y v1
  have h26 := h v25 y v2
  have h27 := T (T (T h26 h24) h15) h12
  have h28 := C h9 h27
  have h29 := S h26
  have h30 := S h22
  have h31 := S h19
  have h32 := C h31 h18
  have h33 := C (T h16 h32) h8
  have h34 := T h33 h30
  have h35 := C (C (C h9 h34) h10) h9
  have h36 := T (T (T h11 h14) h35) h29
  have h37 := C h9 h36
  have h38 := h v2 v1 v1
  have h39 := h x v0 v1
  have h40 := S h39
  have h41 := h (M (M v1 x) v0) v1 v2
  have h42 := S h41
  have h43 := h v1 x v1
  have h44 := S h43
  have h45 := h v0 v1 x
  have h46 := C h45 h18
  have h47 := C (T h46 h44) h8
  have h48 := C (S h45) h18
  have h49 := h v1 x v2
  have h50 := S h49
  have h51 := R x
  have h52 := h x v0 z
  have h53 := S h52
  have h54 := h (M (M z x) v0) z v2
  have h55 := S h54
  have h56 := R z
  have h57 := h z x z
  have h58 := h x z v0
  have h59 := C (C (C h9 (T h58 (C (S h57) h8))) h56) h9
  let v60 := M x z
  have h61 := h v60 z v2
  have h62 := C h9 (T (T (T (T (T (T (T h61 h59) h55) h53) h11) h14) h35) h29)
  have h63 := C (C (T h62 h28) h51) h9
  have h64 := h (M v60 z) x v2
  have h65 := h z z x
  have h66 := h z z z
  have h67 := S h66
  have h68 := C (T (T (T (T (T (T h67 h65) h64) h63) h50) h43) h48) h8
  have h69 := h z z v0
  have h70 := T (T h69 h68) h47
  have h71 := C h9 h70
  have h72 := C h71 h18
  have h73 := C h72 h9
  have h74 := h v0 v1 v2
  have h75 := C h8 h27
  have h76 := S h69
  have h77 := C h66 h8
  have h78 := h v0 v0 v2
  have h79 := S h78
  have h80 := S h65
  have h81 := S h64
  have h82 := S h61
  have h83 := C (C (C h9 (T (C h57 h8) (S h58))) h56) h9
  have h84 := C h9 (T (T (T (T (T (T (T h26 h24) h15) h12) h52) h54) h83) h82)
  have h85 := C (C (T h37 h84) h51) h9
  have h86 := C (T (T (T (T (T (T h46 h44) h49) h85) h81) h80) h66) h8
  have h87 := C (T h43 h48) h8
  have h88 := T (T h87 h86) h76
  have h89 := C h9 h88
  have h90 := h v1 y y
  have h91 := S h90
  have h92 := C (T (T (T (T (T (T (T (T h75 h74) h73) h42) h40) h11) h14) h35) h29) h10
  have h93 := C (T h92 h91) h70
  let v94 := M v25 y
  have h95 := h v94 y v0
  have h96 := C (T (T (T (C (T (T h90 h95) (C (T (T (T h92 h95) h93) h89) h8)) h9) h79) h77) h76) h36
  have h97 := h v2 v1 v2
  have h98 := h y v1 v1
  have h99 := C (T (T (C (T h98 (C (T h97 (C (T (T (T (T (T h96 h75) h74) h73) h42) h40) h9)) h18)) h18) (S h38)) h37) h10
  have h100 := h v1 v1 y
  have h101 := h v1 v1 v0
  have h102 := S h101
  have h103 := T (T (T (T (T h69 h68) h102) h100) h99) (C h28 h10)
  have h104 := S h100
  have h105 := S h98
  have h106 := S h97
  have h107 := S h95
  have h108 := C h8 h36
  have h109 := S h74
  have h110 := C h89 h18
  have h111 := C h110 h9
  have h112 := C (T (T (T (T (T (T (T (T h26 h24) h15) h12) h39) h41) h111) h109) h108) h10
  have h113 := C (T h90 h112) h88
  have h114 := C h67 h8
  have h115 := C (T (T (T h69 h114) h78) (C (T (T (C (T (T (T h71 h113) h107) h112) h8) h107) h91) h9)) h27
  have h116 := C (T (C (T (T (T (T (T h39 h41) h111) h109) h108) h115) h9) h106) h18
  have h117 := C (T (T h28 h38) (C (T h116 h105) h18)) h10
  have h118 := T (T (T (T (T (C h37 h10) h117) h104) h101) h86) h76
  have h119 := h v5 v2 v2
  have h120 := h v5 v2 x
  have h121 := S h120
  have h122 := C h51 h103
  have h123 := C (T (T (T (T (T (T h96 h75) h74) h73) h42) h40) h122) h9
  have h124 := C (T (T h113 h107) h91) (T (T (T h52 h54) h83) h82)
  have h125 := h v94 y v2
  have h126 := C (T (T (T (T (C (T (T (T (T h69 h68) h102) h100) h99) h9) (S h125)) h95) h93) h89) h18
  have h127 := h v0 v2 x
  have h128 := C (S h127) h18
  have h129 := h v2 x v1
  have h130 := C (T (T (T (T (T (T (T (T (T h19 h129) h128) h126) h72) h124) h62) h28) h97) h123) h51
  have h131 := C (T (T (T h130 h121) h119) (C (T (T (T (T (C (C (T (T (T h90 h95) h93) h89) h118) h9) h79) h77) h68) (C (T (T (T (T (T h46 h44) h49) h85) h81) h80) h103)) h9)) h8
  have h132 := h y x v0
  have h133 := h y x v2
  have h134 := S h133
  have h135 := C h51 h118
  have h136 := C (T (T (T (T (T (T h135 h39) h41) h111) h109) h108) h115) h9
  have h137 := C (T (T (T (T (T (T (T (T (T h136 h106) h37) h84) (C (T (T h90 h95) h93) (T (T (T h61 h59) h55) h53))) h110) (C (T (T (T (T h71 h113) h107) h125) (C (T (T (T (T h117 h104) h101) h86) h76) h9)) h18)) (C h127 h18)) (S h129)) h31) h51
  have h138 := C (T (T (T (T (T (T h20 h17) h132) h131) h7) h120) h137) h8
  have h139 := T (T (T (T h33 h138) h131) h7) h4
  have h140 := C h9 (T h101 h47)
  have h141 := C (T (T (T h140 h113) h107) h91) h10
  have h142 := C h9 (T h87 h102)
  have h143 := C h10 h27
  have h144 := C (T (T (T (T (T (T (T (T (T h143 h22) h138) h131) h7) h4) h90) h95) h93) h142) h10
  have h145 := C h10 h36
  have h146 := C h145 h10
  have h147 := T (T (T (T (T (T h11 h14) h35) h29) h146) h144) h141
  have h148 := C (T (T (T (T h65 h64) h63) h50) (C h147 h51)) h139
  have h149 := S h132
  have h150 := C (T (T (T (C (T (T (T (T (C (T (T (T (T (T h65 h64) h63) h50) h43) h48) h118) h86) h114) h78) (C (C (T (T (T h71 h113) h107) h91) h103) h9)) h9) (S h119)) h120) h137) h8
  have h151 := C (T (T (T (T (T (T h130 h121) h6) h150) h149) h16) h32) h8
  have h152 := T (T (T (T h3 h6) h150) h151) h21
  have h153 := S (h z z v1)
  let v154 := M (M v1 z) z
  have h155 := h v1 z v0
  have h156 := h z v1 z
  have h157 := h z v1 v1
  have h158 := S h157
  have h159 := C h143 h10
  have h160 := C (T (T (T (T (T (T (T (T (T h140 h113) h107) h91) h3) h6) h150) h151) h30) h145) h10
  have h161 := C (T (T (T h90 h95) h93) h142) h10
  have h162 := T (T (T (T (T (T h161 h160) h159) h26) h24) h15) h12
  have h163 := h v13 y v0
  have h164 := S h163
  have h165 := C (T (T (T (T (T h11 h14) h35) h29) h146) (C (T (T (T (T (T h143 h22) h138) h149) h133) (C (T (T (T (T (C h162 h51) h49) h85) h81) h80) h152)) h10)) h118
  have h166 := h v0 z v1
  have h167 := C (T h166 (C (T (C (T (T (T (T (T (T (T (T (C h18 h103) h165) h164) h14) h35) h29) h146) h144) h141) h56) (C h162 h56)) h18)) h18
  have h168 := h z v1 v0
  have h169 := h z v0 z
  have h170 := C (T (T (T (T (T (C (T h169 (C (T h77 h76) h56)) h18) h167) h158) h168) (C (T (T h167 h158) h156) h8)) (S h155)) h56
  have h171 := h v0 v1 z
  have h172 := C (T (T (T (T (T (T h116 h105) h22) h138) h131) h7) h4) (T (T (T (T (T h39 h41) h111) h109) h171) h170)
  have h173 := C (T (T (T (T (T (T h160 h159) h26) h24) h15) h12) h122) h9
  have h174 := C (T (T (T (T (T h11 h14) h35) h29) h146) h144) h139
  have h175 := C (T (C (T (C h147 h56) (C (T (T (T (T (T (T (T (T h161 h160) h159) h26) h24) h15) h163) (C (T (T (T (T (T (C (T (T (T (T (T h148 h134) h132) h151) h30) h145) h10) h159) h26) h24) h15) h12) h103)) (C h18 h118)) h56)) h18) (S h166)) h18
  T (T (T (T (T (T (T (T (h x y v2) (h (M (M v2 x) y) v2 v2)) (C (T (T (C (T (T (T (T (T (C (T (T (T (T (T h3 h6) h150) h149) h16) h32) (T (T (T (T (C (T (T (T (T (T (T (T (T (T (T h129 h128) h126) h72) h124) h62) h28) h97) h123) (C (T (T (T (T (T (T h135 h11) h14) h35) h29) h146) h144) h9)) (C (T (T (T (T (T h160 h159) h26) h24) h15) h12) h152)) h10) (C (C h18 h34) h10)) (C (T (T (T (T (T (T (T (C h18 h23) h174) h173) h136) h106) h38) h172) (C (T (T (T (T (T (T h3 h6) h150) h151) h30) h145) (C h10 (T (T (T (T (T (T (T (T (T h26 h24) h15) h12) h39) h41) h111) h109) h171) h170))) (T (T (T (T (T (C (T (T (T (T (T h155 (C (T (T (S h156) h157) h175) h8)) (S h168)) h157) h175) (C (T (C (T h69 h114) h56) (S h169)) h18)) h56) (S h171)) h74) h73) h42) h40))) h10)) (S (h v154 v1 y))) h153)) h138) h131) h7) (h v5 v2 v1)) (C (T (T (T (T (T (T (C (T (T h165 h164) h12) h152) h174) h173) h136) h106) h38) h172) h18)) h9) (S (h v154 v1 v2))) h153) h152)) h148) h134) h132) h131) h7) h4

